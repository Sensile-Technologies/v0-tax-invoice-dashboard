module.exports=[62213,a=>{"use strict";let b=(0,a.i(70106).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);a.s(["default",()=>b])},84505,a=>{"use strict";let b=(0,a.i(70106).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);a.s(["Download",()=>b],84505)},88237,a=>{"use strict";var b=a.i(87924),c=a.i(97895);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,b.jsx)("table",{"data-slot":"table",className:(0,c.cn)("w-full caption-bottom text-sm",a),...d})})}function e({className:a,...d}){return(0,b.jsx)("thead",{"data-slot":"table-header",className:(0,c.cn)("[&_tr]:border-b",a),...d})}function f({className:a,...d}){return(0,b.jsx)("tbody",{"data-slot":"table-body",className:(0,c.cn)("[&_tr:last-child]:border-0",a),...d})}function g({className:a,...d}){return(0,b.jsx)("tr",{"data-slot":"table-row",className:(0,c.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",a),...d})}function h({className:a,...d}){return(0,b.jsx)("th",{"data-slot":"table-head",className:(0,c.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...d})}function i({className:a,...d}){return(0,b.jsx)("td",{"data-slot":"table-cell",className:(0,c.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...d})}a.s(["Table",()=>d,"TableBody",()=>f,"TableCell",()=>i,"TableHead",()=>h,"TableHeader",()=>e,"TableRow",()=>g])},15618,a=>{"use strict";let b=(0,a.i(70106).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],15618)},96221,a=>{"use strict";let b=(0,a.i(70106).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},41792,a=>{"use strict";var b=a.i(72131),c=a.i(50944);function d(){let a=(0,c.useRouter)(),[d,e]=(0,b.useState)({isChecking:!0,hasAccess:!1,user:null});return(0,b.useEffect)(()=>{(async()=>{try{let b=await fetch("/api/auth/session",{credentials:"include"});if(!b.ok){a.replace("/auth/login"),e({isChecking:!1,hasAccess:!1,user:null});return}let c=await b.json();if(!c.success||!c.user){a.replace("/auth/login"),e({isChecking:!1,hasAccess:!1,user:null});return}let d=(c.user.role||"").toLowerCase();if(["supervisor","manager","cashier"].includes(d)){let b=c.user.branch_id;a.replace(b?`/sales/summary?branch=${b}`:"/sales/summary"),e({isChecking:!1,hasAccess:!1,user:c.user});return}e({isChecking:!1,hasAccess:!0,user:c.user})}catch(b){console.error("Error checking HQ access:",b),a.replace("/auth/login"),e({isChecking:!1,hasAccess:!1,user:null})}})()},[a]),d}a.s(["useHQAccess",()=>d])},210,a=>{"use strict";let b=(0,a.i(70106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},46893,a=>{"use strict";var b=a.i(87924),c=a.i(97895);function d({className:a,...d}){return(0,b.jsx)("textarea",{"data-slot":"textarea",className:(0,c.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...d})}a.s(["Textarea",()=>d])},67453,a=>{"use strict";let b=(0,a.i(70106).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);a.s(["CheckCircle2",()=>b],67453)},11300,a=>{"use strict";let b=(0,a.i(70106).default)("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);a.s(["ClipboardList",()=>b],11300)},17755,a=>{"use strict";let b=(0,a.i(70106).default)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);a.s(["MoreHorizontal",()=>b],17755)},62285,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(69265),e=a.i(40695),f=a.i(3130),g=a.i(54161),h=a.i(46893),i=a.i(65733),j=a.i(88237),k=a.i(210),l=a.i(15618),m=a.i(96221),n=a.i(11300),o=a.i(67453);let p=(0,a.i(70106).default)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var q=a.i(17755),r=a.i(84505),s=a.i(76504),t=a.i(50944),u=a.i(23292),v=a.i(90023),w=a.i(41792);function x(){let{isChecking:a,hasAccess:x}=(0,w.useHQAccess)(),y=(0,t.useRouter)(),[z,A]=(0,c.useState)([]),[B,C]=(0,c.useState)(!0),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(""),N=(0,c.useCallback)(async()=>{try{C(!0);let a=await fetch("/api/headquarters/purchase-orders"),b=await a.json();b.success&&A(b.data||[])}catch(a){console.error("Error fetching purchase orders:",a)}finally{C(!1)}},[]),O=(0,c.useCallback)(()=>{try{let a=(0,v.getCurrentUser)();a?.role&&E(a.role.toLowerCase())}catch(a){console.error("Error getting user role:",a)}},[]);if((0,c.useEffect)(()=>{x&&(N(),O())},[N,O,x]),a)return(0,b.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,b.jsx)(m.Loader2,{className:"h-8 w-8 animate-spin text-primary"})});if(!x)return null;let P=["vendor","manager","director","admin","owner"].includes(D),Q=async a=>{try{G(a);let b=await fetch(`/api/headquarters/purchase-orders/${a}/approve`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"approve"})}),c=await b.json();c.success?(u.toast.success(c.message||"Purchase order approved"),N()):u.toast.error(c.error||"Failed to approve")}catch(a){console.error("Error approving:",a),u.toast.error("Failed to approve purchase order")}finally{G(null)}},R=async()=>{if(J){if(!L.trim())return void u.toast.error("Please provide rejection comments");try{G(J.id);let a=await fetch(`/api/headquarters/purchase-orders/${J.id}/approve`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"reject",rejection_comments:L.trim()})}),b=await a.json();b.success?(u.toast.success(b.message||"Purchase order rejected"),I(!1),N()):u.toast.error(b.error||"Failed to reject")}catch(a){console.error("Error rejecting:",a),u.toast.error("Failed to reject purchase order")}finally{G(null)}}},S=a=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:2}).format(a);return(0,b.jsxs)("div",{className:"flex h-screen flex-col overflow-hidden bg-gradient-to-b from-slate-50 to-white",children:[(0,b.jsx)(d.DashboardHeader,{currentBranch:"hq"}),(0,b.jsxs)("main",{className:"flex-1 overflow-y-auto p-8",children:[(0,b.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(e.Button,{variant:"outline",onClick:()=>y.push("/headquarters"),className:"rounded-xl mb-4",children:[(0,b.jsx)(k.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back to Headquarters"]}),(0,b.jsxs)("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-3",children:[(0,b.jsx)(n.ClipboardList,{className:"h-8 w-8"}),"Purchase Orders"]}),(0,b.jsx)("p",{className:"mt-1 text-muted-foreground",children:"Create and manage purchase orders for branches"})]}),(0,b.jsxs)(e.Button,{className:"rounded-xl",onClick:()=>y.push("/headquarters/purchase-orders/create"),children:[(0,b.jsx)(l.Plus,{className:"mr-2 h-4 w-4"}),"Create Purchase Order"]})]}),(0,b.jsxs)(f.Card,{className:"rounded-2xl",children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{children:"All Purchase Orders"})}),(0,b.jsx)(f.CardContent,{children:B?(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,b.jsx)(m.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):0===z.length?(0,b.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,b.jsx)(n.ClipboardList,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{className:"text-lg font-medium",children:"No purchase orders yet"}),(0,b.jsx)("p",{children:"Create your first purchase order to get started"})]}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{children:"PO Number"}),(0,b.jsx)(j.TableHead,{children:"Branch"}),(0,b.jsx)(j.TableHead,{children:"Supplier"}),(0,b.jsx)(j.TableHead,{children:"Items"}),(0,b.jsx)(j.TableHead,{children:"Total"}),(0,b.jsx)(j.TableHead,{children:"Approval"}),(0,b.jsx)(j.TableHead,{children:"Delivery Status"}),(0,b.jsx)(j.TableHead,{children:"Expected"}),(0,b.jsx)(j.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(j.TableBody,{children:z.map(a=>{var c;return(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{className:"font-medium",children:a.po_number}),(0,b.jsx)(j.TableCell,{children:a.branch_name||"-"}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{children:a.supplier_name||"-"}),a.transporter_name&&(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Transport: ",a.transporter_name]})]})}),(0,b.jsxs)(j.TableCell,{children:[a.item_count," items"]}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{children:S(parseFloat(String(a.total_amount))||0)}),parseFloat(String(a.transport_cost))>0&&(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["+",S(parseFloat(String(a.transport_cost)))," transport"]})]})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{children:[(a=>{switch(a){case"pending_approval":return(0,b.jsx)(g.Badge,{variant:"outline",className:"bg-orange-50 text-orange-700 border-orange-300",children:"Pending Approval"});case"approved":return(0,b.jsx)(g.Badge,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300",children:"Approved"});case"rejected":return(0,b.jsx)(g.Badge,{variant:"outline",className:"bg-red-50 text-red-700 border-red-300",children:"Rejected"});default:return(0,b.jsx)(g.Badge,{variant:"outline",children:a||"Draft"})}})(a.approval_status),a.approved_by_name&&(0,b.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["by ",a.approved_by_name]})]})}),(0,b.jsx)(j.TableCell,{children:(a=>{switch(a){case"pending":return(0,b.jsx)(g.Badge,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-300",children:"Pending Delivery"});case"accepted":return(0,b.jsx)(g.Badge,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300",children:"Accepted"});case"cancelled":return(0,b.jsx)(g.Badge,{variant:"outline",className:"bg-red-50 text-red-700 border-red-300",children:"Cancelled"});case"completed":return(0,b.jsx)(g.Badge,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-300",children:"Completed"});default:return(0,b.jsx)(g.Badge,{variant:"outline",children:a||"-"})}})(a.status)}),(0,b.jsx)(j.TableCell,{children:(c=a.expected_delivery)?new Date(c).toLocaleDateString("en-KE",{year:"numeric",month:"short",day:"numeric"}):"-"}),(0,b.jsx)(j.TableCell,{className:"text-right",children:(0,b.jsxs)(s.DropdownMenu,{children:[(0,b.jsx)(s.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:(0,b.jsx)(q.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(s.DropdownMenuContent,{align:"end",children:[P&&"pending_approval"===a.approval_status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(s.DropdownMenuItem,{onClick:()=>Q(a.id),disabled:F===a.id,className:"text-green-600 focus:text-green-600",children:[(0,b.jsx)(o.CheckCircle2,{className:"mr-2 h-4 w-4"}),"Approve"]}),(0,b.jsxs)(s.DropdownMenuItem,{onClick:()=>{K(a),M(""),I(!0)},disabled:F===a.id,className:"text-red-600 focus:text-red-600",children:[(0,b.jsx)(p,{className:"mr-2 h-4 w-4"}),"Reject"]})]}),"rejected"===a.approval_status&&a.rejection_comments&&(0,b.jsxs)(s.DropdownMenuItem,{onClick:()=>{K(a),M(a.rejection_comments),I(!0)},className:"text-red-600 focus:text-red-600",children:[(0,b.jsx)(p,{className:"mr-2 h-4 w-4"}),"View Rejection Reason"]}),(0,b.jsxs)(s.DropdownMenuItem,{onClick:()=>{window.open(`/api/headquarters/purchase-orders/${a.id}/pdf`,"_blank")},children:[(0,b.jsx)(r.Download,{className:"mr-2 h-4 w-4"}),"Download PDF"]})]})]})})]},a.id)})})]})})})]})]}),(0,b.jsx)(i.Dialog,{open:H,onOpenChange:I,children:(0,b.jsxs)(i.DialogContent,{children:[(0,b.jsxs)(i.DialogHeader,{children:[(0,b.jsx)(i.DialogTitle,{children:"Reject Purchase Order"}),(0,b.jsxs)(i.DialogDescription,{children:["Please provide a reason for rejecting ",J?.po_number,"."]})]}),(0,b.jsx)("div",{className:"py-4",children:(0,b.jsx)(h.Textarea,{value:L,onChange:a=>M(a.target.value),placeholder:"Enter rejection reason...",className:"rounded-xl",rows:4})}),(0,b.jsxs)(i.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>I(!1),className:"rounded-xl",children:"Cancel"}),(0,b.jsxs)(e.Button,{variant:"destructive",onClick:R,disabled:null!==F,className:"rounded-xl",children:[F?(0,b.jsx)(m.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(p,{className:"mr-2 h-4 w-4"}),"Reject"]})]})]})})]})}a.s(["default",()=>x],62285)}];

//# sourceMappingURL=_dbc562d1._.js.map