module.exports=[81502,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(3130),e=a.i(40695),f=a.i(5522),g=a.i(17171),h=a.i(80281),i=a.i(54161),j=a.i(21958),k=a.i(35125),l=a.i(11156),m=a.i(23312),n=a.i(3314),o=a.i(57990),p=a.i(67900),q=a.i(90669),r=a.i(69520),s=a.i(13749),t=a.i(50522),u=a.i(99385),v=a.i(81464),w=a.i(46842),x=a.i(87682),y=a.i(23292);function z(){let[a,z]=(0,c.useState)({url:"http://5.189.171.160",port:"8088"}),[A,B]=(0,c.useState)({defaultTaxRate:"16",currency:"KES",invoicePrefix:"INV"}),[C,D]=(0,c.useState)({emailNotifications:!0,ticketAlerts:!0,invoiceReminders:!0}),[E,F]=(0,c.useState)([]),[G,H]=(0,c.useState)(!0),[I,J]=(0,c.useState)([]),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(0),[O,P]=(0,c.useState)(0),[Q,R]=(0,c.useState)(!1),[S,T]=(0,c.useState)({action:"",dateFrom:"",dateTo:""});(0,c.useEffect)(()=>{let a=localStorage.getItem("backendConfig");if(a)try{z(JSON.parse(a))}catch(a){}U()},[]);let U=async()=>{try{let a=await fetch("/api/admin/branches"),b=await a.json();F(Array.isArray(b)?b:[])}catch(a){console.error("Error fetching branches:",a),F([])}finally{H(!1)}},V=async(a=0)=>{L(!0);try{let b=new URLSearchParams;b.append("limit","25"),b.append("offset",(25*a).toString()),S.action&&b.append("action",S.action),S.dateFrom&&b.append("date_from",S.dateFrom),S.dateTo&&b.append("date_to",S.dateTo);let c=await fetch(`/api/activity-logs?${b.toString()}`),d=await c.json();d.success?(J(d.data||[]),N(d.pagination?.total||0),R(d.pagination?.hasMore||!1)):y.toast.error(d.error||"Failed to load activity logs")}catch(a){console.error("Error fetching activity logs:",a),y.toast.error("Failed to load activity logs")}finally{L(!1)}},W=a=>{P(a),V(a)},X=E.reduce((a,b)=>{let c=b.vendor_name||"Unknown";return a[c]||(a[c]=[]),a[c].push(b),a},{});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"Platform Settings"}),(0,b.jsx)("p",{className:"text-slate-600 mt-1",children:"Configure Flow360 Core platform settings"})]}),(0,b.jsxs)(j.Tabs,{defaultValue:"server",className:"space-y-6",children:[(0,b.jsxs)(j.TabsList,{children:[(0,b.jsxs)(j.TabsTrigger,{value:"server",className:"gap-2",children:[(0,b.jsx)(k.Server,{className:"h-4 w-4"}),"Server"]}),(0,b.jsxs)(j.TabsTrigger,{value:"branches",className:"gap-2",children:[(0,b.jsx)(o.Store,{className:"h-4 w-4"}),"Branches"]}),(0,b.jsxs)(j.TabsTrigger,{value:"billing",className:"gap-2",children:[(0,b.jsx)(l.CreditCard,{className:"h-4 w-4"}),"Billing"]}),(0,b.jsxs)(j.TabsTrigger,{value:"notifications",className:"gap-2",children:[(0,b.jsx)(m.Bell,{className:"h-4 w-4"}),"Notifications"]}),(0,b.jsxs)(j.TabsTrigger,{value:"security",className:"gap-2",children:[(0,b.jsx)(n.Shield,{className:"h-4 w-4"}),"Security"]}),(0,b.jsxs)(j.TabsTrigger,{value:"activity",className:"gap-2",onClick:()=>{0===I.length&&V(0)},children:[(0,b.jsx)(q.Activity,{className:"h-4 w-4"}),"Activity Logs"]})]}),(0,b.jsx)(j.TabsContent,{value:"server",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"KRA Backend Configuration"}),(0,b.jsx)(d.CardDescription,{children:"Configure the KRA TIMS backend server connection"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"url",children:"Backend URL"}),(0,b.jsx)(f.Input,{id:"url",value:a.url,onChange:b=>z({...a,url:b.target.value}),placeholder:"http://example.com"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"port",children:"Port"}),(0,b.jsx)(f.Input,{id:"port",value:a.port,onChange:b=>z({...a,port:b.target.value}),placeholder:"8088"})]})]}),(0,b.jsx)("div",{className:"pt-4",children:(0,b.jsx)(e.Button,{onClick:()=>{localStorage.setItem("backendConfig",JSON.stringify(a)),y.toast.success("Backend configuration saved")},children:"Save Configuration"})})]})]})}),(0,b.jsx)(j.TabsContent,{value:"branches",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{children:"Connected Branches"}),(0,b.jsxs)(i.Badge,{variant:"outline",className:"text-lg px-3 py-1",children:[E.length," Total"]})]}),(0,b.jsx)(d.CardDescription,{children:"All branches connected to the platform with their BHF-IDs"})]}),(0,b.jsx)(d.CardContent,{children:G?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):0===E.length?(0,b.jsxs)("div",{className:"text-center py-12 text-slate-500",children:[(0,b.jsx)(o.Store,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{children:"No branches connected yet"})]}):(0,b.jsx)("div",{className:"space-y-6",children:Object.entries(X).map(([a,c])=>(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[(0,b.jsx)(p.Building2,{className:"h-4 w-4"}),a,(0,b.jsxs)(i.Badge,{variant:"secondary",className:"ml-2",children:[c.length," branch",1!==c.length?"es":""]})]}),(0,b.jsx)("div",{className:"grid gap-2 pl-6",children:c.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded flex items-center justify-center",children:(0,b.jsx)(o.Store,{className:"h-4 w-4 text-green-600"})}),(0,b.jsx)("div",{children:(0,b.jsx)("p",{className:"font-medium",children:a.bhf_nm})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(i.Badge,{variant:"outline",className:"font-mono bg-white",children:["BHF-ID: ",a.bhf_id]}),(0,b.jsx)(i.Badge,{variant:"active"===a.status?"default":"secondary",className:"active"===a.status?"bg-green-100 text-green-800":"",children:a.status||"active"})]})]},a.id))})]},a))})})]})}),(0,b.jsx)(j.TabsContent,{value:"billing",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Billing Settings"}),(0,b.jsx)(d.CardDescription,{children:"Configure default billing and invoicing settings"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"taxRate",children:"Default Tax Rate (%)"}),(0,b.jsx)(f.Input,{id:"taxRate",type:"number",value:A.defaultTaxRate,onChange:a=>B({...A,defaultTaxRate:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"currency",children:"Currency"}),(0,b.jsx)(f.Input,{id:"currency",value:A.currency,onChange:a=>B({...A,currency:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"invoicePrefix",children:"Invoice Prefix"}),(0,b.jsx)(f.Input,{id:"invoicePrefix",value:A.invoicePrefix,onChange:a=>B({...A,invoicePrefix:a.target.value})})]})]}),(0,b.jsx)("div",{className:"pt-4",children:(0,b.jsx)(e.Button,{onClick:()=>{localStorage.setItem("billingSettings",JSON.stringify(A)),y.toast.success("Billing settings saved")},children:"Save Settings"})})]})]})}),(0,b.jsx)(j.TabsContent,{value:"notifications",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Notification Settings"}),(0,b.jsx)(d.CardDescription,{children:"Configure email and alert notifications"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:"Email Notifications"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Receive email notifications for important events"})]}),(0,b.jsx)(h.Switch,{checked:C.emailNotifications,onCheckedChange:a=>D({...C,emailNotifications:a})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:"Ticket Alerts"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Get notified when new support tickets are created"})]}),(0,b.jsx)(h.Switch,{checked:C.ticketAlerts,onCheckedChange:a=>D({...C,ticketAlerts:a})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:"Invoice Reminders"}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:"Send automatic reminders for overdue invoices"})]}),(0,b.jsx)(h.Switch,{checked:C.invoiceReminders,onCheckedChange:a=>D({...C,invoiceReminders:a})})]}),(0,b.jsx)("div",{className:"pt-4",children:(0,b.jsx)(e.Button,{onClick:()=>{localStorage.setItem("notificationSettings",JSON.stringify(C)),y.toast.success("Notification settings saved")},children:"Save Settings"})})]})]})}),(0,b.jsx)(j.TabsContent,{value:"security",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Security Settings"}),(0,b.jsx)(d.CardDescription,{children:"Configure security and access control settings"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"p-4 bg-slate-50 rounded-lg",children:[(0,b.jsx)("p",{className:"font-medium",children:"Two-Factor Authentication"}),(0,b.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Enhanced security for admin accounts"}),(0,b.jsx)(e.Button,{variant:"outline",className:"mt-3",disabled:!0,children:"Coming Soon"})]}),(0,b.jsxs)("div",{className:"p-4 bg-slate-50 rounded-lg",children:[(0,b.jsx)("p",{className:"font-medium",children:"API Keys Management"}),(0,b.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Manage API keys for third-party integrations"}),(0,b.jsx)(e.Button,{variant:"outline",className:"mt-3",disabled:!0,children:"Coming Soon"})]})]})]})}),(0,b.jsx)(j.TabsContent,{value:"activity",children:(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{children:"Activity Logs"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(i.Badge,{variant:"outline",className:"text-sm px-3 py-1",children:[M," Total"]}),(0,b.jsx)(e.Button,{variant:"outline",size:"sm",onClick:()=>V(O),disabled:K,children:(0,b.jsx)(r.RefreshCw,{className:`h-4 w-4 ${K?"animate-spin":""}`})})]})]}),(0,b.jsx)(d.CardDescription,{children:"Track all user actions across the platform"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 mb-6 flex-wrap",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(v.Filter,{className:"h-4 w-4 text-slate-400"}),(0,b.jsx)("span",{className:"text-sm text-slate-500",children:"Filter:"})]}),(0,b.jsxs)(x.Select,{value:S.action,onValueChange:a=>T({...S,action:"all"===a?"":a}),children:[(0,b.jsx)(x.SelectTrigger,{className:"w-[140px]",children:(0,b.jsx)(x.SelectValue,{placeholder:"All Actions"})}),(0,b.jsxs)(x.SelectContent,{children:[(0,b.jsx)(x.SelectItem,{value:"all",children:"All Actions"}),(0,b.jsx)(x.SelectItem,{value:"LOGIN",children:"Login"}),(0,b.jsx)(x.SelectItem,{value:"LOGOUT",children:"Logout"}),(0,b.jsx)(x.SelectItem,{value:"CREATE",children:"Create"}),(0,b.jsx)(x.SelectItem,{value:"UPDATE",children:"Update"}),(0,b.jsx)(x.SelectItem,{value:"DELETE",children:"Delete"})]})]}),(0,b.jsx)(f.Input,{type:"date",value:S.dateFrom,onChange:a=>T({...S,dateFrom:a.target.value}),className:"w-36",placeholder:"From"}),(0,b.jsx)("span",{className:"text-slate-400",children:"to"}),(0,b.jsx)(f.Input,{type:"date",value:S.dateTo,onChange:a=>T({...S,dateTo:a.target.value}),className:"w-36",placeholder:"To"}),(0,b.jsx)(e.Button,{variant:"secondary",size:"sm",onClick:()=>{P(0),V(0)},children:"Apply"}),(S.action||S.dateFrom||S.dateTo)&&(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{T({action:"",dateFrom:"",dateTo:""}),P(0),V(0)},children:"Clear"})]}),K?(0,b.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,b.jsx)(r.RefreshCw,{className:"h-8 w-8 animate-spin text-slate-400"}),(0,b.jsx)("span",{className:"ml-2 text-slate-500",children:"Loading activity logs..."})]}):0===I.length?(0,b.jsxs)("div",{className:"text-center py-12 text-slate-500",children:[(0,b.jsx)(q.Activity,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{className:"font-medium",children:"No activity logs found"}),(0,b.jsx)("p",{className:"text-sm mt-1",children:"User activities will appear here as they occur"})]}):(0,b.jsxs)("div",{className:"space-y-3",children:[I.map(a=>(0,b.jsxs)("div",{className:"flex items-start justify-between p-4 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm",children:(0,b.jsx)(w.User,{className:"h-5 w-5 text-slate-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-medium",children:a.user_name||a.user_email||"Unknown User"}),(0,b.jsx)(i.Badge,{className:(a=>{switch(a){case"LOGIN":return"bg-green-100 text-green-800";case"LOGOUT":default:return"bg-slate-100 text-slate-800";case"CREATE":return"bg-blue-100 text-blue-800";case"UPDATE":return"bg-yellow-100 text-yellow-800";case"DELETE":return"bg-red-100 text-red-800"}})(a.action),children:a.action})]}),(0,b.jsxs)("p",{className:"text-sm text-slate-600 mt-1",children:[a.resource_type&&(0,b.jsx)("span",{className:"capitalize",children:a.resource_type}),a.resource_id&&(0,b.jsxs)("span",{className:"text-slate-400",children:[" #",a.resource_id.slice(0,8)]})]}),a.branch_name&&(0,b.jsxs)("p",{className:"text-xs text-slate-400 mt-1",children:[(0,b.jsx)(o.Store,{className:"h-3 w-3 inline mr-1"}),a.branch_name]})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1 text-sm text-slate-500",children:[(0,b.jsx)(u.Clock,{className:"h-3 w-3"}),new Date(a.created_at).toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})]}),a.ip_address&&"unknown"!==a.ip_address&&(0,b.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:a.ip_address})]})]},a.id)),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-6 pt-4 border-t",children:[(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:()=>W(O-1),disabled:0===O||K,children:[(0,b.jsx)(s.ChevronLeft,{className:"h-4 w-4 mr-1"}),"Previous"]}),(0,b.jsxs)("span",{className:"text-sm text-slate-500",children:["Page ",O+1," of ",Math.max(1,Math.ceil(M/25))]}),(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:()=>W(O+1),disabled:!Q||K,children:["Next",(0,b.jsx)(t.ChevronRight,{className:"h-4 w-4 ml-1"})]})]})]})]})]})})]})]})}a.s(["default",()=>z])}];

//# sourceMappingURL=app_admin_settings_page_tsx_b6d248a9._.js.map