module.exports=[35380,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(3130),e=a.i(40695),f=a.i(23292),g=a.i(84505),h=a.i(69520),i=a.i(23312),j=a.i(4720),k=a.i(210);let l=(0,a.i(70106).default)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var m=a.i(50944),n=a.i(88237),o=a.i(46470),p=a.i(54161);function q(){let a=(0,m.useRouter)(),[q,r]=(0,c.useState)({}),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)([]);(0,c.useEffect)(()=>{A()},[]);let A=async()=>{try{let[a,b]=await Promise.all([fetch("/api/kra/saved-data?type=codelist"),fetch("/api/kra/saved-data?type=classifications")]);if(a.ok){let b=await a.json();b.data&&b.data.length>0&&(v(b.data),t(b.bhf_id))}if(b.ok){let a=await b.json();a.data&&a.data.length>0&&(x(a.data),s||t(a.bhf_id))}}catch(a){console.error("Error loading saved data:",a)}},B=()=>{let a=localStorage.getItem("backendConfig");if(a)try{let b=JSON.parse(a);return b.port?`${b.url}:${b.port}`:b.url}catch{}return"http://20.224.40.56:8088"},C=()=>{let a=localStorage.getItem("selectedBranch");if(a)try{return JSON.parse(a).id}catch{}return null},D=async()=>{r({...q,codelist:!0});try{let a=B(),b=C(),c={"x-backend-url":a};b&&(c["x-branch-id"]=b);let d=await fetch("/api/kra/codes",{method:"POST",headers:c});if(!d.ok)throw Error("Failed to pull code list");let e=(await d.json()).data||[];v(e),f.toast.success(`Successfully pulled ${e.length} code list items`)}catch(a){console.error("Error pulling code list:",a),f.toast.error("Failed to pull code list from tax service")}finally{r({...q,codelist:!1})}},E=async()=>{r({...q,itemclass:!0});try{let a=B(),b=C(),c={"x-backend-url":a};b&&(c["x-branch-id"]=b);let d=await fetch("/api/kra/items/classifications",{method:"POST",headers:c});if(!d.ok)throw Error("Failed to pull item classifications");let e=(await d.json()).data||[];x(e),f.toast.success(`Successfully pulled ${e.length} item classifications`)}catch(a){console.error("Error pulling item classifications:",a),f.toast.error("Failed to pull item classifications from tax service")}finally{r({...q,itemclass:!1})}},F=async()=>{r({...q,notices:!0});try{let a=B(),b=C(),c={"x-backend-url":a};b&&(c["x-branch-id"]=b);let d=await fetch("/api/kra/notices",{method:"POST",headers:c});if(!d.ok)throw Error("Failed to pull notices");let e=(await d.json()).data||[];z(e),f.toast.success(`Successfully pulled ${e.length} notices from KRA`)}catch(a){console.error("Error pulling notices:",a),f.toast.error("Failed to pull notices from tax service")}finally{r({...q,notices:!1})}};return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:()=>a.back(),className:"gap-2",children:[(0,b.jsx)(k.ArrowLeft,{className:"h-4 w-4"}),"Back"]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"Tax Service Configuration"}),(0,b.jsx)("p",{className:"text-slate-600 mt-1",children:"Pull master data and updates from KRA TIMS service"})]})]}),(0,b.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(j.FileText,{className:"h-5 w-5"}),"Code List"]}),(0,b.jsx)(d.CardDescription,{children:"Pull tax codes, payment types, units of measure, and other code lists from KRA"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"text-sm text-slate-600",children:["Code lists include:",(0,b.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,b.jsx)("li",{children:"Tax type codes (A, B, C, D, E)"}),(0,b.jsx)("li",{children:"Payment type codes"}),(0,b.jsx)("li",{children:"Unit of measure codes"}),(0,b.jsx)("li",{children:"Receipt type codes"}),(0,b.jsx)("li",{children:"Registration type codes"})]})]}),(0,b.jsx)(e.Button,{onClick:D,disabled:q.codelist,className:"w-full",children:q.codelist?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.RefreshCw,{className:"h-4 w-4 mr-2 animate-spin"}),"Pulling..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.Download,{className:"h-4 w-4 mr-2"}),"Pull Code List"]})})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(j.FileText,{className:"h-5 w-5"}),"Item Classification"]}),(0,b.jsx)(d.CardDescription,{children:"Pull product/service classification codes and tax categories from KRA"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"text-sm text-slate-600",children:["Item classifications include:",(0,b.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,b.jsx)("li",{children:"Product categories"}),(0,b.jsx)("li",{children:"Service categories"}),(0,b.jsx)("li",{children:"Tax type mappings"}),(0,b.jsx)("li",{children:"Classification levels"}),(0,b.jsx)("li",{children:"Major target flags"})]})]}),(0,b.jsx)(e.Button,{onClick:E,disabled:q.itemclass,className:"w-full",children:q.itemclass?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.RefreshCw,{className:"h-4 w-4 mr-2 animate-spin"}),"Pulling..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.Download,{className:"h-4 w-4 mr-2"}),"Pull Classifications"]})})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Bell,{className:"h-5 w-5"}),"Notices"]}),(0,b.jsx)(d.CardDescription,{children:"Pull important notices, updates, and announcements from KRA"})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"text-sm text-slate-600",children:["Notices include:",(0,b.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,b.jsx)("li",{children:"System updates"}),(0,b.jsx)("li",{children:"Compliance reminders"}),(0,b.jsx)("li",{children:"Policy changes"}),(0,b.jsx)("li",{children:"Maintenance schedules"}),(0,b.jsx)("li",{children:"Important announcements"})]})]}),(0,b.jsx)(e.Button,{onClick:F,disabled:q.notices,className:"w-full",children:q.notices?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.RefreshCw,{className:"h-4 w-4 mr-2 animate-spin"}),"Pulling..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(g.Download,{className:"h-4 w-4 mr-2"}),"Pull Notices"]})})]})]})]}),(0,b.jsxs)(d.Card,{className:"bg-blue-50 border-blue-200",children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)(d.CardTitle,{className:"text-blue-900 flex items-center gap-2",children:["How to Use Tax Service Configuration",s&&(0,b.jsxs)(p.Badge,{className:"bg-blue-600 text-white",children:["BHF ID: ",s]})]})}),(0,b.jsxs)(d.CardContent,{className:"text-sm text-blue-800 space-y-2",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"1. Configure Backend URL:"})," First, make sure you've configured the KRA TIMS backend URL in Security Settings (profile dropdown → Security Settings → Backend Configuration)."]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"2. Pull Master Data:"})," Click the buttons above to pull the latest master data from KRA. This should be done:"]}),(0,b.jsxs)("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[(0,b.jsx)("li",{children:"During initial setup"}),(0,b.jsx)("li",{children:"When KRA releases updates to code lists or classifications"}),(0,b.jsx)("li",{children:"Periodically to check for new notices"})]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"3. Review Notices:"})," After pulling notices, review them for important compliance updates or system changes."]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"4. BHF ID Mapping:"})," Each branch is mapped to a unique Branch Office ID (BHF ID) for KRA compliance. ",s?`Current branch BHF ID: "${s}".`:"No BHF ID assigned yet."]}),(u.length>0||w.length>0)&&(0,b.jsx)("div",{className:"mt-3 pt-3 border-t border-blue-200",children:(0,b.jsxs)("p",{className:"flex items-center gap-2",children:[(0,b.jsx)(l,{className:"h-4 w-4"}),(0,b.jsx)("strong",{children:"Saved Data:"}),u.length>0&&` ${u.length} code list items`,u.length>0&&w.length>0&&",",w.length>0&&` ${w.length} item classifications`]})})]})]}),u.length>0&&(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{children:["Code List Results (",u.length," items)"]}),(0,b.jsx)(d.CardDescription,{children:"Tax codes, payment types, units, and other code lists pulled from KRA"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(o.ScrollArea,{className:"h-[400px] w-full",children:(0,b.jsxs)(n.Table,{children:[(0,b.jsx)(n.TableHeader,{children:(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableHead,{children:"Code Class"}),(0,b.jsx)(n.TableHead,{children:"Code"}),(0,b.jsx)(n.TableHead,{children:"Code Name"}),(0,b.jsx)(n.TableHead,{children:"Description"}),(0,b.jsx)(n.TableHead,{children:"Status"})]})}),(0,b.jsx)(n.TableBody,{children:u.map((a,c)=>(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableCell,{className:"font-medium",children:a.cd_cls}),(0,b.jsx)(n.TableCell,{children:a.cd}),(0,b.jsx)(n.TableCell,{children:a.cd_nm}),(0,b.jsx)(n.TableCell,{className:"text-slate-600",children:a.cd_desc||"-"}),(0,b.jsx)(n.TableCell,{children:(0,b.jsx)("span",{className:`px-2 py-1 rounded-full text-xs ${"Y"===a.use_yn?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:"Y"===a.use_yn?"Active":"Inactive"})})]},`${a.cd_cls}-${a.cd}-${c}`))})]})})})]}),w.length>0&&(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{children:["Item Classification Results (",w.length," items)"]}),(0,b.jsx)(d.CardDescription,{children:"Product and service classification codes with tax type mappings"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(o.ScrollArea,{className:"h-[400px] w-full",children:(0,b.jsxs)(n.Table,{children:[(0,b.jsx)(n.TableHeader,{children:(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableHead,{children:"Classification Code"}),(0,b.jsx)(n.TableHead,{children:"Classification Name"}),(0,b.jsx)(n.TableHead,{children:"Level"}),(0,b.jsx)(n.TableHead,{children:"Tax Type"}),(0,b.jsx)(n.TableHead,{children:"Status"})]})}),(0,b.jsx)(n.TableBody,{children:w.map((a,c)=>(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableCell,{className:"font-medium",children:a.item_cls_cd}),(0,b.jsx)(n.TableCell,{children:a.item_cls_nm}),(0,b.jsx)(n.TableCell,{children:a.item_cls_lvl}),(0,b.jsx)(n.TableCell,{children:a.tax_ty_cd||"-"}),(0,b.jsx)(n.TableCell,{children:(0,b.jsx)("span",{className:`px-2 py-1 rounded-full text-xs ${"Y"===a.use_yn?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:"Y"===a.use_yn?"Active":"Inactive"})})]},`${a.item_cls_cd}-${c}`))})]})})})]}),y.length>0&&(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsxs)(d.CardTitle,{children:["KRA Notices (",y.length," items)"]}),(0,b.jsx)(d.CardDescription,{children:"Important notices, updates, and announcements from KRA"})]}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)(o.ScrollArea,{className:"h-[400px] w-full",children:(0,b.jsxs)(n.Table,{children:[(0,b.jsx)(n.TableHeader,{children:(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableHead,{children:"Notice No."}),(0,b.jsx)(n.TableHead,{children:"Title"}),(0,b.jsx)(n.TableHead,{children:"Content"}),(0,b.jsx)(n.TableHead,{children:"Detail URL"}),(0,b.jsx)(n.TableHead,{children:"Date"})]})}),(0,b.jsx)(n.TableBody,{children:y.map((a,c)=>(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableCell,{className:"font-medium",children:a.notce_no}),(0,b.jsx)(n.TableCell,{className:"font-medium max-w-xs",children:a.title}),(0,b.jsx)(n.TableCell,{className:"text-slate-600 max-w-md truncate",children:a.cont}),(0,b.jsx)(n.TableCell,{children:a.dtl_url?(0,b.jsx)("a",{href:a.dtl_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"View"}):"-"}),(0,b.jsx)(n.TableCell,{className:"text-slate-600",children:a.last_req_dt?new Date(a.last_req_dt).toLocaleDateString():"-"})]},`${a.notce_no}-${c}`))})]})})})]})]})}a.s(["default",()=>q],35380)}];

//# sourceMappingURL=app_configuration_tax-service_page_tsx_2e9cddcf._.js.map