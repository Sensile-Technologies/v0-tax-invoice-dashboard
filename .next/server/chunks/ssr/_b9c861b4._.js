module.exports=[32245,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"BailoutToCSR",{enumerable:!0,get:function(){return e}});let d=a.r(41997);function e({reason:a,children:b}){throw Object.defineProperty(new d.BailoutToCSRError(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})}},7773,(a,b,c)=>{"use strict";function d(a){return a.split("/").map(a=>encodeURIComponent(a)).join("/")}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"encodeURIPath",{enumerable:!0,get:function(){return d}})},97458,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"PreloadChunks",{enumerable:!0,get:function(){return h}});let d=a.r(87924),e=a.r(35112),f=a.r(56704),g=a.r(7773);function h({moduleIds:a}){let b=f.workAsyncStorage.getStore();if(void 0===b)return null;let c=[];if(b.reactLoadableManifest&&a){let d=b.reactLoadableManifest;for(let b of a){if(!d[b])continue;let a=d[b].files;c.push(...a)}}return 0===c.length?null:(0,d.jsx)(d.Fragment,{children:c.map(a=>{let c=`${b.assetPrefix}/_next/${(0,g.encodeURIPath)(a)}`;return a.endsWith(".css")?(0,d.jsx)("link",{precedence:"dynamic",href:c,rel:"stylesheet",as:"style",nonce:b.nonce},a):((0,e.preload)(c,{as:"script",fetchPriority:"low",nonce:b.nonce}),null)})})}},69853,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return j}});let d=a.r(87924),e=a.r(72131),f=a.r(32245),g=a.r(97458);function h(a){return{default:a&&"default"in a?a.default:a}}let i={loader:()=>Promise.resolve(h(()=>null)),loading:null,ssr:!0},j=function(a){let b={...i,...a},c=(0,e.lazy)(()=>b.loader().then(h)),j=b.loading;function k(a){let h=j?(0,d.jsx)(j,{isLoading:!0,pastDelay:!0,error:null}):null,i=!b.ssr||!!b.loading,k=i?e.Suspense:e.Fragment,l=b.ssr?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.PreloadChunks,{moduleIds:b.modules}),(0,d.jsx)(c,{...a})]}):(0,d.jsx)(f.BailoutToCSR,{reason:"next/dynamic",children:(0,d.jsx)(c,{...a})});return(0,d.jsx)(k,{...i?{fallback:h}:{},children:l})}return k.displayName="LoadableComponent",k}},19721,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return e}});let d=a.r(33354)._(a.r(69853));function e(a,b){let c={};"function"==typeof a&&(c.loader=a);let e={...c,...b};return(0,d.default)({...e,modules:e.loadableGenerated?.modules})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},31901,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(19721),f=a.i(3130),g=a.i(40695),h=a.i(84505),i=a.i(71931),j=a.i(69520),k=a.i(99385),l=a.i(13655),m=a.i(13749),n=a.i(50522),o=a.i(74575),p=a.i(54161),q=a.i(23292);let r=(0,e.default)(async()=>{},{loadableGenerated:{modules:[92414]},ssr:!1}),s=(0,e.default)(async()=>{},{loadableGenerated:{modules:[13966]},ssr:!1});function t(){let a=(0,d.useRouter)(),[e,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(!1),{formatCurrency:w}=(0,o.useCurrency)(),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(!0),[F,G]=(0,c.useState)({totalShifts:0,totalSales:0,averagePerShift:0,totalMeterDiff:0}),[H,I]=(0,c.useState)(0),[J,K]=(0,c.useState)(0),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)(null);function R(){try{let a=localStorage.getItem("selectedBranch");if(a){let b=JSON.parse(a);return b.id&&"hq"!==b.id?b.id:null}}catch(a){}return null}async function S(a,b,c,d=0){E(!0);try{let e=new URLSearchParams;e.append("user_id",a),e.append("limit","20"),e.append("offset",(20*d).toString());let f=null,g=localStorage.getItem("selectedBranch");if(g)try{let a=JSON.parse(g);a.id&&"hq"!==a.id&&(f=a.id)}catch(a){}if(!f){let a=localStorage.getItem("user");if(a)try{f=JSON.parse(a).branch_id}catch(a){}}if(!f)try{let a=await fetch("/api/auth/session");if(a.ok){let b=await a.json();f=b.user?.branch_id}}catch(a){}f&&e.append("branch_id",f),b&&e.append("date_from",b),c&&e.append("date_to",c);let h=await fetch(`/api/shifts/list?${e.toString()}`),i=await h.json();if(i.success){C(i.data||[]),K(i.pagination?.total||0),M(i.pagination?.hasMore||!1);let a=i.data.reduce((a,b)=>a+(b.total_sales||0),0),b=i.data.reduce((a,b)=>a+((b.total_closing_reading||0)-(b.total_opening_reading||0)),0);G({totalShifts:i.pagination?.total||i.data.length,totalSales:a,averagePerShift:i.data.length>0?a/i.data.length:0,totalMeterDiff:b})}else q.toast.error(i.error||"Failed to fetch shifts")}catch(a){console.error("Error fetching shifts:",a),q.toast.error("Failed to fetch shifts")}finally{E(!1)}}function T(a){return a?new Date(a).toLocaleString("en-KE",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}return(0,c.useEffect)(()=>{function a(a){"selectedBranch"===a.key&&Q(R())}!async function(){Q(R());let a=localStorage.getItem("user");if(a)try{let b=JSON.parse(a);O(b.id);return}catch(a){console.error("[ShiftsReport] Error parsing localStorage user:",a)}try{let a=await fetch("/api/auth/session");if(a.ok){let b=await a.json();if(b.user?.id)return void O(b.user.id)}}catch(a){console.error("[ShiftsReport] Error fetching session:",a)}E(!1)}();let b=setInterval(()=>{let a=R();Q(b=>b!==a?a:b)},1e3);return window.addEventListener("storage",a),()=>{window.removeEventListener("storage",a),clearInterval(b)}},[]),(0,c.useEffect)(()=>{N&&(I(0),S(N,x,z,0))},[N,P]),(0,c.useEffect)(()=>{N&&(I(0),S(N,x,z,0))},[x,z]),(0,b.jsxs)("div",{className:"flex min-h-screen w-full overflow-x-hidden bg-gradient-to-b from-slate-900 via-blue-900 to-white",children:[(0,b.jsx)(r,{collapsed:e,onToggle:()=>t(!e),mobileOpen:u,onMobileClose:()=>v(!1)}),(0,b.jsx)("div",{className:"flex-1 flex flex-col min-w-0 lg:ml-8 my-2 lg:my-6 mx-2 lg:mr-6",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl lg:rounded-tl-3xl shadow-2xl flex-1 flex flex-col overflow-hidden",children:[(0,b.jsx)(s,{onMobileMenuToggle:()=>v(!u)}),(0,b.jsx)("main",{className:"flex-1 overflow-y-auto overflow-x-hidden bg-slate-50 p-4 lg:p-6",children:(0,b.jsxs)("div",{className:"mx-auto max-w-7xl space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-slate-900",children:"Shifts Report"}),(0,b.jsx)("p",{className:"text-slate-600 mt-1",children:"Cashier shift performance and reconciliation"})]}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",onClick:()=>{let a=localStorage.getItem("user");if(a){let b=JSON.parse(a);O(b.id),S(b.id)}},children:[(0,b.jsx)(j.RefreshCw,{className:`h-4 w-4 mr-2 ${D?"animate-spin":""}`}),"Refresh"]}),(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(i.Printer,{className:"h-4 w-4 mr-2"}),"Print"]}),(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(h.Download,{className:"h-4 w-4 mr-2"}),"Export"]})]})]}),(0,b.jsxs)(f.Card,{className:"rounded-2xl mb-6",children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{children:"Shift Summary"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Total Shifts"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:F.totalShifts})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Total Sales"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:w(F.totalSales)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Average Per Shift"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:w(F.averagePerShift)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Total Volume (L)"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:F.totalMeterDiff.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})]})})]}),(0,b.jsxs)(f.Card,{className:"rounded-2xl",children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)("div",{className:"flex items-center justify-end",children:(0,b.jsxs)("div",{className:"text-sm text-slate-500",children:["Showing ",B.length," of ",J," shifts"]})})}),(0,b.jsx)(f.CardContent,{children:D?(0,b.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,b.jsx)(j.RefreshCw,{className:"h-8 w-8 animate-spin text-slate-400"}),(0,b.jsx)("span",{className:"ml-2 text-slate-500",children:"Loading shifts..."})]}):0===B.length?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-slate-500",children:[(0,b.jsx)(k.Clock,{className:"h-12 w-12 mb-4 text-slate-300"}),(0,b.jsx)("p",{className:"text-lg font-medium",children:"No shifts recorded yet"}),(0,b.jsx)("p",{className:"text-sm",children:"Shifts will appear here when cashiers start and end their shifts via the mobile app"})]}):(0,b.jsxs)("div",{className:"overflow-x-auto",children:[(0,b.jsxs)("table",{className:"w-full min-w-[900px]",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b",children:[(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-slate-700",children:"Branch"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-slate-700",children:"Started By"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-slate-700",children:"Start Time"}),(0,b.jsx)("th",{className:"text-left py-3 px-4 font-semibold text-slate-700",children:"End Time"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 font-semibold text-slate-700",children:"Volume Sold (L)"}),(0,b.jsx)("th",{className:"text-right py-3 px-4 font-semibold text-slate-700",children:"Total Amount"}),(0,b.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-slate-700",children:"Status"}),(0,b.jsx)("th",{className:"text-center py-3 px-4 font-semibold text-slate-700",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:B.map(c=>(0,b.jsxs)("tr",{className:"border-b hover:bg-slate-50",children:[(0,b.jsx)("td",{className:"py-3 px-4",children:c.branch_name||"Unknown"}),(0,b.jsx)("td",{className:"py-3 px-4",children:c.cashier}),(0,b.jsx)("td",{className:"py-3 px-4",children:T(c.start_time)}),(0,b.jsx)("td",{className:"py-3 px-4",children:T(c.end_time)}),(0,b.jsx)("td",{className:"py-3 px-4 text-right font-mono",children:((c.total_closing_reading||0)-(c.total_opening_reading||0)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),(0,b.jsx)("td",{className:"py-3 px-4 text-right font-semibold",children:w(c.total_sales)}),(0,b.jsx)("td",{className:"py-3 px-4 text-center",children:function(a){switch(a){case"active":return(0,b.jsx)(p.Badge,{className:"bg-green-100 text-green-700",children:"Active"});case"completed":return(0,b.jsx)(p.Badge,{className:"bg-blue-100 text-blue-700",children:"Completed"});default:return(0,b.jsx)(p.Badge,{variant:"outline",children:a})}}(c.status)}),(0,b.jsx)("td",{className:"py-3 px-4 text-center",children:(0,b.jsxs)(g.Button,{size:"sm",variant:"outline",onClick:()=>a.push(`/reports/nozzle-sales?shift_id=${c.id}`),children:[(0,b.jsx)(l.Fuel,{className:"h-4 w-4 mr-1"}),"Nozzles"]})})]},c.id))})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-6 pt-4 border-t",children:[(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",onClick:function(){if(H>0&&N){let a=H-1;I(a),S(N,x,z,a)}},disabled:0===H||D,className:"rounded-xl",children:[(0,b.jsx)(m.ChevronLeft,{className:"h-4 w-4 mr-1"}),"Previous"]}),(0,b.jsxs)("span",{className:"text-sm text-slate-500",children:["Page ",H+1," of ",Math.max(1,Math.ceil(J/20))]}),(0,b.jsxs)(g.Button,{variant:"outline",size:"sm",onClick:function(){if(L&&N){let a=H+1;I(a),S(N,x,z,a)}},disabled:!L||D,className:"rounded-xl",children:["Next",(0,b.jsx)(n.ChevronRight,{className:"h-4 w-4 ml-1"})]})]})]})})]}),(0,b.jsxs)("footer",{className:"mt-12 border-t pt-6 pb-4 text-center text-sm text-muted-foreground",children:["Powered by ",(0,b.jsx)("span",{className:"font-semibold text-navy-900",children:"Sensile Technologies East Africa Ltd"})]})]})})]})})]})}a.s(["default",()=>t])}];

//# sourceMappingURL=_b9c861b4._.js.map