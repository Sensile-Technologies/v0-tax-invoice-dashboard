module.exports=[47349,(a,b,c)=>{"use strict";var d=a.r(72131);d.useState,d.useEffect,d.useLayoutEffect,d.useDebugValue,c.useSyncExternalStore=void 0!==d.useSyncExternalStore?d.useSyncExternalStore:function(a,b){return b()}},87610,(a,b,c)=>{"use strict";b.exports=a.r(47349)},69265,a=>{"use strict";var b=a.i(87924),c=a.i(23312),d=a.i(87532),e=a.i(67900),f=a.i(46842),g=a.i(11156),h=a.i(20005),i=a.i(70106);let j=(0,i.default)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),k=(0,i.default)("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),l=(0,i.default)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),m=(0,i.default)("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);var n=a.i(92258),o=a.i(3314),p=a.i(4720),q=a.i(72692),r=a.i(90669),s=a.i(40695),t=a.i(72131),u=a.i(46872),v=a.i(72752);a.i(35112);var w=a.i(11011),x=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,c)=>{let d=(0,w.createSlot)(`Primitive.${c}`),e=t.forwardRef((a,e)=>{let{asChild:f,...g}=a;return(0,b.jsx)(f?d:c,{...g,ref:e})});return e.displayName=`Primitive.${c}`,{...a,[c]:e}},{}),y=a.i(87610);function z(){return()=>{}}var A="Avatar",[B,C]=function(a,c=[]){let d=[],e=()=>{let b=d.map(a=>t.createContext(a));return function(c){let d=c?.[a]||b;return t.useMemo(()=>({[`__scope${a}`]:{...c,[a]:d}}),[c,d])}};return e.scopeName=a,[function(c,e){let f=t.createContext(e);f.displayName=c+"Context";let g=d.length;d=[...d,e];let h=c=>{let{scope:d,children:e,...h}=c,i=d?.[a]?.[g]||f,j=t.useMemo(()=>h,Object.values(h));return(0,b.jsx)(i.Provider,{value:j,children:e})};return h.displayName=c+"Provider",[h,function(b,d){let h=d?.[a]?.[g]||f,i=t.useContext(h);if(i)return i;if(void 0!==e)return e;throw Error(`\`${b}\` must be used within \`${c}\``)}]},function(...a){let b=a[0];if(1===a.length)return b;let c=()=>{let c=a.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){let d=c.reduce((b,{useScope:c,scopeName:d})=>{let e=c(a)[`__scope${d}`];return{...b,...e}},{});return t.useMemo(()=>({[`__scope${b.scopeName}`]:d}),[d])}};return c.scopeName=b.scopeName,c}(e,...c)]}(A),[D,E]=B(A),F=t.forwardRef((a,c)=>{let{__scopeAvatar:d,...e}=a,[f,g]=t.useState("idle");return(0,b.jsx)(D,{scope:d,imageLoadingStatus:f,onImageLoadingStatusChange:g,children:(0,b.jsx)(x.span,{...e,ref:c})})});F.displayName=A;var G="AvatarImage",H=t.forwardRef((a,c)=>{let{__scopeAvatar:d,src:e,onLoadingStatusChange:f=()=>{},...g}=a,h=E(G,d),i=function(a,{referrerPolicy:b,crossOrigin:c}){let d=(0,y.useSyncExternalStore)(z,()=>!0,()=>!1),e=t.useRef(null),f=d?(e.current||(e.current=new window.Image),e.current):null,[g,h]=t.useState(()=>K(f,a));return(0,v.useLayoutEffect)(()=>{h(K(f,a))},[f,a]),(0,v.useLayoutEffect)(()=>{let a=a=>()=>{h(a)};if(!f)return;let d=a("loaded"),e=a("error");return f.addEventListener("load",d),f.addEventListener("error",e),b&&(f.referrerPolicy=b),"string"==typeof c&&(f.crossOrigin=c),()=>{f.removeEventListener("load",d),f.removeEventListener("error",e)}},[f,c,b]),g}(e,g),j=(0,u.useCallbackRef)(a=>{f(a),h.onImageLoadingStatusChange(a)});return(0,v.useLayoutEffect)(()=>{"idle"!==i&&j(i)},[i,j]),"loaded"===i?(0,b.jsx)(x.img,{...g,ref:c,src:e}):null});H.displayName=G;var I="AvatarFallback",J=t.forwardRef((a,c)=>{let{__scopeAvatar:d,delayMs:e,...f}=a,g=E(I,d),[h,i]=t.useState(void 0===e);return t.useEffect(()=>{if(void 0!==e){let a=window.setTimeout(()=>i(!0),e);return()=>window.clearTimeout(a)}},[e]),h&&"loaded"!==g.imageLoadingStatus?(0,b.jsx)(x.span,{...f,ref:c}):null});function K(a,b){return a?b?(a.src!==b&&(a.src=b),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}J.displayName=I;var L=a.i(97895);function M({className:a,...c}){return(0,b.jsx)(F,{"data-slot":"avatar",className:(0,L.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",a),...c})}function N({className:a,...c}){return(0,b.jsx)(H,{"data-slot":"avatar-image",className:(0,L.cn)("aspect-square size-full",a),...c})}function O({className:a,...c}){return(0,b.jsx)(J,{"data-slot":"avatar-fallback",className:(0,L.cn)("bg-muted flex size-full items-center justify-center rounded-full",a),...c})}var P=a.i(76504),Q=a.i(54161),R=a.i(46470),S=a.i(71987),T=a.i(90023),U=a.i(50944);function V({currentBranch:a="nairobi",onBranchChange:i,showSearch:u=!1,onMobileMenuToggle:v}){let[w,x]=(0,t.useState)(a),[y,z]=(0,t.useState)([{id:"hq",name:"Headquarters",type:"headquarters",status:"active"}]),[A,B]=(0,t.useState)([{id:1,title:"Notification 1",message:"This is the first notification",time:"10:00 AM",unread:!0},{id:2,title:"Notification 2",message:"This is the second notification",time:"11:00 AM",unread:!1}]),[C,D]=(0,t.useState)("Headquarters"),[E,F]=(0,t.useState)(""),[G,H]=(0,t.useState)(""),[I,J]=(0,t.useState)(!0),K=(0,U.useRouter)();(0,t.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/auth/session",{credentials:"include"});if(a.ok){let b=await a.json();if(b.success&&b.user){let a=b.user;F(a.username||a.email?.split("@")[0]||"User");let c=(a.role||"").toLowerCase();H(c);let d=!["supervisor","manager"].includes(c);if(J(d),!d&&a.branch_name&&a.branch_id){D(a.branch_name),x(a.branch_id),localStorage.setItem("selectedBranch",JSON.stringify({id:a.branch_id,name:a.branch_name,type:"branch",status:"active"})),localStorage.setItem("currentUser",JSON.stringify(a)),localStorage.setItem("user",JSON.stringify(a));return}localStorage.setItem("currentUser",JSON.stringify(a)),localStorage.setItem("user",JSON.stringify(a));let e=localStorage.getItem("selectedBranch");if(["director","vendor"].includes(c)&&!e)x("hq"),D("Headquarters");else if(e)try{let a=JSON.parse(e);a?.id&&a?.name&&(x(a.id),D(a.name))}catch(a){console.error("Error parsing stored branch:",a)}L(d);return}}}catch(a){console.error("Error fetching session:",a)}L(!0);let a=localStorage.getItem("selectedBranch");if(a)try{let b=JSON.parse(a);b?.name&&D(b.name)}catch(a){console.error("Error parsing stored branch:",a)}})()},[]),(0,t.useEffect)(()=>{},[]);let L=async a=>{try{let b=await fetch("/api/branches/list",{credentials:"include"});if(b.ok){let c=await b.json();if(a){let a=[{id:"hq",name:"Headquarters",type:"headquarters",status:"active"},...c.map(a=>({id:a.id,name:a.name,type:"branch",status:a.status||"active"}))];z(a)}else z(c.map(a=>({id:a.id,name:a.name,type:"branch",status:a.status||"active"})))}}catch(a){console.error("Error fetching branches:",a)}},V=async()=>{await (0,T.signOut)(),K.push("/auth/login")};return(0,b.jsxs)("header",{className:"flex h-16 items-center justify-between border-b bg-card px-3 md:px-6",children:[(0,b.jsxs)("div",{className:"flex flex-1 items-center gap-2 md:gap-4",children:[v&&(0,b.jsx)(s.Button,{variant:"outline",size:"icon",onClick:v,className:"lg:hidden h-10 w-10 flex-shrink-0 border-slate-300 bg-slate-100 hover:bg-slate-200",children:(0,b.jsx)(q.Menu,{className:"h-6 w-6 text-slate-700"})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(S.default,{src:"/flow360-logo.png",alt:"Flow360 Logo",width:28,height:28,className:"rounded-lg hidden sm:block"}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsxs)("span",{className:"text-xs md:text-sm text-muted-foreground hidden sm:block",children:["Welcome back, ",E]}),(0,b.jsx)("span",{className:"text-sm md:text-lg font-bold truncate max-w-[120px] sm:max-w-none",children:C})]})]}),u&&(0,b.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,b.jsx)(d.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)("input",{type:"search",placeholder:"Search...",className:"pl-9 h-10 w-full rounded-xl border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[I&&(0,b.jsxs)(P.DropdownMenu,{children:[(0,b.jsx)(P.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(s.Button,{variant:"outline",className:"gap-2 rounded-xl bg-transparent",children:[(0,b.jsx)(e.Building2,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:C})]})}),(0,b.jsxs)(P.DropdownMenuContent,{align:"end",className:"w-80 rounded-xl",children:[(0,b.jsx)(P.DropdownMenuLabel,{children:"Switch Branch"}),(0,b.jsx)(P.DropdownMenuSeparator,{}),y.map(a=>(0,b.jsxs)(P.DropdownMenuItem,{onClick:()=>{"pending_onboarding"!==a.status&&(a=>{if(!I)return console.warn("Branch switching is not allowed for this role");if(x(a),"hq"===a)localStorage.removeItem("selectedBranch"),D("Headquarters"),K.push("/headquarters");else{let b=y.find(b=>b.id===a);b&&(localStorage.setItem("selectedBranch",JSON.stringify(b)),D(b.name),K.push(`/sales/summary?branch=${a}`)),i&&i(a)}})(a.id)},className:`cursor-pointer rounded-lg ${"pending_onboarding"===a.status?"opacity-60":""}`,children:[(0,b.jsx)(e.Building2,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{children:a.name}),"pending_onboarding"===a.status?(0,b.jsx)(Q.Badge,{variant:"outline",className:"ml-auto rounded-full text-orange-600 border-orange-300",children:"Pending Admin Approval"}):a.id===w?(0,b.jsx)(Q.Badge,{className:"ml-auto rounded-full",children:"Active"}):null]},a.id))]})]}),(0,b.jsxs)(P.DropdownMenu,{children:[(0,b.jsx)(P.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(s.Button,{variant:"ghost",size:"icon",className:"rounded-xl",children:(0,b.jsx)(j,{className:"h-5 w-5"})})}),(0,b.jsxs)(P.DropdownMenuContent,{align:"end",className:"w-56 rounded-xl",children:[(0,b.jsx)(P.DropdownMenuLabel,{children:"Help & Support"}),(0,b.jsx)(P.DropdownMenuSeparator,{}),(0,b.jsxs)(P.DropdownMenuItem,{className:"cursor-pointer rounded-lg",children:[(0,b.jsx)(k,{className:"mr-2 h-4 w-4"}),"User Manuals"]}),(0,b.jsxs)(P.DropdownMenuItem,{className:"cursor-pointer rounded-lg",children:[(0,b.jsx)(l,{className:"mr-2 h-4 w-4"}),"Helpful Links"]}),(0,b.jsx)(P.DropdownMenuSeparator,{}),(0,b.jsxs)(P.DropdownMenuItem,{className:"cursor-pointer rounded-lg",children:[(0,b.jsx)(n.Mail,{className:"mr-2 h-4 w-4"}),"Contact Support"]}),(0,b.jsxs)(P.DropdownMenuItem,{className:"cursor-pointer rounded-lg",children:[(0,b.jsx)(m,{className:"mr-2 h-4 w-4"}),"In-App Chat"]})]})]}),(0,b.jsxs)(P.DropdownMenu,{children:[(0,b.jsx)(P.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(s.Button,{variant:"ghost",size:"icon",className:"relative rounded-xl",children:[(0,b.jsx)(c.Bell,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"absolute -right-1 -top-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs text-white",children:"2"})]})}),(0,b.jsxs)(P.DropdownMenuContent,{align:"end",className:"w-80 rounded-xl",children:[(0,b.jsx)(P.DropdownMenuLabel,{children:"Notifications"}),(0,b.jsx)(P.DropdownMenuSeparator,{}),(0,b.jsx)(R.ScrollArea,{className:"h-72",children:A.map(a=>(0,b.jsx)("div",{className:`px-4 py-3 hover:bg-accent rounded-lg cursor-pointer ${a.unread?"bg-blue-50":""}`,children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:a.title}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.message}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:a.time})]}),a.unread&&(0,b.jsx)("div",{className:"h-2 w-2 rounded-full bg-blue-500 mt-1"})]})},a.id))}),(0,b.jsx)(P.DropdownMenuSeparator,{}),(0,b.jsx)(P.DropdownMenuItem,{className:"cursor-pointer justify-center rounded-lg",children:"Mark all as read"})]})]}),(0,b.jsxs)(P.DropdownMenu,{children:[(0,b.jsx)(P.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(s.Button,{variant:"ghost",className:"relative h-10 w-10 rounded-full",children:(0,b.jsxs)(M,{children:[(0,b.jsx)(N,{src:"/professional-avatar.png",alt:"User"}),(0,b.jsx)(O,{children:"JD"})]})})}),(0,b.jsxs)(P.DropdownMenuContent,{className:"w-56 rounded-xl",align:"end",forceMount:!0,children:[(0,b.jsx)(P.DropdownMenuLabel,{children:"My Account"}),(0,b.jsx)(P.DropdownMenuSeparator,{}),(0,b.jsxs)(P.DropdownMenuItem,{className:"cursor-pointer rounded-lg",children:[(0,b.jsx)(f.User,{className:"mr-2 h-4 w-4"}),"Profile Settings"]}),(0,b.jsxs)(P.DropdownMenuItem,{className:"cursor-pointer rounded-lg",children:[(0,b.jsx)(g.CreditCard,{className:"mr-2 h-4 w-4"}),"Manage Subscription"]}),(0,b.jsx)(P.DropdownMenuSeparator,{}),(0,b.jsx)(P.DropdownMenuItem,{className:"cursor-pointer rounded-lg",children:"Account Preferences"}),(0,b.jsxs)(P.DropdownMenuItem,{onClick:()=>K.push("/security-settings"),className:"cursor-pointer rounded-lg",children:[(0,b.jsx)(o.Shield,{className:"mr-2 h-4 w-4"}),"Security Settings"]}),(0,b.jsxs)(P.DropdownMenuItem,{onClick:()=>K.push("/controller-logs"),className:"cursor-pointer rounded-lg",children:[(0,b.jsx)(r.Activity,{className:"mr-2 h-4 w-4"}),"Controller Logs"]}),(0,b.jsxs)(P.DropdownMenuItem,{onClick:()=>K.push("/logs"),className:"cursor-pointer rounded-lg",children:[(0,b.jsx)(p.FileText,{className:"mr-2 h-4 w-4"}),"Logs"]}),(0,b.jsx)(P.DropdownMenuSeparator,{}),(0,b.jsxs)(P.DropdownMenuItem,{onClick:V,className:"cursor-pointer text-red-600 rounded-lg",children:[(0,b.jsx)(h.LogOut,{className:"mr-2 h-4 w-4"}),"Log out"]})]})]})]})]})}a.s(["DashboardHeader",()=>V,"default",0,V],69265)}];

//# sourceMappingURL=_b5edb5b6._.js.map