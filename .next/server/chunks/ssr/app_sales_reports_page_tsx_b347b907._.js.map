{"version":3,"sources":["../../../../app/sales/reports/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { DashboardSidebar } from \"@/components/dashboard-sidebar\"\nimport { DashboardHeader } from \"@/components/dashboard-header\"\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { Label } from \"@/components/ui/label\"\nimport { Button } from \"@/components/ui/button\"\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\"\nimport { Table, TableBody, TableCell, TableHeader, TableRow } from \"@/components/ui/table\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { useCurrency } from \"@/lib/currency-utils\"\nimport { toast } from \"sonner\"\nimport { ChevronLeft, ChevronRight, FileText, CreditCard, MoreVertical } from \"lucide-react\"\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\"\n\nconst PAGE_SIZE = 50\n\nexport default function SalesReportsPage() {\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false)\n  const { formatCurrency } = useCurrency()\n  const [sales, setSales] = useState<any[]>([])\n  const [nozzles, setNozzles] = useState<any[]>([])\n  const [dispensers, setDispensers] = useState<any[]>([])\n  const [loading, setLoading] = useState(false)\n  const [currentPage, setCurrentPage] = useState(1)\n  const [totalCount, setTotalCount] = useState(0)\n\n  const [filters, setFilters] = useState({\n    date: \"\",\n    invoiceNumber: \"\",\n    fuelType: \"\",\n    nozzle: \"\",\n    loyalty: \"all\",\n    paymentMethod: \"\",\n  })\n\n  useEffect(() => {\n    fetchData()\n  }, [currentPage])\n\n  async function fetchData() {\n    try {\n      setLoading(true)\n      const currentBranch = localStorage.getItem(\"selectedBranch\")\n      if (!currentBranch) {\n        toast.error(\"No branch selected\")\n        return\n      }\n\n      const branchData = JSON.parse(currentBranch)\n      const branchId = branchData.id\n\n      const [nozzlesRes, dispensersRes, salesRes] = await Promise.all([\n        fetch(`/api/nozzles?branch_id=${branchId}&status=active`),\n        fetch(`/api/dispensers?branch_id=${branchId}`),\n        fetch(`/api/sales?branch_id=${branchId}`)\n      ])\n\n      const [nozzlesResult, dispensersResult, salesResult] = await Promise.all([\n        nozzlesRes.json(),\n        dispensersRes.json(),\n        salesRes.json()\n      ])\n\n      setNozzles(nozzlesResult.success ? nozzlesResult.data || [] : [])\n      setDispensers(dispensersResult.success ? dispensersResult.data || [] : [])\n\n      const allSales = salesResult.success ? salesResult.data || [] : []\n      setTotalCount(allSales.length)\n\n      const offset = (currentPage - 1) * PAGE_SIZE\n      const paginatedSales = allSales.slice(offset, offset + PAGE_SIZE)\n\n      const processedSales = paginatedSales.map((sale: any) => ({\n        ...sale,\n        quantity: Number(sale.quantity) || 0,\n        unit_price: Number(sale.unit_price) || 0,\n        total_amount: Number(sale.total_amount) || 0,\n        meter_reading_after: Number(sale.meter_reading_after) || 0,\n      }))\n      setSales(processedSales)\n    } catch (error) {\n      console.error(\"Error fetching data:\", error)\n      toast.error(\"Failed to load sales data\")\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const filteredSales = sales.filter((sale) => {\n    if (filters.date) {\n      const saleDate = new Date(sale.sale_date).toISOString().split(\"T\")[0]\n      if (saleDate !== filters.date) return false\n    }\n    if (filters.invoiceNumber) {\n      const invoiceMatch = (sale.invoice_number || sale.receipt_number || \"\")\n        .toLowerCase()\n        .includes(filters.invoiceNumber.toLowerCase())\n      if (!invoiceMatch) return false\n    }\n    if (filters.fuelType && filters.fuelType !== \"all\") {\n      if (sale.fuel_type !== filters.fuelType) return false\n    }\n    if (filters.nozzle && filters.nozzle !== \"all\") {\n      if (sale.nozzle_id !== filters.nozzle) return false\n    }\n    if (filters.loyalty === \"loyalty\") {\n      if (!sale.is_loyalty_sale) return false\n    } else if (filters.loyalty === \"non-loyalty\") {\n      if (sale.is_loyalty_sale) return false\n    }\n    if (filters.paymentMethod && filters.paymentMethod !== \"all\") {\n      const normalizePaymentMethod = (method: string) => {\n        const m = (method || \"cash\").toLowerCase()\n        if (m === \"mpesa\" || m === \"m-pesa\" || m === \"mobile_money\") return \"mobile_money\"\n        if (m === \"card\") return \"card\"\n        if (m === \"credit\") return \"credit\"\n        return \"cash\"\n      }\n      if (normalizePaymentMethod(sale.payment_method) !== filters.paymentMethod) return false\n    }\n    return true\n  })\n\n  const uniqueFuelTypes = Array.from(new Set(sales.map((s) => s.fuel_type)))\n  const uniqueNozzles = Array.from(new Set(sales.map((s) => s.nozzle_id)))\n  const totalPages = Math.ceil(totalCount / PAGE_SIZE)\n\n  function getStatusBadgeVariant(status: string) {\n    switch (status) {\n      case \"transmitted\": return \"default\"\n      case \"pending\": return \"secondary\"\n      case \"flagged\": return \"destructive\"\n      default: return \"secondary\"\n    }\n  }\n\n  function clearFilters() {\n    setFilters({ date: \"\", invoiceNumber: \"\", fuelType: \"\", nozzle: \"\", loyalty: \"all\", paymentMethod: \"\" })\n  }\n\n  return (\n    <div className=\"flex min-h-screen bg-gradient-to-b from-slate-900 via-blue-900 to-white\">\n      <DashboardSidebar collapsed={sidebarCollapsed} onToggle={() => setSidebarCollapsed(!sidebarCollapsed)} />\n\n      <div className=\"flex-1 flex flex-col ml-8 my-6 mr-6\">\n        <div className=\"bg-white rounded-tl-3xl shadow-2xl flex-1 flex flex-col overflow-hidden\">\n          <DashboardHeader />\n\n          <main className=\"flex-1 overflow-y-auto bg-slate-50 p-6\">\n            <div className=\"mx-auto max-w-7xl space-y-6\">\n              <div>\n                <h2 className=\"text-2xl font-bold text-slate-900\">Sales Reports</h2>\n                <p className=\"text-slate-600\">View and filter sales transactions</p>\n              </div>\n\n              <Card className=\"rounded-2xl\">\n                <CardHeader>\n                  <div className=\"flex items-start justify-between gap-4\">\n                    <div>\n                      <CardTitle>Sales Report</CardTitle>\n                      <CardDescription>Fuel sales transactions with filters and pagination</CardDescription>\n                    </div>\n                    <div className=\"flex flex-wrap gap-2 items-center ml-auto\">\n                      <div className=\"flex items-center gap-2\">\n                        <Label htmlFor=\"date-filter\" className=\"text-sm whitespace-nowrap\">Date:</Label>\n                        <Input\n                          id=\"date-filter\"\n                          type=\"date\"\n                          value={filters.date}\n                          onChange={(e) => setFilters({ ...filters, date: e.target.value })}\n                          className=\"w-40 h-9\"\n                        />\n                      </div>\n\n                      <div className=\"flex items-center gap-2\">\n                        <Label htmlFor=\"invoice-filter\" className=\"text-sm whitespace-nowrap\">Invoice:</Label>\n                        <Input\n                          id=\"invoice-filter\"\n                          type=\"text\"\n                          placeholder=\"Search...\"\n                          value={filters.invoiceNumber}\n                          onChange={(e) => setFilters({ ...filters, invoiceNumber: e.target.value })}\n                          className=\"w-32 h-9\"\n                        />\n                      </div>\n\n                      <div className=\"flex items-center gap-2\">\n                        <Label htmlFor=\"fuel-filter\" className=\"text-sm whitespace-nowrap\">Fuel:</Label>\n                        <Select value={filters.fuelType} onValueChange={(value) => setFilters({ ...filters, fuelType: value })}>\n                          <SelectTrigger id=\"fuel-filter\" className=\"w-32 h-9\">\n                            <SelectValue placeholder=\"All\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"all\">All</SelectItem>\n                            {uniqueFuelTypes.map((type) => (\n                              <SelectItem key={type} value={type}>{type}</SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                      </div>\n\n                      <div className=\"flex items-center gap-2\">\n                        <Label htmlFor=\"nozzle-filter\" className=\"text-sm whitespace-nowrap\">Nozzle:</Label>\n                        <Select value={filters.nozzle} onValueChange={(value) => setFilters({ ...filters, nozzle: value })}>\n                          <SelectTrigger id=\"nozzle-filter\" className=\"w-32 h-9\">\n                            <SelectValue placeholder=\"All\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"all\">All</SelectItem>\n                            {uniqueNozzles.map((nozzleId) => {\n                              const nozzle = nozzles.find((n) => n.id === nozzleId)\n                              const dispenser = nozzle ? dispensers.find((d) => d.id === nozzle.dispenser_id) : null\n                              return (\n                                <SelectItem key={nozzleId} value={nozzleId}>\n                                  {dispenser && nozzle ? `D${dispenser.dispenser_number}N${nozzle.nozzle_number}` : \"Unknown\"}\n                                </SelectItem>\n                              )\n                            })}\n                          </SelectContent>\n                        </Select>\n                      </div>\n\n                      <div className=\"flex items-center gap-2\">\n                        <Label htmlFor=\"payment-filter\" className=\"text-sm whitespace-nowrap\">Payment:</Label>\n                        <Select value={filters.paymentMethod} onValueChange={(value) => setFilters({ ...filters, paymentMethod: value })}>\n                          <SelectTrigger id=\"payment-filter\" className=\"w-32 h-9\">\n                            <SelectValue placeholder=\"All\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"all\">All</SelectItem>\n                            <SelectItem value=\"cash\">Cash</SelectItem>\n                            <SelectItem value=\"mobile_money\">Mobile Money</SelectItem>\n                            <SelectItem value=\"card\">Card</SelectItem>\n                            <SelectItem value=\"credit\">Credit</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n\n                      <div className=\"flex items-center gap-2\">\n                        <Label htmlFor=\"loyalty-filter\" className=\"text-sm whitespace-nowrap\">Loyalty:</Label>\n                        <Select value={filters.loyalty} onValueChange={(value) => setFilters({ ...filters, loyalty: value })}>\n                          <SelectTrigger id=\"loyalty-filter\" className=\"w-32 h-9\">\n                            <SelectValue placeholder=\"All\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"all\">All</SelectItem>\n                            <SelectItem value=\"loyalty\">Loyalty Only</SelectItem>\n                            <SelectItem value=\"non-loyalty\">Walk-in</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n\n                      <Button variant=\"outline\" size=\"sm\" onClick={clearFilters}>Clear</Button>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    {filteredSales.length === 0 ? (\n                      <p className=\"text-sm text-slate-500\">\n                        {sales.length === 0 ? \"No sales recorded yet\" : \"No sales match the current filters\"}\n                      </p>\n                    ) : (\n                      <div className=\"overflow-x-auto\">\n                        <Table className=\"w-full\">\n                          <TableHeader>\n                            <TableRow>\n                              <TableCell className=\"text-left p-2\">Date</TableCell>\n                              <TableCell className=\"text-left p-2\">Invoice No.</TableCell>\n                              <TableCell className=\"text-left p-2\">Nozzle</TableCell>\n                              <TableCell className=\"text-left p-2\">Fuel Type</TableCell>\n                              <TableCell className=\"text-right p-2\">Quantity (L)</TableCell>\n                              <TableCell className=\"text-right p-2\">Unit Price</TableCell>\n                              <TableCell className=\"text-right p-2\">Total</TableCell>\n                              <TableCell className=\"text-center p-2\">Payment</TableCell>\n                              <TableCell className=\"text-center p-2\">Loyalty</TableCell>\n                              <TableCell className=\"text-right p-2\">Meter Reading</TableCell>\n                              <TableCell className=\"text-center p-2\">Status</TableCell>\n                              <TableCell className=\"text-center p-2\">Actions</TableCell>\n                            </TableRow>\n                          </TableHeader>\n                          <TableBody>\n                            {filteredSales.map((sale) => {\n                              const nozzle = nozzles.find((n) => n.id === sale.nozzle_id)\n                              const dispenser = nozzle ? dispensers.find((d) => d.id === nozzle.dispenser_id) : null\n\n                              return (\n                                <TableRow key={sale.id} className=\"hover:bg-slate-50\">\n                                  <TableCell className=\"p-2\">\n                                    {new Date(sale.sale_date).toLocaleDateString(\"en-US\", {\n                                      month: \"short\",\n                                      day: \"numeric\",\n                                      hour: \"2-digit\",\n                                      minute: \"2-digit\",\n                                    })}\n                                  </TableCell>\n                                  <TableCell className=\"p-2 text-sm font-mono\">\n                                    {sale.invoice_number || sale.receipt_number}\n                                  </TableCell>\n                                  <TableCell className=\"p-2 text-sm\">\n                                    {dispenser && nozzle ? `D${dispenser.dispenser_number}N${nozzle.nozzle_number}` : \"-\"}\n                                  </TableCell>\n                                  <TableCell className=\"p-2\">{sale.fuel_type}</TableCell>\n                                  <TableCell className=\"p-2 text-right\">{Number(sale.quantity).toFixed(2)}</TableCell>\n                                  <TableCell className=\"p-2 text-right\">{formatCurrency(sale.unit_price)}</TableCell>\n                                  <TableCell className=\"p-2 text-right font-medium\">{formatCurrency(sale.total_amount)}</TableCell>\n                                  <TableCell className=\"p-2 text-center\">\n                                    <Badge variant=\"outline\" className=\"capitalize\">\n                                      {(() => {\n                                        const m = (sale.payment_method || \"cash\").toLowerCase()\n                                        if (m === \"mpesa\" || m === \"m-pesa\" || m === \"mobile_money\") return \"Mobile Money\"\n                                        if (m === \"card\") return \"Card\"\n                                        if (m === \"credit\") return \"Credit\"\n                                        return \"Cash\"\n                                      })()}\n                                    </Badge>\n                                  </TableCell>\n                                  <TableCell className=\"p-2 text-center\">\n                                    {sale.is_loyalty_sale && (\n                                      <div className=\"flex items-center justify-center\">\n                                        <svg className=\"w-5 h-5 text-green-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                          <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                                        </svg>\n                                      </div>\n                                    )}\n                                  </TableCell>\n                                  <TableCell className=\"p-2 text-right font-mono text-sm\">{sale.meter_reading_after.toFixed(2)}</TableCell>\n                                  <TableCell className=\"p-2 text-center\">\n                                    <Badge variant={getStatusBadgeVariant(sale.transmission_status)} className=\"capitalize\">\n                                      {sale.transmission_status || \"pending\"}\n                                    </Badge>\n                                  </TableCell>\n                                  <TableCell className=\"p-2 text-center\">\n                                    <DropdownMenu>\n                                      <DropdownMenuTrigger asChild>\n                                        <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\n                                          <MoreVertical className=\"h-4 w-4\" />\n                                        </Button>\n                                      </DropdownMenuTrigger>\n                                      <DropdownMenuContent align=\"end\">\n                                        <DropdownMenuItem onClick={() => toast.info(`Viewing invoice ${sale.invoice_number}`)}>\n                                          <FileText className=\"h-4 w-4 mr-2\" />\n                                          View Invoice\n                                        </DropdownMenuItem>\n                                        <DropdownMenuItem onClick={() => toast.info(\"Credit note feature\")}>\n                                          <CreditCard className=\"h-4 w-4 mr-2\" />\n                                          Issue Credit Note\n                                        </DropdownMenuItem>\n                                      </DropdownMenuContent>\n                                    </DropdownMenu>\n                                  </TableCell>\n                                </TableRow>\n                              )\n                            })}\n                          </TableBody>\n                        </Table>\n                      </div>\n                    )}\n\n                    {totalPages > 1 && (\n                      <div className=\"flex items-center justify-between pt-4 border-t\">\n                        <p className=\"text-sm text-slate-600\">\n                          Showing {(currentPage - 1) * PAGE_SIZE + 1} to {Math.min(currentPage * PAGE_SIZE, totalCount)} of {totalCount} transactions\n                        </p>\n                        <div className=\"flex items-center gap-2\">\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            disabled={currentPage === 1}\n                            onClick={() => setCurrentPage(currentPage - 1)}\n                          >\n                            <ChevronLeft className=\"h-4 w-4 mr-1\" />\n                            Previous\n                          </Button>\n                          <span className=\"text-sm text-slate-600\">\n                            Page {currentPage} of {totalPages}\n                          </span>\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            disabled={currentPage === totalPages}\n                            onClick={() => setCurrentPage(currentPage + 1)}\n                          >\n                            Next\n                            <ChevronRight className=\"h-4 w-4 ml-1\" />\n                          </Button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n\n              <footer className=\"mt-12 border-t pt-6 pb-4 text-center text-sm text-muted-foreground\">\n                Powered by <span className=\"font-semibold text-foreground\">Sensile Technologies East Africa Ltd</span>\n              </footer>\n            </div>\n          </main>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}