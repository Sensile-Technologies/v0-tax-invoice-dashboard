{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db/client.ts"],"sourcesContent":["import { Pool } from 'pg';\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n  ssl: process.env.NODE_ENV === 'production' ? { rejectUnauthorized: false } : false,\n});\n\nexport async function query<T = any>(text: string, params?: any[]): Promise<T[]> {\n  const client = await pool.connect();\n  try {\n    const result = await client.query(text, params);\n    return result.rows as T[];\n  } finally {\n    client.release();\n  }\n}\n\nexport async function queryOne<T = any>(text: string, params?: any[]): Promise<T | null> {\n  const rows = await query<T>(text, params);\n  return rows[0] || null;\n}\n\nexport async function execute(text: string, params?: any[]): Promise<number> {\n  const client = await pool.connect();\n  try {\n    const result = await client.query(text, params);\n    return result.rowCount || 0;\n  } finally {\n    client.release();\n  }\n}\n\nexport { pool };\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;;;AAEA,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,KAAK,sCAAwC,0BAAgC;AAC/E;AAEO,eAAe,MAAe,IAAY,EAAE,MAAc;IAC/D,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO,OAAO,IAAI;IACpB,SAAU;QACR,OAAO,OAAO;IAChB;AACF;AAEO,eAAe,SAAkB,IAAY,EAAE,MAAc;IAClE,MAAM,OAAO,MAAM,MAAS,MAAM;IAClC,OAAO,IAAI,CAAC,EAAE,IAAI;AACpB;AAEO,eAAe,QAAQ,IAAY,EAAE,MAAc;IACxD,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO,OAAO,QAAQ,IAAI;IAC5B,SAAU;QACR,OAAO,OAAO;IAChB;AACF"}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db/index.ts"],"sourcesContent":["export * from './client';\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/mobile/loyalty-transaction/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { pool } from '@/lib/db'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const {\n      branch_id,\n      sale_id,\n      customer_name,\n      customer_pin,\n      transaction_amount,\n      fuel_type,\n      quantity,\n      payment_method,\n    } = body\n\n    if (!branch_id || !sale_id || !customer_name) {\n      return NextResponse.json(\n        { error: 'branch_id, sale_id, and customer_name are required' },\n        { status: 400 }\n      )\n    }\n\n    const points_earned = Math.floor(transaction_amount / 100)\n\n    const result = await pool.query(\n      `INSERT INTO loyalty_transactions \n       (branch_id, sale_id, customer_name, customer_pin, transaction_date, transaction_amount, points_earned, payment_method, fuel_type, quantity)\n       VALUES ($1, $2, $3, $4, NOW(), $5, $6, $7, $8, $9)\n       RETURNING id`,\n      [\n        branch_id,\n        sale_id,\n        customer_name,\n        customer_pin || '',\n        transaction_amount,\n        points_earned,\n        payment_method,\n        fuel_type,\n        quantity\n      ]\n    )\n\n    return NextResponse.json({ \n      success: true, \n      transaction_id: result.rows[0].id,\n      points_earned \n    })\n  } catch (error: any) {\n    console.error('Error creating loyalty transaction:', error)\n    return NextResponse.json(\n      { error: error.message || 'Failed to create loyalty transaction' },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;;;;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EACJ,SAAS,EACT,OAAO,EACP,aAAa,EACb,YAAY,EACZ,kBAAkB,EAClB,SAAS,EACT,QAAQ,EACR,cAAc,EACf,GAAG;QAEJ,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,eAAe;YAC5C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAqD,GAC9D;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,gBAAgB,KAAK,KAAK,CAAC,qBAAqB;QAEtD,MAAM,SAAS,MAAM,6HAAI,CAAC,KAAK,CAC7B,CAAC;;;mBAGY,CAAC,EACd;YACE;YACA;YACA;YACA,gBAAgB;YAChB;YACA;YACA;YACA;YACA;SACD;QAGH,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,gBAAgB,OAAO,IAAI,CAAC,EAAE,CAAC,EAAE;YACjC;QACF;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,uCAAuC;QACrD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,MAAM,OAAO,IAAI;QAAuC,GACjE;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}