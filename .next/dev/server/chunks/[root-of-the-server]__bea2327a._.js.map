{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db/client.ts"],"sourcesContent":["import { Pool } from 'pg';\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n  ssl: process.env.NODE_ENV === 'production' ? { rejectUnauthorized: false } : false,\n});\n\nexport async function query<T = any>(text: string, params?: any[]): Promise<T[]> {\n  const client = await pool.connect();\n  try {\n    const result = await client.query(text, params);\n    return result.rows as T[];\n  } finally {\n    client.release();\n  }\n}\n\nexport async function queryOne<T = any>(text: string, params?: any[]): Promise<T | null> {\n  const rows = await query<T>(text, params);\n  return rows[0] || null;\n}\n\nexport async function execute(text: string, params?: any[]): Promise<number> {\n  const client = await pool.connect();\n  try {\n    const result = await client.query(text, params);\n    return result.rowCount || 0;\n  } finally {\n    client.release();\n  }\n}\n\nexport { pool };\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;;;AAEA,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,KAAK,sCAAwC,0BAAgC;AAC/E;AAEO,eAAe,MAAe,IAAY,EAAE,MAAc;IAC/D,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO,OAAO,IAAI;IACpB,SAAU;QACR,OAAO,OAAO;IAChB;AACF;AAEO,eAAe,SAAkB,IAAY,EAAE,MAAc;IAClE,MAAM,OAAO,MAAM,MAAS,MAAM;IAClC,OAAO,IAAI,CAAC,EAAE,IAAI;AACpB;AAEO,eAAe,QAAQ,IAAY,EAAE,MAAc;IACxD,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO,OAAO,QAAQ,IAAI;IAC5B,SAAU;QACR,OAAO,OAAO;IAChB;AACF"}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db/index.ts"],"sourcesContent":["export * from './client';\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/branches/%5Bid%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { query } from \"@/lib/db\"\n\nexport async function GET(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params\n\n    const result = await query(\n      \"SELECT * FROM branches WHERE id = $1\",\n      [id]\n    )\n\n    if (result.rows.length === 0) {\n      return NextResponse.json({ error: \"Branch not found\" }, { status: 404 })\n    }\n\n    return NextResponse.json(result.rows[0])\n  } catch (error) {\n    console.error(\"[Branch GET Error]:\", error)\n    return NextResponse.json(\n      { error: error instanceof Error ? error.message : \"Unknown error\" },\n      { status: 500 }\n    )\n  }\n}\n\nexport async function PUT(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params\n    const body = await request.json()\n\n    const {\n      name,\n      location,\n      manager,\n      email,\n      phone,\n      address,\n      county,\n      localTaxOffice,\n      storageIndices,\n      tankConfig,\n    } = body\n\n    const result = await query(\n      `UPDATE branches SET\n        name = COALESCE($1, name),\n        location = COALESCE($2, location),\n        manager = COALESCE($3, manager),\n        email = COALESCE($4, email),\n        phone = COALESCE($5, phone),\n        address = COALESCE($6, address),\n        county = COALESCE($7, county),\n        local_tax_office = COALESCE($8, local_tax_office),\n        storage_indices = COALESCE($9, storage_indices),\n        tank_config = COALESCE($10, tank_config),\n        updated_at = NOW()\n      WHERE id = $11\n      RETURNING *`,\n      [\n        name,\n        location,\n        manager,\n        email,\n        phone,\n        address,\n        county,\n        localTaxOffice,\n        storageIndices ? JSON.stringify(storageIndices) : null,\n        tankConfig ? JSON.stringify(tankConfig) : null,\n        id,\n      ]\n    )\n\n    if (result.rows.length === 0) {\n      return NextResponse.json({ error: \"Branch not found\" }, { status: 404 })\n    }\n\n    return NextResponse.json(result.rows[0])\n  } catch (error) {\n    console.error(\"[Branch PUT Error]:\", error)\n    return NextResponse.json(\n      { error: error instanceof Error ? error.message : \"Unknown error\" },\n      { status: 500 }\n    )\n  }\n}\n\nexport async function PATCH(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params\n    const body = await request.json()\n\n    const { status } = body\n\n    if (!status) {\n      return NextResponse.json({ error: \"Status is required\" }, { status: 400 })\n    }\n\n    const result = await query(\n      `UPDATE branches SET status = $1, updated_at = NOW() WHERE id = $2 RETURNING *`,\n      [status, id]\n    )\n\n    if (result.rows.length === 0) {\n      return NextResponse.json({ error: \"Branch not found\" }, { status: 404 })\n    }\n\n    return NextResponse.json(result.rows[0])\n  } catch (error) {\n    console.error(\"[Branch PATCH Error]:\", error)\n    return NextResponse.json(\n      { error: error instanceof Error ? error.message : \"Unknown error\" },\n      { status: 500 }\n    )\n  }\n}\n\nexport async function DELETE(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params\n\n    const result = await query(\n      \"DELETE FROM branches WHERE id = $1 RETURNING *\",\n      [id]\n    )\n\n    if (result.rows.length === 0) {\n      return NextResponse.json({ error: \"Branch not found\" }, { status: 404 })\n    }\n\n    return NextResponse.json({ success: true, deleted: result.rows[0] })\n  } catch (error) {\n    console.error(\"[Branch DELETE Error]:\", error)\n    return NextResponse.json(\n      { error: error instanceof Error ? error.message : \"Unknown error\" },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":"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"}}]
}