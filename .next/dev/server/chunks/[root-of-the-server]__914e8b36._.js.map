{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db/client.ts"],"sourcesContent":["import { Pool } from 'pg';\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n  ssl: process.env.NODE_ENV === 'production' ? { rejectUnauthorized: false } : false,\n});\n\nexport async function query<T = any>(text: string, params?: any[]): Promise<T[]> {\n  const client = await pool.connect();\n  try {\n    const result = await client.query(text, params);\n    return result.rows as T[];\n  } finally {\n    client.release();\n  }\n}\n\nexport async function queryOne<T = any>(text: string, params?: any[]): Promise<T | null> {\n  const rows = await query<T>(text, params);\n  return rows[0] || null;\n}\n\nexport async function execute(text: string, params?: any[]): Promise<number> {\n  const client = await pool.connect();\n  try {\n    const result = await client.query(text, params);\n    return result.rowCount || 0;\n  } finally {\n    client.release();\n  }\n}\n\nexport { pool };\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;;;AAEA,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,KAAK,sCAAwC,0BAAgC;AAC/E;AAEO,eAAe,MAAe,IAAY,EAAE,MAAc;IAC/D,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO,OAAO,IAAI;IACpB,SAAU;QACR,OAAO,OAAO;IAChB;AACF;AAEO,eAAe,SAAkB,IAAY,EAAE,MAAc;IAClE,MAAM,OAAO,MAAM,MAAS,MAAM;IAClC,OAAO,IAAI,CAAC,EAAE,IAAI;AACpB;AAEO,eAAe,QAAQ,IAAY,EAAE,MAAc;IACxD,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO,OAAO,QAAQ,IAAI;IAC5B,SAAU;QACR,OAAO,OAAO;IAChB;AACF"}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db/index.ts"],"sourcesContent":["export * from './client';\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/admin/operations/hardware/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { query } from \"@/lib/db\"\n\nexport async function GET() {\n  try {\n    const result = await query(`\n      SELECT \n        h.id, h.serial_number, h.hardware_type as device_type, h.branch_id, h.status,\n        h.assigned_to, h.assigned_date as assigned_at, h.created_at,\n        b.name as branch_name,\n        v.name as merchant_name,\n        u.username as assigned_user_name\n      FROM hardware h\n      LEFT JOIN branches b ON h.branch_id = b.id\n      LEFT JOIN vendors v ON b.vendor_id = v.id\n      LEFT JOIN users u ON h.assigned_to = u.id\n      ORDER BY h.created_at DESC\n    `)\n    \n    return NextResponse.json(result)\n  } catch (error) {\n    console.error(\"Error fetching hardware:\", error)\n    return NextResponse.json([])\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { serial_number, device_type, status, branch_id, assigned_to } = await request.json()\n\n    const assignedDate = branch_id ? new Date() : null\n\n    const result = await query(`\n      INSERT INTO hardware (serial_number, hardware_type, status, branch_id, assigned_to, assigned_date)\n      VALUES ($1, $2, $3, $4, $5, $6)\n      RETURNING *\n    `, [serial_number, device_type, status || 'active', branch_id || null, assigned_to || null, assignedDate])\n\n    return NextResponse.json(result[0])\n  } catch (error) {\n    console.error(\"Error adding hardware:\", error)\n    return NextResponse.json({ error: \"Failed to add hardware\" }, { status: 500 })\n  }\n}\n\nexport async function PUT(request: NextRequest) {\n  try {\n    const { id, branch_id, assigned_to, status, serial_number, device_type } = await request.json()\n\n    // Build dynamic update query based on provided fields\n    const updates: string[] = []\n    const values: any[] = []\n    let paramIndex = 1\n\n    if (serial_number !== undefined) {\n      updates.push(`serial_number = $${paramIndex++}`)\n      values.push(serial_number)\n    }\n    if (device_type !== undefined) {\n      updates.push(`hardware_type = $${paramIndex++}`)\n      values.push(device_type)\n    }\n    if (status !== undefined) {\n      updates.push(`status = $${paramIndex++}`)\n      values.push(status)\n    }\n    if (branch_id !== undefined) {\n      updates.push(`branch_id = $${paramIndex++}`)\n      values.push(branch_id)\n      updates.push(`assigned_date = NOW()`)\n    }\n    if (assigned_to !== undefined) {\n      updates.push(`assigned_to = $${paramIndex++}`)\n      values.push(assigned_to)\n    }\n\n    updates.push(`updated_at = NOW()`)\n    values.push(id)\n\n    const result = await query(`\n      UPDATE hardware \n      SET ${updates.join(', ')}\n      WHERE id = $${paramIndex}\n      RETURNING *\n    `, values)\n\n    return NextResponse.json(result[0])\n  } catch (error) {\n    console.error(\"Error updating hardware:\", error)\n    return NextResponse.json({ error: \"Failed to update hardware\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AAAA;;;;;;;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,SAAS,MAAM,IAAA,8HAAK,EAAC,CAAC;;;;;;;;;;;;IAY5B,CAAC;QAED,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gJAAY,CAAC,IAAI,CAAC,EAAE;IAC7B;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,aAAa,EAAE,WAAW,EAAE,MAAM,EAAE,SAAS,EAAE,WAAW,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEzF,MAAM,eAAe,YAAY,IAAI,SAAS;QAE9C,MAAM,SAAS,MAAM,IAAA,8HAAK,EAAC,CAAC;;;;IAI5B,CAAC,EAAE;YAAC;YAAe;YAAa,UAAU;YAAU,aAAa;YAAM,eAAe;YAAM;SAAa;QAEzG,OAAO,gJAAY,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;IACpC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAyB,GAAG;YAAE,QAAQ;QAAI;IAC9E;AACF;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,SAAS,EAAE,WAAW,EAAE,MAAM,EAAE,aAAa,EAAE,WAAW,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE7F,sDAAsD;QACtD,MAAM,UAAoB,EAAE;QAC5B,MAAM,SAAgB,EAAE;QACxB,IAAI,aAAa;QAEjB,IAAI,kBAAkB,WAAW;YAC/B,QAAQ,IAAI,CAAC,CAAC,iBAAiB,EAAE,cAAc;YAC/C,OAAO,IAAI,CAAC;QACd;QACA,IAAI,gBAAgB,WAAW;YAC7B,QAAQ,IAAI,CAAC,CAAC,iBAAiB,EAAE,cAAc;YAC/C,OAAO,IAAI,CAAC;QACd;QACA,IAAI,WAAW,WAAW;YACxB,QAAQ,IAAI,CAAC,CAAC,UAAU,EAAE,cAAc;YACxC,OAAO,IAAI,CAAC;QACd;QACA,IAAI,cAAc,WAAW;YAC3B,QAAQ,IAAI,CAAC,CAAC,aAAa,EAAE,cAAc;YAC3C,OAAO,IAAI,CAAC;YACZ,QAAQ,IAAI,CAAC,CAAC,qBAAqB,CAAC;QACtC;QACA,IAAI,gBAAgB,WAAW;YAC7B,QAAQ,IAAI,CAAC,CAAC,eAAe,EAAE,cAAc;YAC7C,OAAO,IAAI,CAAC;QACd;QAEA,QAAQ,IAAI,CAAC,CAAC,kBAAkB,CAAC;QACjC,OAAO,IAAI,CAAC;QAEZ,MAAM,SAAS,MAAM,IAAA,8HAAK,EAAC,CAAC;;UAEtB,EAAE,QAAQ,IAAI,CAAC,MAAM;kBACb,EAAE,WAAW;;IAE3B,CAAC,EAAE;QAEH,OAAO,gJAAY,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;IACpC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA4B,GAAG;YAAE,QAAQ;QAAI;IACjF;AACF"}}]
}