{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db/client.ts"],"sourcesContent":["import { Pool } from 'pg';\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n  ssl: process.env.NODE_ENV === 'production' ? { rejectUnauthorized: false } : false,\n});\n\nexport async function query<T = any>(text: string, params?: any[]): Promise<T[]> {\n  const client = await pool.connect();\n  try {\n    const result = await client.query(text, params);\n    return result.rows as T[];\n  } finally {\n    client.release();\n  }\n}\n\nexport async function queryOne<T = any>(text: string, params?: any[]): Promise<T | null> {\n  const rows = await query<T>(text, params);\n  return rows[0] || null;\n}\n\nexport async function execute(text: string, params?: any[]): Promise<number> {\n  const client = await pool.connect();\n  try {\n    const result = await client.query(text, params);\n    return result.rowCount || 0;\n  } finally {\n    client.release();\n  }\n}\n\nexport { pool };\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;;;AAEA,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,KAAK,sCAAwC,0BAAgC;AAC/E;AAEO,eAAe,MAAe,IAAY,EAAE,MAAc;IAC/D,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO,OAAO,IAAI;IACpB,SAAU;QACR,OAAO,OAAO;IAChB;AACF;AAEO,eAAe,SAAkB,IAAY,EAAE,MAAc;IAClE,MAAM,OAAO,MAAM,MAAS,MAAM;IAClC,OAAO,IAAI,CAAC,EAAE,IAAI;AACpB;AAEO,eAAe,QAAQ,IAAY,EAAE,MAAc;IACxD,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO,OAAO,QAAQ,IAAI;IAC5B,SAAU;QACR,OAAO,OAAO;IAChB;AACF"}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db/index.ts"],"sourcesContent":["export * from './client';\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/controller-logs/fuel-grade-mappings/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { query } from \"@/lib/db\"\n\nexport async function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url)\n    const ptsId = searchParams.get(\"pts_id\")\n\n    let sql = `\n      SELECT \n        m.id, m.pts_id, m.fuel_grade_id, m.fuel_grade_name, \n        m.item_id, m.is_active, m.notes, m.created_at, m.updated_at,\n        i.item_name, i.item_code, i.sale_price\n      FROM pump_fuel_grade_mappings m\n      LEFT JOIN items i ON m.item_id = i.id\n      WHERE 1=1\n    `\n    const params: any[] = []\n\n    if (ptsId) {\n      sql += ` AND (m.pts_id = $1 OR m.pts_id IS NULL)`\n      params.push(ptsId)\n    }\n\n    sql += ` ORDER BY m.fuel_grade_id ASC`\n\n    const result: any = await query(sql, params)\n    const mappings = result.rows || result\n\n    return NextResponse.json({ success: true, data: mappings })\n  } catch (error: any) {\n    console.error(\"[Fuel Grade Mappings API] Error:\", error.message)\n    return NextResponse.json({ success: false, error: error.message }, { status: 500 })\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const { pts_id, fuel_grade_id, fuel_grade_name, item_id, notes } = body\n\n    if (!fuel_grade_id) {\n      return NextResponse.json({ success: false, error: \"fuel_grade_id is required\" }, { status: 400 })\n    }\n\n    const ptsValue = pts_id || null\n    const coalescedPts = ptsValue === null ? 'GLOBAL' : ptsValue\n    \n    const existing: any = await query(`\n      SELECT id FROM pump_fuel_grade_mappings \n      WHERE COALESCE(pts_id, 'GLOBAL') = $1 AND fuel_grade_id = $2\n    `, [coalescedPts, fuel_grade_id])\n    \n    let result: any\n    const existingRows = existing.rows || existing\n    if (existingRows && existingRows.length > 0) {\n      const existingId = existingRows[0].id\n      result = await query(`\n        UPDATE pump_fuel_grade_mappings SET\n          fuel_grade_name = $1,\n          item_id = $2,\n          notes = $3,\n          updated_at = NOW()\n        WHERE id = $4\n        RETURNING *\n      `, [fuel_grade_name, item_id || null, notes || null, existingId])\n    } else {\n      result = await query(`\n        INSERT INTO pump_fuel_grade_mappings (pts_id, fuel_grade_id, fuel_grade_name, item_id, notes)\n        VALUES ($1, $2, $3, $4, $5)\n        RETURNING *\n      `, [ptsValue, fuel_grade_id, fuel_grade_name, item_id || null, notes || null])\n    }\n\n    const mapping = (result.rows || result)[0]\n    return NextResponse.json({ success: true, data: mapping })\n  } catch (error: any) {\n    console.error(\"[Fuel Grade Mappings API] Error:\", error.message)\n    return NextResponse.json({ success: false, error: error.message }, { status: 500 })\n  }\n}\n\nexport async function DELETE(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url)\n    const id = searchParams.get(\"id\")\n\n    if (!id) {\n      return NextResponse.json({ success: false, error: \"id is required\" }, { status: 400 })\n    }\n\n    await query(`DELETE FROM pump_fuel_grade_mappings WHERE id = $1`, [id])\n    return NextResponse.json({ success: true })\n  } catch (error: any) {\n    console.error(\"[Fuel Grade Mappings API] Error:\", error.message)\n    return NextResponse.json({ success: false, error: error.message }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}