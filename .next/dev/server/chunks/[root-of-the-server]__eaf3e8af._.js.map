{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db/client.ts"],"sourcesContent":["import { Pool } from 'pg';\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n  ssl: process.env.NODE_ENV === 'production' ? { rejectUnauthorized: false } : false,\n});\n\nexport async function query<T = any>(text: string, params?: any[]): Promise<T[]> {\n  const client = await pool.connect();\n  try {\n    const result = await client.query(text, params);\n    return result.rows as T[];\n  } finally {\n    client.release();\n  }\n}\n\nexport async function queryOne<T = any>(text: string, params?: any[]): Promise<T | null> {\n  const rows = await query<T>(text, params);\n  return rows[0] || null;\n}\n\nexport async function execute(text: string, params?: any[]): Promise<number> {\n  const client = await pool.connect();\n  try {\n    const result = await client.query(text, params);\n    return result.rowCount || 0;\n  } finally {\n    client.release();\n  }\n}\n\nexport { pool };\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;;;AAEA,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,KAAK,sCAAwC,0BAAgC;AAC/E;AAEO,eAAe,MAAe,IAAY,EAAE,MAAc;IAC/D,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO,OAAO,IAAI;IACpB,SAAU;QACR,OAAO,OAAO;IAChB;AACF;AAEO,eAAe,SAAkB,IAAY,EAAE,MAAc;IAClE,MAAM,OAAO,MAAM,MAAS,MAAM;IAClC,OAAO,IAAI,CAAC,EAAE,IAAI;AACpB;AAEO,eAAe,QAAQ,IAAY,EAAE,MAAc;IACxD,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO,OAAO,QAAQ,IAAI;IAC5B,SAAU;QACR,OAAO,OAAO;IAChB;AACF"}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db/index.ts"],"sourcesContent":["export * from './client';\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/mobile/invoices/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { query } from \"@/lib/db\"\n\nexport async function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url)\n    const status = searchParams.get(\"status\")\n    const limit = parseInt(searchParams.get(\"limit\") || \"50\")\n\n    let sql = `\n      SELECT \n        id,\n        invoice_number,\n        customer_name,\n        branch_id,\n        subtotal,\n        tax_amount as tax,\n        total_amount as total,\n        status,\n        created_at,\n        created_by\n      FROM invoices\n      WHERE 1=1\n    `\n    const params: any[] = []\n    let paramIndex = 1\n\n    if (status && status !== \"all\") {\n      sql += ` AND status = $${paramIndex}`\n      params.push(status)\n      paramIndex++\n    }\n\n    sql += ` ORDER BY created_at DESC LIMIT $${paramIndex}`\n    params.push(limit)\n\n    const result = await query(sql, params)\n    return NextResponse.json(result)\n  } catch (error) {\n    console.error(\"Error fetching mobile invoices:\", error)\n    return NextResponse.json([])\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const {\n      customer_name,\n      customer_phone,\n      items,\n      subtotal,\n      tax,\n      total,\n      user_id,\n      branch_id\n    } = body\n\n    const invoiceNumber = `INV-${Date.now().toString(36).toUpperCase()}`\n\n    const result = await query(`\n      INSERT INTO invoices (\n        invoice_number,\n        customer_name,\n        customer_phone,\n        branch_id,\n        subtotal,\n        tax_amount,\n        total_amount,\n        status,\n        created_by\n      )\n      VALUES ($1, $2, $3, $4, $5, $6, $7, 'pending', $8)\n      RETURNING *\n    `, [\n      invoiceNumber,\n      customer_name || 'Walk-in Customer',\n      customer_phone,\n      branch_id || null,\n      subtotal,\n      tax,\n      total,\n      user_id || null\n    ])\n\n    const invoice = result[0]\n\n    if (items && items.length > 0 && invoice) {\n      for (const item of items) {\n        await query(`\n          INSERT INTO invoice_line_items (\n            invoice_id,\n            product_id,\n            product_name,\n            quantity,\n            unit_price,\n            discount,\n            total\n          )\n          VALUES ($1, $2, $3, $4, $5, $6, $7)\n        `, [\n          invoice.id,\n          item.product_id,\n          item.product_name,\n          item.quantity,\n          item.unit_price,\n          item.discount || 0,\n          item.total\n        ])\n      }\n    }\n\n    return NextResponse.json(invoice)\n  } catch (error) {\n    console.error(\"Error creating mobile invoice:\", error)\n    return NextResponse.json({ error: \"Failed to create invoice\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;;;;;;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,SAAS,aAAa,GAAG,CAAC;QAChC,MAAM,QAAQ,SAAS,aAAa,GAAG,CAAC,YAAY;QAEpD,IAAI,MAAM,CAAC;;;;;;;;;;;;;;IAcX,CAAC;QACD,MAAM,SAAgB,EAAE;QACxB,IAAI,aAAa;QAEjB,IAAI,UAAU,WAAW,OAAO;YAC9B,OAAO,CAAC,eAAe,EAAE,YAAY;YACrC,OAAO,IAAI,CAAC;YACZ;QACF;QAEA,OAAO,CAAC,iCAAiC,EAAE,YAAY;QACvD,OAAO,IAAI,CAAC;QAEZ,MAAM,SAAS,MAAM,IAAA,8HAAK,EAAC,KAAK;QAChC,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QACjD,OAAO,gJAAY,CAAC,IAAI,CAAC,EAAE;IAC7B;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EACJ,aAAa,EACb,cAAc,EACd,KAAK,EACL,QAAQ,EACR,GAAG,EACH,KAAK,EACL,OAAO,EACP,SAAS,EACV,GAAG;QAEJ,MAAM,gBAAgB,CAAC,IAAI,EAAE,KAAK,GAAG,GAAG,QAAQ,CAAC,IAAI,WAAW,IAAI;QAEpE,MAAM,SAAS,MAAM,IAAA,8HAAK,EAAC,CAAC;;;;;;;;;;;;;;IAc5B,CAAC,EAAE;YACD;YACA,iBAAiB;YACjB;YACA,aAAa;YACb;YACA;YACA;YACA,WAAW;SACZ;QAED,MAAM,UAAU,MAAM,CAAC,EAAE;QAEzB,IAAI,SAAS,MAAM,MAAM,GAAG,KAAK,SAAS;YACxC,KAAK,MAAM,QAAQ,MAAO;gBACxB,MAAM,IAAA,8HAAK,EAAC,CAAC;;;;;;;;;;;QAWb,CAAC,EAAE;oBACD,QAAQ,EAAE;oBACV,KAAK,UAAU;oBACf,KAAK,YAAY;oBACjB,KAAK,QAAQ;oBACb,KAAK,UAAU;oBACf,KAAK,QAAQ,IAAI;oBACjB,KAAK,KAAK;iBACX;YACH;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA2B,GAAG;YAAE,QAAQ;QAAI;IAChF;AACF"}}]
}