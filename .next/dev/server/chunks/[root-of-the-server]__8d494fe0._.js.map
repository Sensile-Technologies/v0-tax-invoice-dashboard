{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/auth/signup/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport { Pool } from \"pg\"\nimport bcrypt from \"bcryptjs\"\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n})\n\nexport async function POST(request: Request) {\n  try {\n    const { email, password, data } = await request.json()\n\n    if (!email || !password) {\n      return NextResponse.json(\n        { error: { message: \"Email and password are required\" } },\n        { status: 400 }\n      )\n    }\n\n    const client = await pool.connect()\n\n    try {\n      const existingUser = await client.query(\n        \"SELECT id FROM users WHERE email = $1\",\n        [email]\n      )\n\n      if (existingUser.rows.length > 0) {\n        return NextResponse.json(\n          { error: { message: \"User with this email already exists\" } },\n          { status: 400 }\n        )\n      }\n\n      const passwordHash = await bcrypt.hash(password, 10)\n      const id = crypto.randomUUID()\n\n      await client.query(\n        `INSERT INTO users (id, email, username, phone_number, password_hash, created_at, updated_at)\n         VALUES ($1, $2, $3, $4, $5, NOW(), NOW())`,\n        [id, email, data?.username || null, data?.phone || null, passwordHash]\n      )\n\n      return NextResponse.json({\n        user: { id, email, username: data?.username },\n        message: \"User created successfully\"\n      })\n    } finally {\n      client.release()\n    }\n  } catch (error) {\n    console.error(\"[API] Sign up error:\", error)\n    return NextResponse.json(\n      { error: { message: \"Failed to create user\" } },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;AAEA,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;AAC5C;AAEO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEpD,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;oBAAE,SAAS;gBAAkC;YAAE,GACxD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,SAAS,MAAM,KAAK,OAAO;QAEjC,IAAI;YACF,MAAM,eAAe,MAAM,OAAO,KAAK,CACrC,yCACA;gBAAC;aAAM;YAGT,IAAI,aAAa,IAAI,CAAC,MAAM,GAAG,GAAG;gBAChC,OAAO,gJAAY,CAAC,IAAI,CACtB;oBAAE,OAAO;wBAAE,SAAS;oBAAsC;gBAAE,GAC5D;oBAAE,QAAQ;gBAAI;YAElB;YAEA,MAAM,eAAe,MAAM,8IAAM,CAAC,IAAI,CAAC,UAAU;YACjD,MAAM,KAAK,OAAO,UAAU;YAE5B,MAAM,OAAO,KAAK,CAChB,CAAC;kDACyC,CAAC,EAC3C;gBAAC;gBAAI;gBAAO,MAAM,YAAY;gBAAM,MAAM,SAAS;gBAAM;aAAa;YAGxE,OAAO,gJAAY,CAAC,IAAI,CAAC;gBACvB,MAAM;oBAAE;oBAAI;oBAAO,UAAU,MAAM;gBAAS;gBAC5C,SAAS;YACX;QACF,SAAU;YACR,OAAO,OAAO;QAChB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;gBAAE,SAAS;YAAwB;QAAE,GAC9C;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}