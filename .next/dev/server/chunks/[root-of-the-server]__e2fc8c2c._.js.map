{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db/client.ts"],"sourcesContent":["import { Pool } from 'pg';\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n  ssl: process.env.NODE_ENV === 'production' ? { rejectUnauthorized: false } : false,\n});\n\nexport async function query<T = any>(text: string, params?: any[]): Promise<T[]> {\n  const client = await pool.connect();\n  try {\n    const result = await client.query(text, params);\n    return result.rows as T[];\n  } finally {\n    client.release();\n  }\n}\n\nexport async function queryOne<T = any>(text: string, params?: any[]): Promise<T | null> {\n  const rows = await query<T>(text, params);\n  return rows[0] || null;\n}\n\nexport async function execute(text: string, params?: any[]): Promise<number> {\n  const client = await pool.connect();\n  try {\n    const result = await client.query(text, params);\n    return result.rowCount || 0;\n  } finally {\n    client.release();\n  }\n}\n\nexport async function getClient() {\n  return await pool.connect();\n}\n\nexport { pool };\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;;;;;AAEA,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,KAAK,sCAAwC,0BAAgC;AAC/E;AAEO,eAAe,MAAe,IAAY,EAAE,MAAc;IAC/D,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO,OAAO,IAAI;IACpB,SAAU;QACR,OAAO,OAAO;IAChB;AACF;AAEO,eAAe,SAAkB,IAAY,EAAE,MAAc;IAClE,MAAM,OAAO,MAAM,MAAS,MAAM;IAClC,OAAO,IAAI,CAAC,EAAE,IAAI;AACpB;AAEO,eAAe,QAAQ,IAAY,EAAE,MAAc;IACxD,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO,OAAO,QAAQ,IAAI;IAC5B,SAAU;QACR,OAAO,OAAO;IAChB;AACF;AAEO,eAAe;IACpB,OAAO,MAAM,KAAK,OAAO;AAC3B"}},
    {"offset": {"line": 113, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db/index.ts"],"sourcesContent":["export * from './client';\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 125, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/kra-url-helper.ts"],"sourcesContent":["export function buildKraBaseUrl(\n  serverAddress: string | null | undefined,\n  serverPort: string | null | undefined\n): string {\n  const DEFAULT_SERVER = '5.189.171.160'\n  const DEFAULT_PORT = '8088'\n  \n  if (!serverAddress) {\n    return `http://${DEFAULT_SERVER}:${serverPort || DEFAULT_PORT}`\n  }\n  \n  let address = serverAddress.trim()\n  \n  const hasScheme = /^https?:\\/\\//i.test(address)\n  if (hasScheme) {\n    address = address.replace(/^https?:\\/\\//i, '')\n  }\n  \n  address = address.replace(/\\/+$/, '')\n  \n  const hasPort = /:\\d+$/.test(address)\n  \n  if (hasPort) {\n    return `http://${address}`\n  }\n  \n  return `http://${address}:${serverPort || DEFAULT_PORT}`\n}\n"],"names":[],"mappings":";;;;AAAO,SAAS,gBACd,aAAwC,EACxC,UAAqC;IAErC,MAAM,iBAAiB;IACvB,MAAM,eAAe;IAErB,IAAI,CAAC,eAAe;QAClB,OAAO,CAAC,OAAO,EAAE,eAAe,CAAC,EAAE,cAAc,cAAc;IACjE;IAEA,IAAI,UAAU,cAAc,IAAI;IAEhC,MAAM,YAAY,gBAAgB,IAAI,CAAC;IACvC,IAAI,WAAW;QACb,UAAU,QAAQ,OAAO,CAAC,iBAAiB;IAC7C;IAEA,UAAU,QAAQ,OAAO,CAAC,QAAQ;IAElC,MAAM,UAAU,QAAQ,IAAI,CAAC;IAE7B,IAAI,SAAS;QACX,OAAO,CAAC,OAAO,EAAE,SAAS;IAC5B;IAEA,OAAO,CAAC,OAAO,EAAE,QAAQ,CAAC,EAAE,cAAc,cAAc;AAC1D"}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/stock/adjust/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { query, getClient } from \"@/lib/db\"\nimport { buildKraBaseUrl } from \"@/lib/kra-url-helper\"\n\nasync function callKraWithRetry(\n  url: string, \n  payload: any, \n  maxRetries: number = 3\n): Promise<{ response: any; statusCode: number }> {\n  let lastError: any = null\n  \n  for (let attempt = 1; attempt <= maxRetries; attempt++) {\n    try {\n      const controller = new AbortController()\n      const timeoutId = setTimeout(() => controller.abort(), 20000)\n      \n      const response = await fetch(url, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(payload),\n        signal: controller.signal\n      })\n      \n      clearTimeout(timeoutId)\n      const data = await response.json()\n      return { response: data, statusCode: response.status }\n      \n    } catch (error: any) {\n      lastError = error\n      console.log(`[Stock Adjust] KRA attempt ${attempt}/${maxRetries} failed: ${error.message}`)\n      \n      if (attempt < maxRetries) {\n        const delay = Math.min(1000 * Math.pow(2, attempt - 1), 5000)\n        await new Promise(resolve => setTimeout(resolve, delay))\n      }\n    }\n  }\n  \n  const errorResponse = {\n    resultCd: lastError?.name === 'AbortError' ? \"TIMEOUT\" : \"NETWORK_ERROR\",\n    resultMsg: lastError?.name === 'AbortError' \n      ? `Request timed out after ${maxRetries} attempts` \n      : `Network error after ${maxRetries} attempts: ${lastError?.message}`,\n    resultDt: new Date().toISOString()\n  }\n  \n  return { response: errorResponse, statusCode: 0 }\n}\n\nfunction formatKraDate(date: Date = new Date()): string {\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2, '0')\n  const day = String(date.getDate()).padStart(2, '0')\n  return `${year}${month}${day}`\n}\n\nexport async function POST(request: NextRequest) {\n  const client = await getClient()\n  \n  try {\n    const body = await request.json()\n    const { \n      branch_id,\n      tank_id,\n      adjustment_type,\n      quantity,\n      reason,\n      approved_by,\n      sync_to_kra = true\n    } = body\n\n    if (!branch_id || !tank_id || !adjustment_type || quantity === undefined) {\n      return NextResponse.json(\n        { error: \"branch_id, tank_id, adjustment_type, and quantity are required\" },\n        { status: 400 }\n      )\n    }\n\n    if (![\"increase\", \"decrease\", \"set\"].includes(adjustment_type)) {\n      return NextResponse.json(\n        { error: \"adjustment_type must be 'increase', 'decrease', or 'set'\" },\n        { status: 400 }\n      )\n    }\n\n    await client.query('BEGIN')\n\n    const branchResult = await client.query(`\n      SELECT b.id, b.kra_pin, b.bhf_id, b.sr_number,\n             COALESCE(b.server_address, '5.189.171.160') as server_address,\n             COALESCE(b.server_port, '8088') as server_port,\n             v.kra_pin as vendor_kra_pin\n      FROM branches b\n      LEFT JOIN vendors v ON v.id = b.vendor_id\n      WHERE b.id = $1\n      FOR UPDATE\n    `, [branch_id])\n    \n    if (branchResult.rows.length === 0) {\n      await client.query('ROLLBACK')\n      return NextResponse.json({ error: \"Branch not found\" }, { status: 404 })\n    }\n    \n    const branch = branchResult.rows[0]\n    const tin = branch.kra_pin || branch.vendor_kra_pin\n    const bhfId = branch.bhf_id || \"00\"\n\n    const tankResult = await client.query(`\n      SELECT t.*, i.item_code, i.class_code, i.item_name, i.package_unit, i.quantity_unit\n      FROM tanks t\n      LEFT JOIN items i ON t.item_id = i.id\n      WHERE t.id = $1\n      FOR UPDATE\n    `, [tank_id])\n    \n    if (tankResult.rows.length === 0) {\n      await client.query('ROLLBACK')\n      return NextResponse.json({ error: \"Tank not found\" }, { status: 404 })\n    }\n\n    const tank = tankResult.rows[0]\n    const previousStock = parseFloat(tank.current_stock) || 0\n    const tankCapacity = parseFloat(tank.capacity) || 0\n    let newStock: number\n\n    if (adjustment_type === \"increase\") {\n      newStock = previousStock + quantity\n    } else if (adjustment_type === \"decrease\") {\n      newStock = Math.max(0, previousStock - quantity)\n    } else {\n      newStock = quantity\n    }\n\n    // Check if adjustment would exceed tank capacity (100%)\n    if (tankCapacity > 0 && newStock > tankCapacity) {\n      await client.query('ROLLBACK')\n      const availableSpace = tankCapacity - previousStock\n      return NextResponse.json({\n        success: false,\n        error: `Cannot adjust stock. Tank capacity is ${tankCapacity}L. Adjustment would result in ${newStock.toFixed(2)}L which exceeds capacity. Available space: ${availableSpace.toFixed(2)}L`\n      }, { status: 400 })\n    }\n\n    const actualChange = Math.abs(newStock - previousStock)\n    \n    if (actualChange === 0) {\n      await client.query('ROLLBACK')\n      return NextResponse.json({\n        success: true,\n        data: {\n          tankId: tank_id,\n          adjustmentType: adjustment_type,\n          previousStock,\n          adjustedQuantity: 0,\n          newStock: previousStock,\n          fuelType: tank.fuel_type\n        },\n        kraSync: null,\n        message: \"No adjustment needed - stock unchanged\"\n      })\n    }\n\n    let kraResult: any = null\n    let sarNo: number | null = null\n\n    if (sync_to_kra && !tin) {\n      await client.query('ROLLBACK')\n      return NextResponse.json({\n        success: false,\n        error: \"Branch KRA configuration is missing (no KRA PIN). Please configure KRA settings before adjusting stock.\"\n      }, { status: 400 })\n    }\n\n    if (sync_to_kra && tin) {\n      sarNo = (branch.sr_number || 0) + 1\n      \n      const kraBaseUrl = buildKraBaseUrl(branch.server_address, branch.server_port)\n      const itemCd = tank.item_code || tank.kra_item_cd || `FUEL${tank_id.substring(0, 8)}`\n      const itemClsCd = tank.class_code || \"5059690800\"\n      const itemNm = tank.item_name || tank.fuel_type || \"Fuel\"\n      \n      const saveStockItemsPayload = {\n        tin,\n        bhfId,\n        sarNo,\n        orgSarNo: 0,\n        regTyCd: \"M\",\n        custTin: null,\n        custNm: null,\n        custBhfId: null,\n        sarTyCd: \"06\",\n        ocrnDt: formatKraDate(),\n        totItemCnt: 1,\n        totTaxblAmt: 0,\n        totTaxAmt: 0,\n        totAmt: 0,\n        remark: reason || `Stock adjustment: ${previousStock} -> ${newStock}`,\n        regrId: \"Admin\",\n        regrNm: \"Admin\",\n        modrNm: \"Admin\",\n        modrId: \"Admin\",\n        itemList: [{\n          itemSeq: 1,\n          itemCd,\n          itemClsCd,\n          itemNm,\n          bcd: null,\n          pkgUnitCd: tank.package_unit || \"NT\",\n          pkg: Math.ceil(actualChange),\n          qtyUnitCd: tank.quantity_unit || \"U\",\n          qty: actualChange,\n          itemExprDt: null,\n          prc: 0,\n          splyAmt: 0,\n          totDcAmt: 0,\n          taxblAmt: 0,\n          taxTyCd: \"B\",\n          taxAmt: 0,\n          totAmt: 0\n        }]\n      }\n\n      console.log(`[Stock Adjust] Calling saveStockItems for tank ${tank_id}, sarNo: ${sarNo}`)\n      \n      const { response: saveStockItemsResponse, statusCode: saveStockItemsStatus } = \n        await callKraWithRetry(`${kraBaseUrl}/stock/saveStockItems`, saveStockItemsPayload)\n\n      await client.query(`\n        INSERT INTO branch_logs (branch_id, log_type, endpoint, request_payload, response_payload, status)\n        VALUES ($1, $2, $3, $4, $5, $6)\n      `, [\n        branch_id,\n        \"kra_stock_sync\",\n        \"/stock/saveStockItems\",\n        JSON.stringify(saveStockItemsPayload),\n        JSON.stringify(saveStockItemsResponse),\n        (saveStockItemsResponse?.resultCd === \"000\" || saveStockItemsResponse?.resultCd === \"0\") ? \"success\" : \"error\"\n      ])\n\n      const saveStockItemsSuccess = saveStockItemsResponse?.resultCd === \"000\" || saveStockItemsResponse?.resultCd === \"0\"\n      \n      if (!saveStockItemsSuccess) {\n        await client.query('ROLLBACK')\n        console.error(`[Stock Adjust] saveStockItems failed:`, saveStockItemsResponse)\n        return NextResponse.json({\n          success: false,\n          error: saveStockItemsResponse?.resultMsg || \"Failed to sync stock adjustment to KRA\",\n          kraResponse: saveStockItemsResponse\n        }, { status: 500 })\n      }\n\n      const saveStockMasterPayload = {\n        tin,\n        bhfId,\n        itemCd,\n        rsdQty: newStock,\n        regrId: \"Admin\",\n        regrNm: \"Admin\",\n        modrNm: \"Admin\",\n        modrId: \"Admin\"\n      }\n\n      console.log(`[Stock Adjust] Calling saveStockMaster for item ${itemCd}, newStock: ${newStock}`)\n      \n      const { response: saveStockMasterResponse, statusCode: saveStockMasterStatus } = \n        await callKraWithRetry(`${kraBaseUrl}/stockMaster/saveStockMaster`, saveStockMasterPayload)\n\n      await client.query(`\n        INSERT INTO branch_logs (branch_id, log_type, endpoint, request_payload, response_payload, status)\n        VALUES ($1, $2, $3, $4, $5, $6)\n      `, [\n        branch_id,\n        \"kra_stock_sync\",\n        \"/stockMaster/saveStockMaster\",\n        JSON.stringify(saveStockMasterPayload),\n        JSON.stringify(saveStockMasterResponse),\n        (saveStockMasterResponse?.resultCd === \"000\" || saveStockMasterResponse?.resultCd === \"0\") ? \"success\" : \"error\"\n      ])\n\n      const saveStockMasterSuccess = saveStockMasterResponse?.resultCd === \"000\" || saveStockMasterResponse?.resultCd === \"0\"\n      \n      kraResult = {\n        success: saveStockItemsSuccess && saveStockMasterSuccess,\n        saveStockItems: saveStockItemsResponse,\n        saveStockMaster: saveStockMasterResponse\n      }\n\n      if (!saveStockMasterSuccess) {\n        console.warn(`[Stock Adjust] saveStockMaster failed but saveStockItems succeeded - continuing with adjustment`)\n      }\n\n      await client.query(`\n        INSERT INTO stock_movements (\n          branch_id, tin, bhf_id, sar_no, org_sar_no, reg_ty_cd, \n          cust_tin, cust_bhf_id, cust_nm, sar_ty_cd, ocrn_dt,\n          tot_item_cnt, tot_taxbl_amt, tot_tax_amt, tot_amt, remark,\n          regr_id, regr_nm, modr_id, modr_nm,\n          kra_status, kra_response, kra_synced_at\n        ) VALUES (\n          $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11,\n          $12, $13, $14, $15, $16, $17, $18, $19, $20,\n          $21, $22, $23\n        )\n      `, [\n        branch_id,\n        tin,\n        bhfId,\n        sarNo,\n        0,\n        \"M\",\n        null,\n        null,\n        null,\n        \"06\",\n        formatKraDate(),\n        1,\n        0,\n        0,\n        0,\n        reason || `Stock adjustment: ${previousStock} -> ${newStock}`,\n        \"Admin\",\n        \"Admin\",\n        \"Admin\",\n        \"Admin\",\n        saveStockItemsSuccess ? \"success\" : \"failed\",\n        JSON.stringify(saveStockItemsResponse),\n        saveStockItemsSuccess ? new Date() : null\n      ])\n    }\n\n    if (sarNo) {\n      await client.query(`UPDATE branches SET sr_number = $1, updated_at = NOW() WHERE id = $2`, [sarNo, branch_id])\n    }\n\n    await client.query(\n      `UPDATE tanks SET current_stock = $1, kra_sync_status = $2, last_kra_synced_stock = $3, updated_at = NOW() WHERE id = $4`,\n      [newStock, kraResult?.success ? 'synced' : (sync_to_kra ? 'failed' : 'pending'), kraResult?.success ? newStock : tank.last_kra_synced_stock, tank_id]\n    )\n\n    await client.query(\n      `INSERT INTO stock_adjustments (branch_id, tank_id, adjustment_type, quantity, previous_stock, new_stock, reason, approved_by, approval_status, kra_sync_status)\n       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10)`,\n      [branch_id, tank_id, adjustment_type, actualChange, previousStock, newStock, reason || 'Manual adjustment', approved_by || 'System', 'approved', kraResult?.success ? 'synced' : 'pending']\n    )\n\n    await client.query('COMMIT')\n    console.log(`[Stock Adjust] Successfully adjusted tank ${tank_id}: ${previousStock} -> ${newStock}`)\n\n    return NextResponse.json({\n      success: true,\n      data: {\n        tankId: tank_id,\n        adjustmentType: adjustment_type,\n        previousStock,\n        adjustedQuantity: actualChange,\n        newStock,\n        fuelType: tank.fuel_type\n      },\n      kraSync: kraResult ? {\n        synced: kraResult.success,\n        error: kraResult.success ? undefined : \"KRA sync completed with warnings\"\n      } : null\n    })\n\n  } catch (error: any) {\n    await client.query('ROLLBACK')\n    console.error(\"[Stock Adjust API] Error:\", error)\n    return NextResponse.json(\n      { error: \"Failed to adjust stock\", details: error.message },\n      { status: 500 }\n    )\n  } finally {\n    client.release()\n  }\n}\n"],"names":[],"mappings":"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"}}]
}