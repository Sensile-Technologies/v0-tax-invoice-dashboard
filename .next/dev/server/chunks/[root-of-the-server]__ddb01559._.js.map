{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/headquarters/purchase-orders/%5Bid%5D/pdf/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { Pool } from \"pg\"\nimport jsPDF from \"jspdf\"\nimport autoTable from \"jspdf-autotable\"\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n})\n\nexport async function GET(\n  request: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  try {\n    const { id } = await params\n\n    const orderResult = await pool.query(`\n      SELECT \n        po.*,\n        b.name as branch_name,\n        vp.name as supplier_name,\n        vp.tin as supplier_tin,\n        vp.physical_address as supplier_address,\n        vp.phone as supplier_phone,\n        tp.name as transporter_name,\n        u.username as created_by_name,\n        au.username as approved_by_name\n      FROM purchase_orders po\n      LEFT JOIN branches b ON po.branch_id = b.id\n      LEFT JOIN vendor_partners vp ON po.supplier_id = vp.id\n      LEFT JOIN vendor_partners tp ON po.transporter_id = tp.id\n      LEFT JOIN users u ON po.created_by = u.id\n      LEFT JOIN users au ON po.approved_by = au.id\n      WHERE po.id = $1\n    `, [id])\n\n    if (orderResult.rows.length === 0) {\n      return NextResponse.json({ error: \"Purchase order not found\" }, { status: 404 })\n    }\n\n    const order = orderResult.rows[0]\n\n    const itemsResult = await pool.query(`\n      SELECT \n        poi.*,\n        i.item_name\n      FROM purchase_order_items poi\n      LEFT JOIN items i ON poi.item_id = i.id\n      WHERE poi.purchase_order_id = $1\n      ORDER BY poi.created_at\n    `, [id])\n\n    const items = itemsResult.rows\n\n    const acceptanceResult = await pool.query(`\n      SELECT \n        poa.*,\n        u.username as accepted_by_name\n      FROM purchase_order_acceptances poa\n      LEFT JOIN users u ON poa.accepted_by = u.id\n      WHERE poa.purchase_order_id = $1\n      ORDER BY poa.acceptance_timestamp DESC\n      LIMIT 1\n    `, [id])\n\n    const acceptance = acceptanceResult.rows[0] || null\n\n    let tankReadings: any[] = []\n    let dispenserReadings: any[] = []\n\n    if (acceptance) {\n      const tankResult = await pool.query(`\n        SELECT \n          ptr.*,\n          t.tank_name\n        FROM po_acceptance_tank_readings ptr\n        LEFT JOIN tanks t ON ptr.tank_id = t.id\n        WHERE ptr.acceptance_id = $1\n      `, [acceptance.id])\n      tankReadings = tankResult.rows\n\n      const dispenserResult = await pool.query(`\n        SELECT \n          pdr.*,\n          d.dispenser_number\n        FROM po_acceptance_dispenser_readings pdr\n        LEFT JOIN dispensers d ON pdr.dispenser_id = d.id\n        WHERE pdr.acceptance_id = $1\n      `, [acceptance.id])\n      dispenserReadings = dispenserResult.rows\n    }\n\n    const doc = new jsPDF()\n    const pageWidth = doc.internal.pageSize.getWidth()\n\n    doc.setFontSize(20)\n    doc.setFont(\"helvetica\", \"bold\")\n    doc.text(\"PURCHASE ORDER\", pageWidth / 2, 20, { align: \"center\" })\n\n    doc.setFontSize(14)\n    doc.text(order.po_number, pageWidth / 2, 28, { align: \"center\" })\n\n    doc.setFontSize(10)\n    doc.setFont(\"helvetica\", \"normal\")\n\n    let yPos = 40\n    const leftCol = 14\n    const rightCol = pageWidth / 2 + 5\n\n    // Order Details (Left Column)\n    doc.setFont(\"helvetica\", \"bold\")\n    doc.text(\"Order Details\", leftCol, yPos)\n    \n    // Transport Details (Right Column)\n    if (order.transporter_name || order.vehicle_registration || order.driver_name) {\n      doc.text(\"Transport Details\", rightCol, yPos)\n    }\n    yPos += 6\n\n    doc.setFont(\"helvetica\", \"normal\")\n    const orderDetails = [\n      [\"Branch:\", order.branch_name || \"N/A\"],\n      [\"Supplier:\", order.supplier_name || \"N/A\"],\n      [\"Supplier TIN:\", order.supplier_tin || \"N/A\"],\n      [\"Status:\", `${order.status} / ${order.approval_status}`],\n      [\"Issued:\", order.issued_at ? new Date(order.issued_at).toLocaleDateString() : \"N/A\"],\n      [\"Expected:\", order.expected_delivery ? new Date(order.expected_delivery).toLocaleDateString() : \"N/A\"],\n      [\"Created By:\", order.created_by_name || \"N/A\"],\n    ]\n\n    if (order.approved_by_name) {\n      orderDetails.push([\"Approved By:\", order.approved_by_name])\n    }\n\n    const transportDetails: string[][] = []\n    if (order.transporter_name) {\n      transportDetails.push([\"Transporter:\", order.transporter_name])\n    }\n    if (order.vehicle_registration) {\n      transportDetails.push([\"Vehicle:\", order.vehicle_registration])\n    }\n    if (order.driver_name) {\n      transportDetails.push([\"Driver:\", order.driver_name])\n    }\n    if (order.driver_phone) {\n      transportDetails.push([\"Driver Phone:\", order.driver_phone])\n    }\n    if (order.transport_cost) {\n      transportDetails.push([\"Transport Cost:\", `KES ${parseFloat(order.transport_cost).toLocaleString()}`])\n    }\n\n    const maxRows = Math.max(orderDetails.length, transportDetails.length)\n    for (let i = 0; i < maxRows; i++) {\n      if (orderDetails[i]) {\n        doc.text(`${orderDetails[i][0]} ${orderDetails[i][1]}`, leftCol, yPos)\n      }\n      if (transportDetails[i]) {\n        doc.text(`${transportDetails[i][0]} ${transportDetails[i][1]}`, rightCol, yPos)\n      }\n      yPos += 5\n    }\n\n    yPos += 5\n    doc.setFont(\"helvetica\", \"bold\")\n    doc.text(\"Order Items\", 14, yPos)\n    yPos += 4\n\n    const totalQuantity = items.reduce((sum: number, item: any) => sum + (parseFloat(item.quantity) || 0), 0)\n    const totalAmount = items.reduce((sum: number, item: any) => sum + (parseFloat(item.total_amount) || 0), 0)\n\n    autoTable(doc, {\n      startY: yPos,\n      head: [[\"Item\", \"Quantity (L)\", \"Unit Price\", \"Total\"]],\n      body: items.map((item: any) => [\n        item.item_name || \"Unknown Item\",\n        parseFloat(item.quantity).toLocaleString(),\n        `KES ${parseFloat(item.unit_price).toLocaleString()}`,\n        `KES ${parseFloat(item.total_amount).toLocaleString()}`\n      ]),\n      foot: [[\n        \"TOTAL\",\n        `${totalQuantity.toLocaleString()} L`,\n        \"\",\n        `KES ${totalAmount.toLocaleString()}`\n      ]],\n      theme: \"striped\",\n      headStyles: { fillColor: [41, 128, 185] },\n      footStyles: { fillColor: [236, 240, 241], textColor: [0, 0, 0], fontStyle: \"bold\" },\n    })\n\n    yPos = (doc as any).lastAutoTable.finalY + 10\n\n    if (acceptance) {\n      if (yPos > 240) {\n        doc.addPage()\n        yPos = 20\n      }\n\n      doc.setFont(\"helvetica\", \"bold\")\n      doc.setFontSize(12)\n      doc.text(\"DELIVERY ACCEPTANCE\", 14, yPos)\n      yPos += 8\n\n      doc.setFont(\"helvetica\", \"normal\")\n      doc.setFontSize(10)\n\n      const acceptanceDetails = [\n        [\"Accepted By:\", acceptance.accepted_by_name || \"N/A\"],\n        [\"Acceptance Date:\", acceptance.acceptance_timestamp ? new Date(acceptance.acceptance_timestamp).toLocaleString() : \"N/A\"],\n        [\"Bowser Volume:\", `${parseFloat(acceptance.bowser_volume).toLocaleString()} L`],\n        [\"Total Variance:\", `${parseFloat(acceptance.total_variance).toLocaleString()} L`],\n      ]\n\n      if (acceptance.dips_mm) {\n        acceptanceDetails.push([\"Dips (mm):\", acceptance.dips_mm.toString()])\n      }\n      if (acceptance.remarks) {\n        acceptanceDetails.push([\"Remarks:\", acceptance.remarks])\n      }\n\n      acceptanceDetails.forEach(([label, value]) => {\n        doc.text(`${label} ${value}`, 14, yPos)\n        yPos += 5\n      })\n\n      if (tankReadings.length > 0) {\n        yPos += 5\n        doc.setFont(\"helvetica\", \"bold\")\n        doc.text(\"Tank Readings\", 14, yPos)\n        yPos += 4\n\n        autoTable(doc, {\n          startY: yPos,\n          head: [[\"Tank\", \"Volume Before (L)\", \"Volume After (L)\", \"Received (L)\"]],\n          body: tankReadings.map((tr: any) => [\n            tr.tank_name || \"Unknown Tank\",\n            parseFloat(tr.volume_before).toLocaleString(),\n            parseFloat(tr.volume_after).toLocaleString(),\n            (parseFloat(tr.volume_after) - parseFloat(tr.volume_before)).toLocaleString()\n          ]),\n          theme: \"striped\",\n          headStyles: { fillColor: [39, 174, 96] },\n        })\n\n        yPos = (doc as any).lastAutoTable.finalY + 8\n      }\n\n      if (dispenserReadings.length > 0) {\n        if (yPos > 250) {\n          doc.addPage()\n          yPos = 20\n        }\n\n        doc.setFont(\"helvetica\", \"bold\")\n        doc.text(\"Dispenser Readings\", 14, yPos)\n        yPos += 4\n\n        autoTable(doc, {\n          startY: yPos,\n          head: [[\"Dispenser\", \"Meter Before\", \"Meter After\", \"Difference\"]],\n          body: dispenserReadings.map((dr: any) => [\n            `Dispenser ${dr.dispenser_number}`,\n            parseFloat(dr.meter_reading_before).toLocaleString(),\n            parseFloat(dr.meter_reading_after).toLocaleString(),\n            (parseFloat(dr.meter_reading_after) - parseFloat(dr.meter_reading_before)).toLocaleString()\n          ]),\n          theme: \"striped\",\n          headStyles: { fillColor: [155, 89, 182] },\n        })\n\n        yPos = (doc as any).lastAutoTable.finalY + 8\n      }\n\n      // Variance Calculation Summary\n      if (yPos > 240) {\n        doc.addPage()\n        yPos = 20\n      }\n\n      const tankIncrease = tankReadings.reduce((sum: number, tr: any) => \n        sum + (parseFloat(tr.volume_after) - parseFloat(tr.volume_before)), 0)\n      const dispenserDiff = dispenserReadings.reduce((sum: number, dr: any) => \n        sum + (parseFloat(dr.meter_reading_after) - parseFloat(dr.meter_reading_before)), 0)\n      const bowserVolume = parseFloat(acceptance.bowser_volume) || 0\n      const calculatedVariance = (tankIncrease + dispenserDiff) - bowserVolume\n\n      yPos += 5\n      doc.setFont(\"helvetica\", \"bold\")\n      doc.setFontSize(11)\n      doc.text(\"Variance Calculation\", 14, yPos)\n      yPos += 6\n\n      doc.setFont(\"helvetica\", \"normal\")\n      doc.setFontSize(10)\n\n      autoTable(doc, {\n        startY: yPos,\n        head: [[\"Description\", \"Volume (L)\"]],\n        body: [\n          [\"Tank Volume Increase (After - Before)\", tankIncrease.toLocaleString()],\n          [\"Dispenser Difference (After - Before)\", dispenserDiff.toLocaleString()],\n          [\"Total Received (Tank + Dispenser)\", (tankIncrease + dispenserDiff).toLocaleString()],\n          [\"Bowser Volume (Delivered)\", bowserVolume.toLocaleString()],\n        ],\n        foot: [[\n          \"VARIANCE (Received - Delivered)\",\n          `${calculatedVariance >= 0 ? \"+\" : \"\"}${calculatedVariance.toLocaleString()} L`\n        ]],\n        theme: \"striped\",\n        headStyles: { fillColor: [231, 76, 60] },\n        footStyles: { \n          fillColor: calculatedVariance < 0 ? [231, 76, 60] : [39, 174, 96], \n          textColor: [255, 255, 255], \n          fontStyle: \"bold\" \n        },\n      })\n    }\n\n    if (order.notes) {\n      yPos = (doc as any).lastAutoTable?.finalY + 10 || yPos + 10\n      if (yPos > 270) {\n        doc.addPage()\n        yPos = 20\n      }\n      doc.setFont(\"helvetica\", \"bold\")\n      doc.text(\"Notes:\", 14, yPos)\n      yPos += 5\n      doc.setFont(\"helvetica\", \"normal\")\n      doc.text(order.notes, 14, yPos, { maxWidth: pageWidth - 28 })\n    }\n\n    const pageCount = doc.getNumberOfPages()\n    for (let i = 1; i <= pageCount; i++) {\n      doc.setPage(i)\n      doc.setFontSize(8)\n      doc.setFont(\"helvetica\", \"normal\")\n      doc.text(\n        `Generated on ${new Date().toLocaleString()} | Page ${i} of ${pageCount}`,\n        pageWidth / 2,\n        doc.internal.pageSize.getHeight() - 10,\n        { align: \"center\" }\n      )\n    }\n\n    const pdfBuffer = doc.output(\"arraybuffer\")\n\n    return new NextResponse(pdfBuffer, {\n      status: 200,\n      headers: {\n        \"Content-Type\": \"application/pdf\",\n        \"Content-Disposition\": `attachment; filename=\"${order.po_number}.pdf\"`,\n      },\n    })\n  } catch (error) {\n    console.error(\"Error generating PDF:\", error)\n    return NextResponse.json({ error: \"Failed to generate PDF\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}