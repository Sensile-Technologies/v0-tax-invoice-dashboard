{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db/client.ts"],"sourcesContent":["import { Pool } from 'pg';\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n  ssl: process.env.NODE_ENV === 'production' ? { rejectUnauthorized: false } : false,\n});\n\nexport async function query<T = any>(text: string, params?: any[]): Promise<T[]> {\n  const client = await pool.connect();\n  try {\n    const result = await client.query(text, params);\n    return result.rows as T[];\n  } finally {\n    client.release();\n  }\n}\n\nexport async function queryOne<T = any>(text: string, params?: any[]): Promise<T | null> {\n  const rows = await query<T>(text, params);\n  return rows[0] || null;\n}\n\nexport async function execute(text: string, params?: any[]): Promise<number> {\n  const client = await pool.connect();\n  try {\n    const result = await client.query(text, params);\n    return result.rowCount || 0;\n  } finally {\n    client.release();\n  }\n}\n\nexport async function getClient() {\n  return await pool.connect();\n}\n\nexport { pool };\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;;;;;AAEA,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,KAAK,sCAAwC,0BAAgC;AAC/E;AAEO,eAAe,MAAe,IAAY,EAAE,MAAc;IAC/D,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO,OAAO,IAAI;IACpB,SAAU;QACR,OAAO,OAAO;IAChB;AACF;AAEO,eAAe,SAAkB,IAAY,EAAE,MAAc;IAClE,MAAM,OAAO,MAAM,MAAS,MAAM;IAClC,OAAO,IAAI,CAAC,EAAE,IAAI;AACpB;AAEO,eAAe,QAAQ,IAAY,EAAE,MAAc;IACxD,MAAM,SAAS,MAAM,KAAK,OAAO;IACjC,IAAI;QACF,MAAM,SAAS,MAAM,OAAO,KAAK,CAAC,MAAM;QACxC,OAAO,OAAO,QAAQ,IAAI;IAC5B,SAAU;QACR,OAAO,OAAO;IAChB;AACF;AAEO,eAAe;IACpB,OAAO,MAAM,KAAK,OAAO;AAC3B"}},
    {"offset": {"line": 113, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/db/index.ts"],"sourcesContent":["export * from './client';\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 127, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/notifications/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { query } from \"@/lib/db\"\nimport { cookies } from \"next/headers\"\n\nexport async function GET(request: NextRequest) {\n  try {\n    const cookieStore = await cookies()\n    const sessionCookie = cookieStore.get('user_session')\n    \n    let vendorId = null\n    let branchId = null\n    \n    if (sessionCookie?.value) {\n      try {\n        const session = JSON.parse(sessionCookie.value)\n        vendorId = session.vendor_id\n        branchId = session.branch_id\n      } catch (e) {}\n    }\n\n    const notifications = await query(`\n      SELECT \n        id,\n        title,\n        message,\n        type,\n        priority,\n        created_at\n      FROM admin_notifications\n      WHERE is_active = true\n        AND (expires_at IS NULL OR expires_at > NOW())\n        AND (\n          target_audience = 'all'\n          OR (target_audience = 'vendor' AND vendor_id = $1)\n          OR (target_audience = 'branch' AND branch_id = $2)\n        )\n      ORDER BY priority DESC, created_at DESC\n      LIMIT 20\n    `, [vendorId, branchId])\n\n    return NextResponse.json({\n      success: true,\n      notifications: notifications || []\n    })\n  } catch (error: any) {\n    console.error(\"Error fetching notifications:\", error)\n    return NextResponse.json({\n      success: true,\n      notifications: []\n    })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;AACA;;;;;;;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,4IAAO;QACjC,MAAM,gBAAgB,YAAY,GAAG,CAAC;QAEtC,IAAI,WAAW;QACf,IAAI,WAAW;QAEf,IAAI,eAAe,OAAO;YACxB,IAAI;gBACF,MAAM,UAAU,KAAK,KAAK,CAAC,cAAc,KAAK;gBAC9C,WAAW,QAAQ,SAAS;gBAC5B,WAAW,QAAQ,SAAS;YAC9B,EAAE,OAAO,GAAG,CAAC;QACf;QAEA,MAAM,gBAAgB,MAAM,IAAA,8HAAK,EAAC,CAAC;;;;;;;;;;;;;;;;;;IAkBnC,CAAC,EAAE;YAAC;YAAU;SAAS;QAEvB,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,eAAe,iBAAiB,EAAE;QACpC;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,iCAAiC;QAC/C,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,eAAe,EAAE;QACnB;IACF;AACF"}}]
}