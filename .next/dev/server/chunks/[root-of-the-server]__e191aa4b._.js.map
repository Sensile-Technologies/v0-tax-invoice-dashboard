{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/tanks/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { Pool } from \"pg\"\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n})\n\nexport async function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url)\n    const branchId = searchParams.get(\"branch_id\")\n\n    if (!branchId) {\n      return NextResponse.json({ success: false, error: \"branch_id is required\" }, { status: 400 })\n    }\n\n    const result = await pool.query(\n      \"SELECT * FROM tanks WHERE branch_id = $1 ORDER BY tank_name\",\n      [branchId]\n    )\n\n    return NextResponse.json({ success: true, data: result.rows })\n  } catch (error) {\n    console.error(\"Error fetching tanks:\", error)\n    return NextResponse.json({ success: false, error: \"Failed to fetch tanks\" }, { status: 500 })\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const { branch_id, tank_name, fuel_type, capacity, current_stock, status } = body\n\n    if (!branch_id || !tank_name || !fuel_type) {\n      return NextResponse.json({ success: false, error: \"branch_id, tank_name, and fuel_type are required\" }, { status: 400 })\n    }\n\n    const result = await pool.query(\n      `INSERT INTO tanks (branch_id, tank_name, fuel_type, capacity, current_stock, status)\n       VALUES ($1, $2, $3, $4, $5, $6)\n       RETURNING *`,\n      [branch_id, tank_name, fuel_type, capacity || 0, current_stock || 0, status || \"active\"]\n    )\n\n    return NextResponse.json({ success: true, data: result.rows[0] })\n  } catch (error) {\n    console.error(\"Error creating tank:\", error)\n    return NextResponse.json({ success: false, error: \"Failed to create tank\" }, { status: 500 })\n  }\n}\n\nexport async function PATCH(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const { id, current_stock, status } = body\n\n    if (!id) {\n      return NextResponse.json({ success: false, error: \"Tank id is required\" }, { status: 400 })\n    }\n\n    const updates: string[] = []\n    const values: any[] = []\n    let paramIndex = 1\n\n    if (current_stock !== undefined) {\n      updates.push(`current_stock = $${paramIndex}`)\n      values.push(current_stock)\n      paramIndex++\n    }\n\n    if (status !== undefined) {\n      updates.push(`status = $${paramIndex}`)\n      values.push(status)\n      paramIndex++\n    }\n\n    if (updates.length === 0) {\n      return NextResponse.json({ success: false, error: \"No fields to update\" }, { status: 400 })\n    }\n\n    values.push(id)\n    const result = await pool.query(\n      `UPDATE tanks SET ${updates.join(\", \")} WHERE id = $${paramIndex} RETURNING *`,\n      values\n    )\n\n    return NextResponse.json({ success: true, data: result.rows[0] })\n  } catch (error) {\n    console.error(\"Error updating tank:\", error)\n    return NextResponse.json({ success: false, error: \"Failed to update tank\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}