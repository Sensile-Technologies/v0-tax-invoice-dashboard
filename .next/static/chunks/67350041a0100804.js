(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2658,e=>{"use strict";var a=e.i(43476),s=e.i(71645),l=e.i(70065),t=e.i(67881),n=e.i(94179),c=e.i(23750),i=e.i(27341),r=e.i(84762),d=e.i(62870),o=e.i(30374),x=e.i(10708),h=e.i(7233),m=e.i(55436),p=e.i(7486),u=e.i(84614),j=e.i(63488),g=e.i(43432),v=e.i(12426),N=e.i(61911),f=e.i(25652),b=e.i(75254);let y=(0,b.default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),C=(0,b.default)("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]),_=(0,b.default)("FilePenLine",[["path",{d:"m18 5-2.414-2.414A2 2 0 0 0 14.172 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2",key:"142zxg"}],["path",{d:"M21.378 12.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"2t3380"}],["path",{d:"M8 18h1",key:"13wk12"}]]),w=(0,b.default)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);var S=e.i(92930);let T=(0,b.default)("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);var k=e.i(69074),L=e.i(78583),D=e.i(46696),I=e.i(1851);let P=[{id:"contact",label:"Contact",icon:y,color:"bg-slate-500"},{id:"negotiation",label:"Negotiation",icon:f.TrendingUp,color:"bg-blue-500"},{id:"demo",label:"Demo",icon:C,color:"bg-purple-500"},{id:"contracting",label:"Contracting",icon:_,color:"bg-orange-500"},{id:"onboarding",label:"Onboarding",icon:w,color:"bg-green-500"}],A=["Website","Referral","Cold Call","Trade Show","LinkedIn","Email Campaign","Partner","Other"];function E(){let[e,f]=(0,s.useState)("pipeline"),[b,y]=(0,s.useState)([]),[C,w]=(0,s.useState)([]),[E,X]=(0,s.useState)(!0),[O,U]=(0,s.useState)(""),[F,V]=(0,s.useState)("all"),[B,M]=(0,s.useState)(!1),[K,z]=(0,s.useState)(!1),[R,H]=(0,s.useState)(!1),[q,J]=(0,s.useState)(null),[$,W]=(0,s.useState)(null),[G,Q]=(0,s.useState)(!1),[Y,Z]=(0,s.useState)(null),[ee,ea]=(0,s.useState)(null),[es,el]=(0,s.useState)(!1),[et,en]=(0,s.useState)(""),[ec,ei]=(0,s.useState)(null),[er,ed]=(0,s.useState)(!1),eo=(0,s.useRef)(null),ex=(0,s.useRef)(null),[eh,em]=(0,s.useState)({company_name:"",trading_name:"",kra_pin:"",contact_name:"",contact_email:"",contact_phone:"",stage:"contact",assigned_to:"",notes:"",expected_value:"",expected_close_date:"",source:""}),[ep,eu]=(0,s.useState)({name:"",email:"",phone:""});(0,s.useEffect)(()=>{ej(),eg()},[F]);let ej=async()=>{try{let e=new URLSearchParams;"all"!==F&&e.append("stage",F);let a=await fetch(`/api/admin/leads?${e}`),s=await a.json();y(Array.isArray(s)?s:[])}catch(e){console.error("Error fetching leads:",e),y([])}finally{X(!1)}},eg=async()=>{try{let e=await fetch("/api/admin/sales-people"),a=await e.json();w(Array.isArray(a)?a:[])}catch(e){console.error("Error fetching sales people:",e),w([])}},ev=async()=>{if(!eh.company_name)return void D.toast.error("Please enter a company name");try{if(!(await fetch("/api/admin/leads",{method:q?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(q?{...eh,id:q.id}:eh)})).ok)throw Error("Failed to save lead");D.toast.success(q?"Lead updated successfully":"Lead created successfully"),M(!1),ey(),ej()}catch(e){D.toast.error("Failed to save lead")}},eN=async e=>{if(confirm("Are you sure you want to archive this lead? It will be hidden from the pipeline."))try{if(!(await fetch(`/api/admin/leads?id=${e}&action=archive`,{method:"DELETE"})).ok)throw Error("Failed to archive lead");D.toast.success("Lead archived successfully"),ej()}catch(e){D.toast.error("Failed to archive lead")}},ef=async()=>{if(!ee||!Y)return void D.toast.error("Please select a contract file");el(!0);try{let e=new FormData;if(e.append("contract",ee),e.append("leadId",Y.id),!(await fetch("/api/admin/leads/upload-contract",{method:"POST",body:e})).ok)throw Error("Failed to upload contract");D.toast.success("Contract uploaded and lead moved to Onboarding"),Q(!1),ea(null),Z(null),ej()}catch(e){D.toast.error("Failed to upload contract")}finally{el(!1)}},eb=async()=>{if(!ep.name)return void D.toast.error("Please enter a name");try{if(!(await fetch("/api/admin/sales-people",{method:$?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($?{...ep,id:$.id,is_active:!0}:ep)})).ok)throw Error("Failed to save sales person");D.toast.success($?"Sales person updated":"Sales person added"),H(!1),eC(),eg()}catch(e){D.toast.error("Failed to save sales person")}},ey=()=>{em({company_name:"",trading_name:"",kra_pin:"",contact_name:"",contact_email:"",contact_phone:"",stage:"contact",assigned_to:"",notes:"",expected_value:"",expected_close_date:"",source:""}),J(null)},eC=()=>{eu({name:"",email:"",phone:""}),W(null)},e_=e=>{J(e),en(e.stage),ei(null),em({company_name:e.company_name,trading_name:e.trading_name||"",kra_pin:e.kra_pin||"",contact_name:e.contact_name||"",contact_email:e.contact_email||"",contact_phone:e.contact_phone||"",stage:e.stage,assigned_to:e.assigned_to||"",notes:e.notes||"",expected_value:e.expected_value?.toString()||"",expected_close_date:e.expected_close_date||"",source:e.source||""}),z(!0)},ew=async()=>{if(q){if("onboarding"===et&&"onboarding"!==q.stage&&!ec)return void D.toast.error("Contract upload is required when moving to Onboarding stage");ed(!0);try{let e=null;if(ec){let a=new FormData;a.append("file",ec),a.append("lead_id",q.id),a.append("company_name",eh.company_name);let s=await fetch("/api/admin/leads/upload-contract",{method:"POST",body:a});if(!s.ok)throw Error("Failed to upload contract");e=(await s.json()).contract_url}let a={...eh,stage:et,expected_value:eh.expected_value?parseFloat(eh.expected_value):null};if(e&&(a.contract_url=e),!(await fetch(`/api/admin/leads?id=${q.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).ok)throw Error("Failed to update lead");D.toast.success("Lead updated successfully"),z(!1),J(null),ei(null),ey(),ej()}catch(e){D.toast.error("Failed to update lead")}finally{ed(!1)}}},eS=e=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(e),eT=b.filter(e=>e.company_name.toLowerCase().includes(O.toLowerCase())||e.contact_name?.toLowerCase().includes(O.toLowerCase())||e.contact_email?.toLowerCase().includes(O.toLowerCase())),ek=e=>eT.filter(a=>a.stage===e),eL=b.reduce((e,a)=>e+(Number(a.expected_value)||0),0);return E?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"Sales Management"}),(0,a.jsx)("p",{className:"text-slate-500",children:"Track leads through your sales pipeline"})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)(l.Card,{children:(0,a.jsx)(l.CardContent,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Total Leads"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:b.length})]}),(0,a.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(N.Users,{className:"h-5 w-5 text-blue-600"})})]})})}),(0,a.jsx)(l.Card,{children:(0,a.jsx)(l.CardContent,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Pipeline Value"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:eS(eL)})]}),(0,a.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(v.DollarSign,{className:"h-5 w-5 text-green-600"})})]})})}),(0,a.jsx)(l.Card,{children:(0,a.jsx)(l.CardContent,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"In Contracting"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:ek("contracting").length})]}),(0,a.jsx)("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(_,{className:"h-5 w-5 text-orange-600"})})]})})}),(0,a.jsx)(l.Card,{children:(0,a.jsx)(l.CardContent,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Sales Team"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:C.filter(e=>e.is_active).length})]}),(0,a.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(u.User,{className:"h-5 w-5 text-purple-600"})})]})})})]}),(0,a.jsxs)(i.Tabs,{value:e,onValueChange:f,children:[(0,a.jsxs)(i.TabsList,{children:[(0,a.jsx)(i.TabsTrigger,{value:"pipeline",children:"Pipeline"}),(0,a.jsx)(i.TabsTrigger,{value:"leads",children:"All Leads"}),(0,a.jsx)(i.TabsTrigger,{value:"team",children:"Sales Team"})]}),(0,a.jsxs)(i.TabsContent,{value:"pipeline",className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)(m.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,a.jsx)(c.Input,{placeholder:"Search leads...",value:O,onChange:e=>U(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(o.Dialog,{open:B,onOpenChange:e=>{M(e),e||ey()},children:[(0,a.jsx)(o.DialogTrigger,{asChild:!0,children:(0,a.jsxs)(t.Button,{children:[(0,a.jsx)(h.Plus,{className:"h-4 w-4 mr-2"}),"Add Lead"]})}),(0,a.jsxs)(o.DialogContent,{className:"max-w-2xl",children:[(0,a.jsxs)(o.DialogHeader,{children:[(0,a.jsx)(o.DialogTitle,{children:q?"Edit Lead":"Add New Lead"}),(0,a.jsx)(o.DialogDescription,{children:"Enter the lead details"})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Company Name *"}),(0,a.jsx)(c.Input,{value:eh.company_name,onChange:e=>em({...eh,company_name:e.target.value}),placeholder:"Acme Corp"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Trading Name"}),(0,a.jsx)(c.Input,{value:eh.trading_name,onChange:e=>em({...eh,trading_name:e.target.value}),placeholder:"Acme Trading"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"KRA PIN"}),(0,a.jsx)(c.Input,{value:eh.kra_pin,onChange:e=>em({...eh,kra_pin:e.target.value}),placeholder:"A123456789X"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Contact Name"}),(0,a.jsx)(c.Input,{value:eh.contact_name,onChange:e=>em({...eh,contact_name:e.target.value}),placeholder:"John Doe"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Email"}),(0,a.jsx)(c.Input,{type:"email",value:eh.contact_email,onChange:e=>em({...eh,contact_email:e.target.value}),placeholder:"john@acme.com"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Phone"}),(0,a.jsx)(c.Input,{value:eh.contact_phone,onChange:e=>em({...eh,contact_phone:e.target.value}),placeholder:"+254 7XX XXX XXX"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Stage"}),(0,a.jsxs)(d.Select,{value:eh.stage,onValueChange:e=>em({...eh,stage:e}),children:[(0,a.jsx)(d.SelectTrigger,{children:(0,a.jsx)(d.SelectValue,{})}),(0,a.jsx)(d.SelectContent,{children:P.map(e=>(0,a.jsx)(d.SelectItem,{value:e.id,children:e.label},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Assigned To"}),(0,a.jsxs)(d.Select,{value:eh.assigned_to,onValueChange:e=>em({...eh,assigned_to:e}),children:[(0,a.jsx)(d.SelectTrigger,{children:(0,a.jsx)(d.SelectValue,{placeholder:"Select sales person"})}),(0,a.jsx)(d.SelectContent,{children:C.filter(e=>e.is_active).map(e=>(0,a.jsx)(d.SelectItem,{value:e.id,children:e.name},e.id))})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Expected Value (KES)"}),(0,a.jsx)(c.Input,{type:"number",value:eh.expected_value,onChange:e=>em({...eh,expected_value:e.target.value}),placeholder:"100000"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Expected Close Date"}),(0,a.jsx)(c.Input,{type:"date",value:eh.expected_close_date,onChange:e=>em({...eh,expected_close_date:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Source"}),(0,a.jsxs)(d.Select,{value:eh.source,onValueChange:e=>em({...eh,source:e}),children:[(0,a.jsx)(d.SelectTrigger,{children:(0,a.jsx)(d.SelectValue,{placeholder:"Select source"})}),(0,a.jsx)(d.SelectContent,{children:A.map(e=>(0,a.jsx)(d.SelectItem,{value:e,children:e},e))})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Notes"}),(0,a.jsx)(r.Textarea,{value:eh.notes,onChange:e=>em({...eh,notes:e.target.value}),placeholder:"Additional notes about this lead...",rows:3})]}),(0,a.jsx)(t.Button,{onClick:ev,className:"w-full",children:q?"Update Lead":"Create Lead"})]})]})]})]}),(0,a.jsx)("div",{className:"flex gap-4 overflow-x-auto pb-4 pr-4",children:P.map(e=>{let s=ek(e.id),t=e.icon;return(0,a.jsxs)("div",{className:"flex-shrink-0 w-[220px]",children:[(0,a.jsxs)("div",{className:`${e.color} text-white px-3 py-2 rounded-t-lg flex items-center justify-between`,children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(t,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-medium text-sm",children:e.label})]}),(0,a.jsx)(n.Badge,{variant:"secondary",className:"bg-white/20 text-white text-xs",children:s.length})]}),(0,a.jsxs)("div",{className:"bg-slate-100 p-2 rounded-b-lg min-h-[400px] space-y-2",children:[s.map(e=>(0,a.jsx)(l.Card,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>e_(e),children:(0,a.jsxs)(l.CardContent,{className:"p-3",children:[(0,a.jsx)("h4",{className:"font-medium text-sm truncate",children:e.company_name}),e.contact_name&&(0,a.jsx)("p",{className:"text-xs text-slate-500 truncate",children:e.contact_name}),Number(e.expected_value)>0&&(0,a.jsx)("p",{className:"text-xs text-green-600 font-medium mt-2",children:eS(Number(e.expected_value))}),e.assigned_to_name&&(0,a.jsxs)("div",{className:"flex items-center gap-1 mt-2",children:[(0,a.jsx)(u.User,{className:"h-3 w-3 text-slate-400"}),(0,a.jsx)("span",{className:"text-xs text-slate-500 truncate",children:e.assigned_to_name})]})]})},e.id)),0===s.length&&(0,a.jsx)("div",{className:"text-center py-8 text-slate-400 text-sm",children:"No leads"})]})]},e.id)})})]}),(0,a.jsxs)(i.TabsContent,{value:"leads",className:"mt-4 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)(m.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,a.jsx)(c.Input,{placeholder:"Search leads...",value:O,onChange:e=>U(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(d.Select,{value:F,onValueChange:V,children:[(0,a.jsx)(d.SelectTrigger,{className:"w-40",children:(0,a.jsx)(d.SelectValue,{placeholder:"All Stages"})}),(0,a.jsxs)(d.SelectContent,{children:[(0,a.jsx)(d.SelectItem,{value:"all",children:"All Stages"}),P.map(e=>(0,a.jsx)(d.SelectItem,{value:e.id,children:e.label},e.id))]})]})]}),(0,a.jsx)("div",{className:"space-y-3",children:eT.map(e=>{let s;return(0,a.jsx)(l.Card,{className:"hover:shadow-md transition-shadow",children:(0,a.jsx)(l.CardContent,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(p.Building2,{className:"h-5 w-5 text-slate-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.company_name}),(0,a.jsx)(n.Badge,{className:`${(s=e.stage,P.find(e=>e.id===s)?.color||"bg-slate-500")} text-white`,children:P.find(a=>a.id===e.stage)?.label})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-1 text-sm text-slate-500",children:[e.contact_name&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(u.User,{className:"h-3 w-3"}),e.contact_name]}),e.contact_email&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(j.Mail,{className:"h-3 w-3"}),e.contact_email]}),e.assigned_to_name&&(0,a.jsxs)("span",{className:"flex items-center gap-1 text-blue-600",children:[(0,a.jsx)(N.Users,{className:"h-3 w-3"}),e.assigned_to_name]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[Number(e.expected_value)>0&&(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-lg font-bold text-green-600",children:eS(Number(e.expected_value))}),e.expected_close_date&&(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:["Close: ",(0,I.format)(new Date(e.expected_close_date),"MMM d, yyyy")]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(t.Button,{variant:"outline",size:"sm",onClick:()=>e_(e),children:(0,a.jsx)(S.Edit2,{className:"h-4 w-4"})}),(0,a.jsx)(t.Button,{variant:"outline",size:"sm",onClick:()=>eN(e.id),className:"text-amber-600 hover:text-amber-800",children:(0,a.jsx)(T,{className:"h-4 w-4"})})]})]})]})})},e.id)})}),0===eT.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(N.Users,{className:"h-12 w-12 text-slate-300 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-slate-500",children:"No leads found"})]})]}),(0,a.jsxs)(i.TabsContent,{value:"team",className:"mt-4 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Sales Team"}),(0,a.jsxs)(o.Dialog,{open:R,onOpenChange:e=>{H(e),e||eC()},children:[(0,a.jsx)(o.DialogTrigger,{asChild:!0,children:(0,a.jsxs)(t.Button,{children:[(0,a.jsx)(h.Plus,{className:"h-4 w-4 mr-2"}),"Add Sales Person"]})}),(0,a.jsxs)(o.DialogContent,{children:[(0,a.jsxs)(o.DialogHeader,{children:[(0,a.jsx)(o.DialogTitle,{children:$?"Edit Sales Person":"Add Sales Person"}),(0,a.jsx)(o.DialogDescription,{children:"Enter the sales team member details"})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Name *"}),(0,a.jsx)(c.Input,{value:ep.name,onChange:e=>eu({...ep,name:e.target.value}),placeholder:"John Doe"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Email"}),(0,a.jsx)(c.Input,{type:"email",value:ep.email,onChange:e=>eu({...ep,email:e.target.value}),placeholder:"john@flow360.co.ke"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Phone"}),(0,a.jsx)(c.Input,{value:ep.phone,onChange:e=>eu({...ep,phone:e.target.value}),placeholder:"+254 7XX XXX XXX"})]}),(0,a.jsx)(t.Button,{onClick:eb,className:"w-full",children:$?"Update":"Add Sales Person"})]})]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:C.map(e=>{let s=b.filter(a=>a.assigned_to===e.id),c=s.reduce((e,a)=>e+(Number(a.expected_value)||0),0);return(0,a.jsx)(l.Card,{className:"hover:shadow-md transition-shadow",children:(0,a.jsxs)(l.CardContent,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(u.User,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.name}),(0,a.jsx)(n.Badge,{variant:e.is_active?"default":"secondary",children:e.is_active?"Active":"Inactive"})]})]}),(0,a.jsx)(t.Button,{variant:"ghost",size:"sm",onClick:()=>{W(e),eu({name:e.name,email:e.email||"",phone:e.phone||""}),H(!0)},children:(0,a.jsx)(S.Edit2,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"mt-4 space-y-2",children:[e.email&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,a.jsx)(j.Mail,{className:"h-4 w-4"}),e.email]}),e.phone&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,a.jsx)(g.Phone,{className:"h-4 w-4"}),e.phone]})]}),(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Leads"}),(0,a.jsx)("p",{className:"text-lg font-bold",children:s.length})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Pipeline Value"}),(0,a.jsx)("p",{className:"text-lg font-bold text-green-600",children:eS(c)})]})]})]})},e.id)})}),0===C.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(N.Users,{className:"h-12 w-12 text-slate-300 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-slate-500",children:"No sales team members added yet"})]})]})]}),(0,a.jsx)(o.Dialog,{open:G,onOpenChange:e=>{Q(e),e||(ea(null),Z(null))},children:(0,a.jsxs)(o.DialogContent,{className:"max-w-md",children:[(0,a.jsxs)(o.DialogHeader,{children:[(0,a.jsx)(o.DialogTitle,{children:"Upload Contract"}),(0,a.jsxs)(o.DialogDescription,{children:["A signed contract is required to move ",Y?.company_name," to the Onboarding stage."]})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Contract Document *"}),(0,a.jsxs)("div",{className:"border-2 border-dashed border-slate-200 rounded-lg p-6 text-center cursor-pointer hover:border-blue-500 transition-colors",onClick:()=>eo.current?.click(),children:[(0,a.jsx)("input",{type:"file",ref:eo,className:"hidden",accept:".pdf,.doc,.docx",onChange:e=>{let a=e.target.files?.[0];a&&ea(a)}}),ee?(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-green-600",children:[(0,a.jsx)(L.FileText,{className:"h-8 w-8"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-medium",children:ee.name}),(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:[(ee.size/1024).toFixed(1)," KB"]})]})]}):(0,a.jsxs)("div",{className:"text-slate-500",children:[(0,a.jsx)(k.Upload,{className:"h-8 w-8 mx-auto mb-2"}),(0,a.jsx)("p",{className:"font-medium",children:"Click to upload contract"}),(0,a.jsx)("p",{className:"text-xs",children:"PDF, DOC, or DOCX (max 10MB)"})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(t.Button,{variant:"outline",className:"flex-1",onClick:()=>{Q(!1),ea(null),Z(null)},children:"Cancel"}),(0,a.jsx)(t.Button,{className:"flex-1",onClick:ef,disabled:!ee||es,children:es?"Uploading...":"Upload & Move to Onboarding"})]})]})]})}),(0,a.jsx)(o.Dialog,{open:K,onOpenChange:e=>{z(e),e||(J(null),ei(null),ey())},children:(0,a.jsxs)(o.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(o.DialogHeader,{children:[(0,a.jsx)(o.DialogTitle,{children:"Edit Lead"}),(0,a.jsx)(o.DialogDescription,{children:"Update lead information and stage"})]}),q&&(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Company Name *"}),(0,a.jsx)(c.Input,{value:eh.company_name,onChange:e=>em({...eh,company_name:e.target.value}),placeholder:"Acme Corp"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Trading Name"}),(0,a.jsx)(c.Input,{value:eh.trading_name,onChange:e=>em({...eh,trading_name:e.target.value}),placeholder:"Acme Trading"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"KRA PIN"}),(0,a.jsx)(c.Input,{value:eh.kra_pin,onChange:e=>em({...eh,kra_pin:e.target.value}),placeholder:"A123456789X"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Contact Name"}),(0,a.jsx)(c.Input,{value:eh.contact_name,onChange:e=>em({...eh,contact_name:e.target.value}),placeholder:"John Doe"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Email"}),(0,a.jsx)(c.Input,{type:"email",value:eh.contact_email,onChange:e=>em({...eh,contact_email:e.target.value}),placeholder:"john@acme.com"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Phone"}),(0,a.jsx)(c.Input,{value:eh.contact_phone,onChange:e=>em({...eh,contact_phone:e.target.value}),placeholder:"+254 7XX XXX XXX"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Stage"}),(0,a.jsxs)(d.Select,{value:et,onValueChange:e=>en(e),children:[(0,a.jsx)(d.SelectTrigger,{children:(0,a.jsx)(d.SelectValue,{})}),(0,a.jsx)(d.SelectContent,{children:P.map(e=>(0,a.jsx)(d.SelectItem,{value:e.id,children:e.label},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Assigned To"}),(0,a.jsxs)(d.Select,{value:eh.assigned_to,onValueChange:e=>em({...eh,assigned_to:e}),children:[(0,a.jsx)(d.SelectTrigger,{children:(0,a.jsx)(d.SelectValue,{placeholder:"Select sales person"})}),(0,a.jsx)(d.SelectContent,{children:C.filter(e=>e.is_active).map(e=>(0,a.jsx)(d.SelectItem,{value:e.id,children:e.name},e.id))})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Expected Value (KES)"}),(0,a.jsx)(c.Input,{type:"number",value:eh.expected_value,onChange:e=>em({...eh,expected_value:e.target.value}),placeholder:"100000"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Source"}),(0,a.jsxs)(d.Select,{value:eh.source,onValueChange:e=>em({...eh,source:e}),children:[(0,a.jsx)(d.SelectTrigger,{children:(0,a.jsx)(d.SelectValue,{placeholder:"Select source"})}),(0,a.jsx)(d.SelectContent,{children:A.map(e=>(0,a.jsx)(d.SelectItem,{value:e,children:e},e))})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Notes"}),(0,a.jsx)(r.Textarea,{value:eh.notes,onChange:e=>em({...eh,notes:e.target.value}),placeholder:"Additional notes about this lead...",rows:3})]}),"onboarding"===et&&"onboarding"!==q.stage&&(0,a.jsxs)("div",{className:"space-y-2 p-4 bg-amber-50 rounded-lg border border-amber-200",children:[(0,a.jsx)(x.Label,{className:"text-amber-800",children:"Contract Document Required *"}),(0,a.jsx)("p",{className:"text-sm text-amber-600 mb-2",children:"A signed contract is required when moving to Onboarding stage."}),(0,a.jsxs)("div",{className:"border-2 border-dashed border-amber-300 rounded-lg p-4 text-center cursor-pointer hover:border-amber-500 transition-colors bg-white",onClick:()=>ex.current?.click(),children:[(0,a.jsx)("input",{type:"file",ref:ex,className:"hidden",accept:".pdf,.doc,.docx",onChange:e=>{let a=e.target.files?.[0];a&&ei(a)}}),ec?(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-green-600",children:[(0,a.jsx)(L.FileText,{className:"h-6 w-6"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-medium text-sm",children:ec.name}),(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:[(ec.size/1024).toFixed(1)," KB"]})]})]}):(0,a.jsxs)("div",{className:"text-amber-600",children:[(0,a.jsx)(k.Upload,{className:"h-6 w-6 mx-auto mb-1"}),(0,a.jsx)("p",{className:"font-medium text-sm",children:"Click to upload contract"}),(0,a.jsx)("p",{className:"text-xs",children:"PDF, DOC, or DOCX"})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,a.jsx)(t.Button,{variant:"outline",className:"flex-1",onClick:()=>{z(!1),J(null),ei(null),ey()},children:"Cancel"}),(0,a.jsx)(t.Button,{className:"flex-1",onClick:ew,disabled:er,children:er?"Saving...":"Save Changes"})]})]})]})})]})}e.s(["default",()=>E],2658)}]);