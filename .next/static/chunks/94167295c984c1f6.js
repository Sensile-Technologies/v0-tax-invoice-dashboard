(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,76009,e=>{"use strict";var a=e.i(47167),s=e.i(43476),r=e.i(22623),n=e.i(67881),t=e.i(94179),l=e.i(88511),i=e.i(98919),c=e.i(95468),d=e.i(7486),o=e.i(25652),h=e.i(61911),x=e.i(1928),m=e.i(7233),u=e.i(64659),g=e.i(88844),p=e.i(69074),j=e.i(12426),f=e.i(31278),v=e.i(15788),N=e.i(91741),y=e.i(71645),b=e.i(9694),C=e.i(75225),w=e.i(29228),k=e.i(72325),S=e.i(85183),I=e.i(93230),T=e.i(72526),D=e.i(34239),P=e.i(31195),B=e.i(59559),L=e.i(70065),O=e.i(30374),M=e.i(23750),$=e.i(10708),_=e.i(63415),F=e.i(62870),E=e.i(18566),R=e.i(33541),U=e.i(69296);function A(){let e=(0,E.useRouter)(),[A,q]=(0,y.useState)(!1),[z,H]=(0,y.useState)(!1),[K,G]=(0,y.useState)(!1),[V,J]=(0,y.useState)(null),[W,X]=(0,y.useState)(!1),[Y,Q]=(0,y.useState)(!1),[Z,ee]=(0,y.useState)(!0),[ea,es]=(0,y.useState)(!1),[er,en]=(0,y.useState)(null),[et,el]=(0,y.useState)([]),[ei,ec]=(0,y.useState)(!0),[ed,eo]=(0,y.useState)(null),[eh,ex]=(0,y.useState)(!0),{formatCurrency:em}=(0,R.useCurrency)();(0,y.useEffect)(()=>{(async()=>{let a=(0,U.getCurrentUser)();if(a&&["supervisor","manager","cashier"].includes((a.role||"").toLowerCase())){Q(!0);let s=a.branch_id;e.replace(s?`/sales/summary?branch=${s}`:"/sales/summary");return}try{let s=await fetch("/api/headquarters/stats",{credentials:"include",method:"GET"});if(401===s.status||403===s.status){Q(!0);let s=a?.branch_id;e.replace(s?`/sales/summary?branch=${s}`:"/sales/summary");return}if(s.ok){let e=await s.json();eo(e),ex(!1)}}catch(e){console.error("Error checking HQ access:",e)}ee(!1)})()},[e]),(0,y.useEffect)(()=>{Z||Y||eu()},[Z,Y]);let eu=async()=>{try{ec(!0);let e=(0,U.getCurrentUser)(),a=e?.id,s=a?`/api/branches/list?user_id=${a}`:"/api/branches/list",r=await fetch(s);if(r.ok){let e=(await r.json()).map(e=>({id:e.id,name:e.name,location:e.location,status:e.status.charAt(0).toUpperCase()+e.status.slice(1),revenue:e.monthly_revenue||0,monthToDateRevenue:e.monthToDateRevenue||0,currentShiftRevenue:e.currentShiftRevenue||0,transactions:e.transactions||0,inventory:e.inventory||0,performance:e.performance||"+0%",gradient:"from-blue-600 via-blue-500 to-cyan-400",manager:e.manager,phone:e.phone,email:e.email,bhfId:e.bhf_id,tankConfig:e.tank_config||{},storageIndices:e.storage_indices||[],device_token:e.device_token,vendor_id:e.vendor_id}));el(e)}else console.error("Failed to fetch branches:",r.status)}catch(e){console.error("Error fetching branches:",e)}finally{ec(!1)}},eg=async()=>{if(er)try{let e=new FormData;e.append("file",er),(await fetch("/api/global-uploads",{method:"POST",body:e})).ok?(alert("File uploaded successfully!"),es(!1),en(null)):alert("Failed to upload file")}catch(e){console.error("Upload error:",e),alert("Error uploading file")}},[ep,ej]=(0,y.useState)({name:"",location:"",manager:"",phone:"",email:"",address:"",county:"",localTaxOffice:"",hardwareType:"",serialNumber:"",storageIndices:[],newStorageIndex:"",vendorId:"",kraPin:"",controllerId:"",tankConfig:{}}),ef=ed?.totalRevenue||0,ev=ed?.totalTransactions||0,eN=ed?.totalInventory||0,ey=ed?.totalEmployees||0,eb=ed?.revenueGrowth||0;ed?.inventoryGrowth;let eC=async()=>{if(!ep.name||!ep.location||!ep.county||!ep.localTaxOffice)return void alert("Please fill in all required fields (Branch Name, Location, County, Local Tax Office)");X(!0);try{let e,s=(0,U.getCurrentUser)(),r=await fetch("/api/branches",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:s?.id,vendor_id:ep.vendorId||void 0,name:ep.name,location:ep.location,manager:ep.manager,email:ep.email,phone:ep.phone,storage_indices:ep.storageIndices,county:ep.county,address:ep.address,local_tax_office:ep.localTaxOffice,controller_id:ep.controllerId||void 0})});if(!r.ok){let e=await r.text();console.error("[v0] Branch API error:",r.status,e),alert(`Branch creation failed: Server returned ${r.status}. ${e||"Please try again."}`),X(!1);return}let n=await r.text();if(!n){console.error("[v0] Empty response from branch API"),alert("Branch creation failed: Empty response from server. Please try again."),X(!1);return}try{e=JSON.parse(n)}catch(e){console.error("[v0] Failed to parse branch response:",n),alert("Branch creation failed: Invalid response from server. Please try again."),X(!1);return}if(!e.success){console.error("[v0] Branch creation error:",e.error),alert(`Branch creation failed: ${e.error}`),X(!1);return}console.log("[v0] Branch created:",e.data);let t=e.data,l=new Map,i=[];Object.entries(ep.tankConfig).forEach(([e,a])=>{let s=a.fuelType||"Petrol";i.push({branch_id:t.id,tank_name:e,fuel_type:s,capacity:Number.parseFloat(a.tankCapacity||"0"),current_stock:Number.parseFloat(a.initialStock||"0"),status:"active"}),a.dispensers.forEach(e=>{let a=Number.parseInt(e.replace(/\D/g,""))||l.size+1;l.has(a)||l.set(a,new Set),l.get(a).add(s)})});let c=Array.from(l.entries()).map(([e,a])=>({branch_id:t.id,dispenser_number:e,fuel_type:Array.from(a)[0],status:"active"}));if(i.length>0){for(let e of i)await fetch("/api/tanks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});console.log("[v0] Tanks created:",i)}let d=0;if(c.length>0){console.log("[v0] Creating dispensers:",{dispensersToCreate:c});let e=[];for(let a of c){let s=await fetch("/api/dispensers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),r=await s.json();r.success&&e.push(r.data)}console.log("[v0] Dispensers created:",e);let a=[];if(e.forEach(e=>{let s=l.get(e.dispenser_number);if(s){let r=1;s.forEach(s=>{a.push({branch_id:t.id,dispenser_id:e.id,nozzle_number:r++,fuel_type:s,initial_meter_reading:0,status:"active"})})}}),a.length>0){for(let e of(console.log("[v0] Creating nozzles:",{nozzlesToCreate:a}),a))await fetch("/api/nozzles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});d=a.length}}try{let e=await fetch("/api/branches/register-backend",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branchId:t.id,name:ep.name,location:ep.location,county:ep.county,address:ep.address,organization:a.default.env.NEXT_PUBLIC_ORGANIZATION_ID})}),s=await e.json();e.ok&&s.success?alert(`Branch "${ep.name}" created successfully!
Local database entry created
${i.length} tank(s) created
${c.length} dispenser(s) created
${d} nozzle(s) created
Backend registration completed`):alert(`Branch "${ep.name}" created successfully!
Local database entry created
${i.length} tank(s) created
${c.length} dispenser(s) created
${d} nozzle(s) created
Backend registration failed (can be retried later)`)}catch(e){console.log("[v0] Backend registration failed:",e),alert(`Branch "${ep.name}" created successfully!
Local database entry created
${i.length} tank(s) created
${c.length} dispenser(s) created
${d} nozzle(s) created
Backend registration unavailable (can be retried later)`)}q(!1),ej({name:"",location:"",manager:"",email:"",phone:"",address:"",county:"",localTaxOffice:"",hardwareType:"",serialNumber:"",storageIndices:[],newStorageIndex:"",vendorId:"",kraPin:"",controllerId:"",tankConfig:{}}),await eu()}catch(e){console.error("Error creating branch:",e),alert(`Branch creation failed: ${e.message||"Unknown error"}`)}finally{X(!1)}},ew=e=>{console.log("[v0] Opening edit dialog for branch:",e);let a=et.find(a=>a.id===e.id)||e;J(a),ej({name:a.name||"",location:a.location||"",manager:a.manager||"",email:a.email||"",phone:a.phone||"",address:a.address||"",county:a.county||"",localTaxOffice:a.local_tax_office||"",hardwareType:"",serialNumber:"",storageIndices:a.storage_indices||[],newStorageIndex:"",vendorId:a.vendor_id||"",kraPin:a.kra_pin||"",controllerId:a.controller_id||"",tankConfig:a.tank_config||{}}),H(!0)},ek=async()=>{if(V){if(console.log("[v0] Updating branch:",V.id,ep),!ep.name||!ep.location||!ep.county||!ep.localTaxOffice)return void alert("Please fill in all required fields (Branch Name, Location, County, Local Tax Office)");try{let e=await fetch(`/api/branches/${V.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:ep.name,location:ep.location,manager:ep.manager,email:ep.email,phone:ep.phone,address:ep.address,county:ep.county,localTaxOffice:ep.localTaxOffice,storageIndices:ep.storageIndices,tankConfig:ep.tankConfig,kraPin:ep.kraPin,controllerId:ep.controllerId})});if(e.ok)alert("Branch updated successfully!"),H(!1),J(null),await eu();else{let a=await e.json();console.error("Update error:",a),alert(`Failed to update branch: ${a.error||"Unknown error"}`)}}catch(e){console.error("Error updating branch:",e),alert("Error updating branch. Please try again.")}}},eS=async(e,a)=>{if(confirm(`Are you sure you want to delete the branch "${a}"? This action cannot be undone.`))try{let s=await fetch(`/api/branches/${e}`,{method:"DELETE"});if(s.ok)alert(`Branch "${a}" deleted successfully!`),await eu();else{let e=await s.json();console.error("Delete error:",e),alert(`Failed to delete branch: ${e.error||"Unknown error"}`)}}catch(e){console.error("Error deleting branch:",e),alert("Error deleting branch. Please try again.")}};return Z||Y?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800",children:(0,s.jsxs)("div",{className:"text-center text-white",children:[(0,s.jsx)(f.Loader2,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),(0,s.jsx)("p",{children:Y?"Redirecting to your branch...":"Checking access..."})]})}):(0,s.jsxs)("div",{className:"flex h-screen flex-col overflow-hidden bg-gradient-to-b from-slate-900 via-blue-900 to-white",children:[(0,s.jsx)(r.DashboardHeader,{currentBranch:"hq"}),(0,s.jsxs)("main",{className:"flex-1 overflow-y-auto p-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-balance text-white",children:"Headquarters Overview"}),(0,s.jsx)("p",{className:"mt-1 text-white/80 text-pretty",children:"Monitor all branches and organization performance"})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(_.DropdownMenu,{children:[(0,s.jsx)(_.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(n.Button,{variant:"ghost",className:"rounded-xl bg-transparent text-white hover:bg-white/10",children:[(0,s.jsx)(d.Building2,{className:"mr-2 h-4 w-4"}),"Branches",(0,s.jsx)(u.ChevronDown,{className:"ml-2 h-4 w-4"})]})}),(0,s.jsxs)(_.DropdownMenuContent,{align:"end",className:"w-56 rounded-xl",children:[(0,s.jsxs)(_.DropdownMenuItem,{onSelect:()=>q(!0),className:"cursor-pointer rounded-lg",children:[(0,s.jsx)(m.Plus,{className:"mr-2 h-4 w-4"}),"Create Branch"]}),(0,s.jsxs)(_.DropdownMenuSub,{children:[(0,s.jsxs)(_.DropdownMenuSubTrigger,{className:"cursor-pointer rounded-lg",children:[(0,s.jsx)(l.Edit,{className:"mr-2 h-4 w-4"}),"Edit Branch Details"]}),(0,s.jsx)(_.DropdownMenuSubContent,{className:"rounded-xl",children:et.map(e=>(0,s.jsx)(_.DropdownMenuItem,{onSelect:()=>ew(e),className:"cursor-pointer rounded-lg",children:e.name},e.id))})]}),(0,s.jsxs)(_.DropdownMenuItem,{onSelect:()=>e.push("/headquarters/inventory"),className:"cursor-pointer rounded-lg",children:[(0,s.jsx)(g.Package,{className:"mr-2 h-4 w-4"}),"Inventory"]}),(0,s.jsxs)(_.DropdownMenuItem,{onSelect:()=>es(!0),className:"cursor-pointer rounded-lg",children:[(0,s.jsx)(p.Upload,{className:"mr-2 h-4 w-4"}),"Global Uploads"]})]})]}),(0,s.jsxs)(_.DropdownMenu,{children:[(0,s.jsx)(_.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(n.Button,{variant:"ghost",className:"gap-2 rounded-xl bg-transparent text-white hover:bg-white/10",children:[(0,s.jsx)(h.Users,{className:"h-4 w-4"}),"Users",(0,s.jsx)(u.ChevronDown,{className:"h-4 w-4"})]})}),(0,s.jsxs)(_.DropdownMenuContent,{align:"end",className:"w-56 rounded-xl",children:[(0,s.jsx)(_.DropdownMenuItem,{asChild:!0,className:"cursor-pointer rounded-lg",children:(0,s.jsxs)("a",{href:"/headquarters/staff-management",className:"flex items-center gap-2",children:[(0,s.jsx)(h.Users,{className:"h-4 w-4"}),"Staff Management"]})}),(0,s.jsx)(_.DropdownMenuItem,{asChild:!0,className:"cursor-pointer rounded-lg",children:(0,s.jsxs)("a",{href:"/headquarters/roles",className:"flex items-center gap-2",children:[(0,s.jsx)(i.Shield,{className:"h-4 w-4"}),"Roles & Permissions"]})}),(0,s.jsx)(_.DropdownMenuItem,{asChild:!0,className:"cursor-pointer rounded-lg",children:(0,s.jsxs)("a",{href:"/headquarters/approvals",className:"flex items-center gap-2",children:[(0,s.jsx)(c.CheckCircle2,{className:"h-4 w-4"}),"Approval Workflows"]})})]})]}),(0,s.jsxs)(n.Button,{variant:"ghost",className:"rounded-xl bg-transparent text-white hover:bg-white/10",onClick:()=>e.push("/headquarters/items"),children:[(0,s.jsx)(g.Package,{className:"mr-2 h-4 w-4"}),"Items"]}),(0,s.jsxs)(_.DropdownMenu,{children:[(0,s.jsx)(_.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(n.Button,{variant:"ghost",className:"rounded-xl bg-transparent text-white hover:bg-white/10",children:[(0,s.jsx)(v.Truck,{className:"mr-2 h-4 w-4"}),"Suppliers",(0,s.jsx)(u.ChevronDown,{className:"ml-2 h-4 w-4"})]})}),(0,s.jsxs)(_.DropdownMenuContent,{align:"end",className:"w-56 rounded-xl",children:[(0,s.jsx)(_.DropdownMenuItem,{asChild:!0,className:"cursor-pointer rounded-lg",children:(0,s.jsxs)("a",{href:"/headquarters/suppliers",className:"flex items-center gap-2",children:[(0,s.jsx)(g.Package,{className:"h-4 w-4"}),"Suppliers"]})}),(0,s.jsx)(_.DropdownMenuItem,{asChild:!0,className:"cursor-pointer rounded-lg",children:(0,s.jsxs)("a",{href:"/headquarters/transporters",className:"flex items-center gap-2",children:[(0,s.jsx)(v.Truck,{className:"h-4 w-4"}),"Transporters"]})}),(0,s.jsx)(_.DropdownMenuItem,{asChild:!0,className:"cursor-pointer rounded-lg",children:(0,s.jsxs)("a",{href:"/headquarters/purchase-orders",className:"flex items-center gap-2",children:[(0,s.jsx)(N.ClipboardList,{className:"h-4 w-4"}),"Purchase Orders"]})})]})]})]})]}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-white",children:"Organization Summary"}),eh?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsx)(f.Loader2,{className:"h-8 w-8 animate-spin text-white"})}):(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsxs)(L.Card,{className:"rounded-2xl",children:[(0,s.jsx)(L.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(L.CardTitle,{className:"text-sm font-medium text-gray-600",children:"MTD Revenue"}),(0,s.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-blue-100",children:(0,s.jsx)(j.DollarSign,{className:"h-5 w-5 text-blue-600"})})]})}),(0,s.jsxs)(L.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:em(ef)}),(0,s.jsxs)("p",{className:`text-xs mt-1 ${eb>=0?"text-green-600":"text-red-600"}`,children:[eb>=0?"+":"",eb,"% from last month"]})]})]}),(0,s.jsxs)(L.Card,{className:"rounded-2xl",children:[(0,s.jsx)(L.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(L.CardTitle,{className:"text-sm font-medium text-gray-600",children:"MTD Transactions"}),(0,s.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-purple-100",children:(0,s.jsx)(x.ShoppingCart,{className:"h-5 w-5 text-purple-600"})})]})}),(0,s.jsxs)(L.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:ev.toLocaleString()}),(0,s.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"Across all branches"})]})]}),(0,s.jsxs)(L.Card,{className:"rounded-2xl",children:[(0,s.jsx)(L.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(L.CardTitle,{className:"text-sm font-medium text-gray-600",children:"Total Staff"}),(0,s.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-orange-100",children:(0,s.jsx)(h.Users,{className:"h-5 w-5 text-orange-600"})})]})}),(0,s.jsxs)(L.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:ey}),(0,s.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["In ",et.length," branch",1!==et.length?"es":""]})]})]}),(0,s.jsxs)(L.Card,{className:"rounded-2xl",children:[(0,s.jsx)(L.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(L.CardTitle,{className:"text-sm font-medium text-gray-600",children:"Tank Stock (L)"}),(0,s.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-green-100",children:(0,s.jsx)(g.Package,{className:"h-5 w-5 text-green-600"})})]})}),(0,s.jsxs)(L.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:eN.toLocaleString()}),(0,s.jsxs)("div",{className:"flex gap-4 mt-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-amber-500"}),(0,s.jsxs)("span",{className:"text-xs text-gray-600",children:["Diesel: ",(ed?.dieselStock||0).toLocaleString()]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500"}),(0,s.jsxs)("span",{className:"text-xs text-gray-600",children:["Petrol: ",(ed?.petrolStock||0).toLocaleString()]})]})]})]})]})]})]}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-white",children:"Performance Analytics"}),(0,s.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,s.jsxs)(L.Card,{className:"rounded-2xl",children:[(0,s.jsxs)(L.CardHeader,{children:[(0,s.jsx)(L.CardTitle,{children:"Revenue Trend (6 Months)"}),(0,s.jsx)(L.CardDescription,{children:"Monthly revenue across all branches"})]}),(0,s.jsx)(L.CardContent,{className:"px-2",children:(0,s.jsx)("div",{className:"h-[300px] w-full",children:eh?(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsx)(f.Loader2,{className:"h-8 w-8 animate-spin text-gray-400"})}):ed?.monthlyRevenue&&ed.monthlyRevenue.length>0?(0,s.jsx)(P.ResponsiveContainer,{width:"100%",height:"100%",children:(0,s.jsxs)(w.LineChart,{data:ed.monthlyRevenue,children:[(0,s.jsx)(T.CartesianGrid,{strokeDasharray:"3 3"}),(0,s.jsx)(S.XAxis,{dataKey:"month"}),(0,s.jsx)(I.YAxis,{tickFormatter:e=>`${(e/1e6).toFixed(1)}M`}),(0,s.jsx)(D.Tooltip,{formatter:e=>[em(e),"Revenue"]}),(0,s.jsx)(k.Line,{type:"monotone",dataKey:"revenue",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6"}})]})}):(0,s.jsx)("div",{className:"flex items-center justify-center h-full text-gray-400",children:"No revenue data available"})})})]}),(0,s.jsxs)(L.Card,{className:"rounded-2xl",children:[(0,s.jsxs)(L.CardHeader,{children:[(0,s.jsx)(L.CardTitle,{children:"Branch Performance (MTD)"}),(0,s.jsx)(L.CardDescription,{children:"Sales vs Purchases by branch (in thousands)"})]}),(0,s.jsx)(L.CardContent,{className:"px-2",children:(0,s.jsx)("div",{className:"h-[300px] w-full",children:eh?(0,s.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,s.jsx)(f.Loader2,{className:"h-8 w-8 animate-spin text-gray-400"})}):ed?.branchPerformance&&ed.branchPerformance.length>0?(0,s.jsx)(P.ResponsiveContainer,{width:"100%",height:"100%",children:(0,s.jsxs)(b.BarChart,{data:ed.branchPerformance,children:[(0,s.jsx)(T.CartesianGrid,{strokeDasharray:"3 3"}),(0,s.jsx)(S.XAxis,{dataKey:"branch"}),(0,s.jsx)(I.YAxis,{tickFormatter:e=>`${e}K`}),(0,s.jsx)(D.Tooltip,{formatter:e=>[`${e.toFixed(1)}K`,""]}),(0,s.jsx)(B.Legend,{}),(0,s.jsx)(C.Bar,{dataKey:"sales",fill:"#22c55e",name:"Sales"}),(0,s.jsx)(C.Bar,{dataKey:"purchases",fill:"#f97316",name:"Purchases"})]})}):(0,s.jsx)("div",{className:"flex items-center justify-center h-full text-gray-400",children:"No branch performance data available"})})})]})]})]}),ei?(0,s.jsx)("div",{className:"text-center py-12 text-white",children:(0,s.jsx)("p",{children:"Loading branches..."})}):0===et.length?(0,s.jsx)("div",{className:"text-center py-12 text-white",children:(0,s.jsx)("p",{children:"No branches found. Create your first branch to get started."})}):(0,s.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:et.map(a=>(0,s.jsxs)(L.Card,{onClick:()=>{var s;"hq"===(s=a.id)?e.push("/headquarters"):e.push(`/sales?branch=${s}`)},className:"rounded-2xl hover:shadow-xl transition-all duration-300 cursor-pointer overflow-hidden group hover:scale-105",children:[(0,s.jsx)("div",{className:`h-3 bg-gradient-to-r ${a.gradient}`}),(0,s.jsx)(L.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("div",{className:`flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br ${a.gradient} shadow-lg`,children:(0,s.jsx)(d.Building2,{className:"h-6 w-6 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(L.CardTitle,{className:"group-hover:text-blue-600 transition-colors text-base",children:a.name}),(0,s.jsx)(L.CardDescription,{className:"text-xs",children:a.location})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:`rounded-full text-xs px-2 py-1 ${"active"===a.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.status}),(0,s.jsx)(n.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:e=>{e.stopPropagation(),ew(a)},children:(0,s.jsx)(l.Edit,{className:"h-4 w-4"})})]})]})}),(0,s.jsx)(L.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 text-gray-600 text-xs",children:[(0,s.jsx)(g.Package,{className:"h-3 w-3"}),"MTD Revenue"]}),(0,s.jsx)("div",{className:"font-semibold text-sm",children:em(a.monthToDateRevenue)})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 text-gray-600 text-xs",children:[(0,s.jsx)(j.DollarSign,{className:"h-3 w-3"})," ","Current Shift"]}),(0,s.jsx)("div",{className:"font-semibold text-sm",children:em(a.currentShiftRevenue)})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 text-gray-600 text-xs",children:[(0,s.jsx)(o.TrendingUp,{className:"h-3 w-3"}),"Growth"]}),(0,s.jsx)("div",{className:"font-semibold text-sm text-green-600",children:a.performance})]})]})})]},a.id))})]}),(0,s.jsxs)(O.Dialog,{open:A,onOpenChange:q,children:[(0,s.jsx)(O.DialogTrigger,{asChild:!0,children:(0,s.jsxs)(n.Button,{onClick:()=>{ej({name:"",location:"",manager:"",email:"",phone:"",address:"",county:"",localTaxOffice:"",hardwareType:"",serialNumber:"",storageIndices:[],newStorageIndex:"",vendorId:et.find(e=>e.vendor_id)?.vendor_id||"",kraPin:"",controllerId:"",tankConfig:{}}),q(!0)},size:"lg",className:"rounded-xl shadow-lg",children:[(0,s.jsx)(m.Plus,{className:"h-5 w-5 mr-2"}),"Create New Branch"]})}),(0,s.jsxs)(O.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto rounded-2xl",children:[(0,s.jsxs)(O.DialogHeader,{children:[(0,s.jsx)(O.DialogTitle,{className:"text-2xl",children:"Create New Branch"}),(0,s.jsx)(O.DialogDescription,{children:"Fill in the details to create a new branch location with device initialization"})]}),(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Branch Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"branch-name",children:"Branch Name *"}),(0,s.jsx)(M.Input,{id:"branch-name",placeholder:"e.g., Mombasa Branch",value:ep.name,onChange:e=>ej({...ep,name:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"location",children:"Location *"}),(0,s.jsx)(M.Input,{id:"location",placeholder:"e.g., Mombasa, Kenya",value:ep.location,onChange:e=>ej({...ep,location:e.target.value}),className:"rounded-xl"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"address",children:"Physical Address"}),(0,s.jsx)(M.Input,{id:"address",placeholder:"Street address, building, floor",value:ep.address,onChange:e=>ej({...ep,address:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"county",children:"County *"}),(0,s.jsx)(M.Input,{id:"county",placeholder:"e.g., Mombasa",value:ep.county,onChange:e=>ej({...ep,county:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"tax-office",children:"Local Tax Office *"}),(0,s.jsx)(M.Input,{id:"tax-office",placeholder:"e.g., Mombasa Tax Office",value:ep.localTaxOffice,onChange:e=>ej({...ep,localTaxOffice:e.target.value}),className:"rounded-xl"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"vendor-id",children:"Vendor ID (optional - only if auto-detection fails)"}),(0,s.jsx)(M.Input,{id:"vendor-id",placeholder:"e.g., a30077a7-1f46-4292-aa21-a79eb38227f0",value:ep.vendorId,onChange:e=>ej({...ep,vendorId:e.target.value}),className:"rounded-xl font-mono text-sm"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"controller-id",children:"Controller ID (PTS ID)"}),(0,s.jsx)(M.Input,{id:"controller-id",placeholder:"e.g., 003A003A...",value:ep.controllerId,onChange:e=>ej({...ep,controllerId:e.target.value}),className:"rounded-xl font-mono text-sm"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Unique identifier for the pump controller. Used to match pump callbacks to this branch."})]})]}),(0,s.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Staff Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"manager",children:"Branch Manager"}),(0,s.jsx)(M.Input,{id:"manager",placeholder:"Manager name",value:ep.manager,onChange:e=>ej({...ep,manager:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"email",children:"Email"}),(0,s.jsx)(M.Input,{id:"email",type:"email",placeholder:"branch@flow360.com",value:ep.email,onChange:e=>ej({...ep,email:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"phone",children:"Phone Number"}),(0,s.jsx)(M.Input,{id:"phone",type:"tel",placeholder:"+254...",value:ep.phone,onChange:e=>ej({...ep,phone:e.target.value}),className:"rounded-xl"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Hardware Assignment"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"hardware-type",children:"Hardware Type"}),(0,s.jsxs)(F.Select,{value:ep.hardwareType,onValueChange:e=>ej({...ep,hardwareType:e}),children:[(0,s.jsx)(F.SelectTrigger,{className:"rounded-xl",children:(0,s.jsx)(F.SelectValue,{placeholder:"Select hardware type"})}),(0,s.jsxs)(F.SelectContent,{className:"rounded-xl",children:[(0,s.jsx)(F.SelectItem,{value:"Controller",children:"Controller"}),(0,s.jsx)(F.SelectItem,{value:"MiniPC",children:"Mini PC"}),(0,s.jsx)(F.SelectItem,{value:"POS",children:"POS"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"serial-number",children:"Serial Number"}),(0,s.jsx)(M.Input,{id:"serial-number",placeholder:"e.g., SN-12345",value:ep.serialNumber,onChange:e=>ej({...ep,serialNumber:e.target.value}),className:"rounded-xl"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Storage Indices"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Configure unique storage locations for this branch (e.g., Tank, Warehouse, Cold Storage)"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(F.Select,{value:ep.newStorageIndex,onValueChange:e=>ej({...ep,newStorageIndex:e}),children:[(0,s.jsx)(F.SelectTrigger,{className:"rounded-xl",children:(0,s.jsx)(F.SelectValue,{placeholder:"Select storage type"})}),(0,s.jsxs)(F.SelectContent,{children:[(0,s.jsx)(F.SelectItem,{value:"Tank",children:"Tank"}),(0,s.jsx)(F.SelectItem,{value:"Warehouse",children:"Warehouse"}),(0,s.jsx)(F.SelectItem,{value:"Cold Storage",children:"Cold Storage"}),(0,s.jsx)(F.SelectItem,{value:"Dry Storage",children:"Dry Storage"})]})]}),(0,s.jsx)(M.Input,{placeholder:"e.g., Tank 1",value:ep.newStorageIndex&&ep.newStorageIndex.split(" ")[1]||"",onChange:e=>{let a=ep.newStorageIndex&&ep.newStorageIndex.split(" ")[0]||"";ej({...ep,newStorageIndex:`${a} ${e.target.value}`})},className:"rounded-xl"}),(0,s.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>{if(ep.newStorageIndex.trim()){let e=ep.newStorageIndex.trim();e.toLowerCase().includes("tank")?ej({...ep,storageIndices:[...ep.storageIndices,e],tankConfig:{...ep.tankConfig,[e]:{dispensers:[],initialStock:"",fuelType:"Petrol",tankCapacity:""}},newStorageIndex:""}):ej({...ep,storageIndices:[...ep.storageIndices,e],newStorageIndex:""})}},className:"rounded-xl",children:"Add"})]}),ep.storageIndices.length>0&&(0,s.jsx)("div",{className:"space-y-4 mt-4",children:ep.storageIndices.map((e,a)=>(0,s.jsxs)("div",{className:"border rounded-xl p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(t.Badge,{variant:"secondary",className:"rounded-lg",children:e}),(0,s.jsx)("button",{type:"button",onClick:()=>{let s={...ep.tankConfig};delete s[e],ej({...ep,storageIndices:ep.storageIndices.filter((e,s)=>s!==a),tankConfig:s})},className:"text-sm text-destructive hover:underline",children:"Remove"})]}),e.toLowerCase().includes("tank")&&(0,s.jsxs)("div",{className:"space-y-4 bg-muted/50 p-3 rounded-lg",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{children:"Fuel Type"}),(0,s.jsxs)(F.Select,{value:ep.tankConfig[e]?.fuelType||"Petrol",onValueChange:a=>{let s=ep.tankConfig[e]||{dispensers:[],initialStock:"",fuelType:"Petrol",tankCapacity:""};ej({...ep,tankConfig:{...ep.tankConfig,[e]:{...s,fuelType:a}}})},children:[(0,s.jsx)(F.SelectTrigger,{children:(0,s.jsx)(F.SelectValue,{placeholder:"Select fuel type"})}),(0,s.jsxs)(F.SelectContent,{children:[(0,s.jsx)(F.SelectItem,{value:"Petrol",children:"Petrol"}),(0,s.jsx)(F.SelectItem,{value:"Diesel",children:"Diesel"}),(0,s.jsx)(F.SelectItem,{value:"Kerosene",children:"Kerosene"}),(0,s.jsx)(F.SelectItem,{value:"Super",children:"Super"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:`tank-capacity-${a}`,children:"Tank Capacity (Litres) *"}),(0,s.jsx)(M.Input,{id:`tank-capacity-${a}`,type:"number",placeholder:"e.g., 10000",value:ep.tankConfig[e]?.tankCapacity||"",onChange:a=>{let s=ep.tankConfig[e]||{dispensers:[],initialStock:"",fuelType:"Petrol",tankCapacity:""};ej({...ep,tankConfig:{...ep.tankConfig,[e]:{...s,tankCapacity:a.target.value}}})},className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{children:"Dispensers Served by This Tank *"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(M.Input,{placeholder:"e.g., Dispenser 01",id:`new-dispenser-${e}`,className:"rounded-xl"}),(0,s.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>{let a=document.getElementById(`new-dispenser-${e}`),s=a?.value?.trim();if(s){let r=ep.tankConfig[e]||{dispensers:[],initialStock:"",fuelType:"Petrol",tankCapacity:""};ej({...ep,tankConfig:{...ep.tankConfig,[e]:{...r,dispensers:[...r.dispensers||[],s]}}}),a.value=""}},className:"rounded-xl",children:"Add Dispenser"})]}),ep.tankConfig[e]?.dispensers?.length>0&&(0,s.jsx)("div",{className:"space-y-2 mt-2",children:ep.tankConfig[e].dispensers.map((r,n)=>(0,s.jsxs)("div",{className:"flex items-center justify-between bg-background p-2 rounded-lg",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:r}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(M.Input,{type:"number",placeholder:"Initial meter reading",className:"w-48 rounded-lg",id:`meter-${a}-${n}`}),(0,s.jsx)("button",{type:"button",onClick:()=>{let a=ep.tankConfig[e]||{dispensers:[],initialStock:"",fuelType:"Petrol",tankCapacity:""},s=a.dispensers.filter((e,a)=>a!==n);ej({...ep,tankConfig:{...ep.tankConfig,[e]:{...a,dispensers:s}}})},className:"text-xs text-destructive hover:underline",children:"Remove"})]})]},n))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:`tank-stock-${e}`,children:"Initial Stock Position (Litres) *"}),(0,s.jsx)(M.Input,{id:`tank-stock-${e}`,type:"number",placeholder:"e.g., 5000",value:ep.tankConfig[e]?.initialStock||"",onChange:a=>{let s=ep.tankConfig[e]||{dispensers:[],initialStock:"",fuelType:"Petrol",tankCapacity:""};ej({...ep,tankConfig:{...ep.tankConfig,[e]:{...s,initialStock:a.target.value}}})},className:"rounded-xl",required:!0})]})]})]},a))})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>q(!1),className:"rounded-xl",disabled:W,children:"Cancel"}),(0,s.jsx)(n.Button,{onClick:eC,className:"rounded-xl bg-blue-600 hover:bg-blue-700",disabled:!ep.name||!ep.location||!ep.county||!ep.localTaxOffice||W,children:W?"Creating...":"Create Branch"})]})]})]}),(0,s.jsx)(O.Dialog,{open:z,onOpenChange:H,children:(0,s.jsxs)(O.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto rounded-2xl",children:[(0,s.jsxs)(O.DialogHeader,{children:[(0,s.jsx)(O.DialogTitle,{className:"text-2xl",children:"Edit Branch Details"}),(0,s.jsxs)(O.DialogDescription,{children:["Update the information for ",V?.name]})]}),(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"edit-branch-name",children:"Branch Name *"}),(0,s.jsx)(M.Input,{id:"edit-branch-name",placeholder:"e.g., Nairobi Branch",value:ep.name,onChange:e=>ej({...ep,name:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"edit-location",children:"Location *"}),(0,s.jsx)(M.Input,{id:"edit-location",placeholder:"e.g., Nairobi, Kenya",value:ep.location,onChange:e=>ej({...ep,location:e.target.value}),className:"rounded-xl"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"edit-address",children:"Physical Address"}),(0,s.jsx)(M.Input,{id:"edit-address",placeholder:"Street address, building, floor",value:ep.address,onChange:e=>ej({...ep,address:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"edit-county",children:"County *"}),(0,s.jsx)(M.Input,{id:"edit-county",placeholder:"e.g., Nairobi",value:ep.county,onChange:e=>ej({...ep,county:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"edit-local-tax-office",children:"Local Tax Office *"}),(0,s.jsx)(M.Input,{id:"edit-local-tax-office",placeholder:"e.g., Nairobi CBD",value:ep.localTaxOffice,onChange:e=>ej({...ep,localTaxOffice:e.target.value}),className:"rounded-xl"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"edit-manager",children:"Branch Manager"}),(0,s.jsx)(M.Input,{id:"edit-manager",placeholder:"Manager name",value:ep.manager,onChange:e=>ej({...ep,manager:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"edit-email",children:"Email"}),(0,s.jsx)(M.Input,{id:"edit-email",type:"email",placeholder:"branch@flow360.com",value:ep.email,onChange:e=>ej({...ep,email:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"edit-phone",children:"Phone Number"}),(0,s.jsx)(M.Input,{id:"edit-phone",type:"tel",placeholder:"+254...",value:ep.phone,onChange:e=>ej({...ep,phone:e.target.value}),className:"rounded-xl"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"edit-kra-pin",children:"KRA PIN"}),(0,s.jsx)(M.Input,{id:"edit-kra-pin",placeholder:"e.g., P000000000X",value:ep.kraPin,onChange:e=>ej({...ep,kraPin:e.target.value}),className:"rounded-xl"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Required for KRA TIMS integration. Sales will fail without this."})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)($.Label,{htmlFor:"edit-controller-id",children:"Controller ID (PTS ID)"}),(0,s.jsx)(M.Input,{id:"edit-controller-id",placeholder:"e.g., 003A003A...",value:ep.controllerId,onChange:e=>ej({...ep,controllerId:e.target.value}),className:"rounded-xl font-mono text-sm"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Unique identifier for the pump controller. Used to match pump callbacks to this branch."})]})]}),(0,s.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-sm font-medium",children:"Staff Password Reset"}),(0,s.jsx)(n.Button,{variant:"outline",size:"sm",onClick:async()=>{if(!V)return;let e=prompt("Enter the email or username of the staff member:");if(e)try{let a=await fetch(`/api/users?email=${encodeURIComponent(e)}&branch_id=${V.id}`),s=await a.json();if(!s.success||!s.data||0===s.data.length)return void alert("User not found in this branch");let r=s.data[0],n=(0,U.getCurrentUser)(),t=await fetch("/api/auth/reset/issue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:r.id,admin_id:n?.id})}),l=await t.json();l.success?alert(`Reset code for ${l.user.username}: ${l.code}

This code expires in ${l.expires_in_minutes} minutes.

Give this code to the user to reset their password.`):alert(l.error||"Failed to generate reset code")}catch(e){console.error("Error generating reset code:",e),alert("Error generating reset code")}},className:"rounded-xl",children:"Generate Reset Code"})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Generate a password reset code for a staff member in this branch"})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t",children:[(0,s.jsx)(n.Button,{variant:"destructive",onClick:()=>{V&&(eS(V.id,V.name),H(!1))},className:"rounded-xl",children:"Delete Branch"}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>H(!1),className:"rounded-xl",children:"Cancel"}),(0,s.jsx)(n.Button,{onClick:ek,className:"rounded-xl bg-blue-600 hover:bg-blue-700",disabled:!ep.name||!ep.location||!ep.county||!ep.localTaxOffice,children:"Update Branch"})]})]})]})}),(0,s.jsx)(O.Dialog,{open:K,onOpenChange:G,children:(0,s.jsxs)(O.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto rounded-2xl",children:[(0,s.jsxs)(O.DialogHeader,{children:[(0,s.jsx)(O.DialogTitle,{className:"text-2xl",children:"Hardware Inventory"}),(0,s.jsx)(O.DialogDescription,{children:"View all hardware assigned to branches"})]}),(0,s.jsx)("div",{className:"py-4",children:(0,s.jsx)("p",{className:"text-center text-muted-foreground",children:"Hardware inventory data will be displayed here. Navigate to the Inventory page for full details."})})]})}),(0,s.jsx)(O.Dialog,{open:ea,onOpenChange:es,children:(0,s.jsxs)(O.DialogContent,{className:"max-w-2xl rounded-2xl",children:[(0,s.jsxs)(O.DialogHeader,{children:[(0,s.jsx)(O.DialogTitle,{className:"text-2xl",children:"Global Uploads"}),(0,s.jsx)(O.DialogDescription,{children:"Upload meter readings and stock positions for all branches"})]}),(0,s.jsxs)("div",{className:"space-y-6 py-4",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold",children:"File Requirements"}),(0,s.jsxs)("ul",{className:"text-sm text-muted-foreground space-y-1 list-disc list-inside",children:[(0,s.jsx)("li",{children:"Excel or CSV file format"}),(0,s.jsx)("li",{children:"Must include: Branch Name, Dispenser ID, Opening Meter Reading, Closing Meter Reading"}),(0,s.jsx)("li",{children:"Must include: Tank ID, Opening Stock, Closing Stock"}),(0,s.jsx)("li",{children:"One row per dispenser/tank reading"})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)($.Label,{htmlFor:"upload-file",children:"Select File *"}),(0,s.jsx)(M.Input,{id:"upload-file",type:"file",accept:".xlsx,.xls,.csv",onChange:e=>en(e.target.files?.[0]||null),className:"rounded-xl"}),er&&(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Selected: ",er.name]})]}),(0,s.jsxs)("div",{className:"bg-muted/50 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold mb-2",children:"Sample Format"}),(0,s.jsxs)("div",{className:"text-xs font-mono bg-background p-3 rounded-lg overflow-x-auto",children:[(0,s.jsx)("div",{children:"Branch,Dispenser,Opening,Closing,Tank,Opening Stock,Closing Stock"}),(0,s.jsx)("div",{children:"Nairobi,Dispenser 01,1000,1500,Tank 1,5000,4200"}),(0,s.jsx)("div",{children:"Mombasa,Dispenser 02,2000,2300,Tank 2,6000,5800"})]})]})]}),(0,s.jsxs)(O.DialogFooter,{children:[(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>es(!1),className:"rounded-xl",children:"Cancel"}),(0,s.jsxs)(n.Button,{onClick:eg,disabled:!er,className:"rounded-xl",children:[(0,s.jsx)(p.Upload,{className:"mr-2 h-4 w-4"}),"Upload"]})]})]})})]})}e.s(["default",()=>A])}]);