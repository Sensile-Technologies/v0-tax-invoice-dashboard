(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,76009,e=>{"use strict";var a=e.i(47167),s=e.i(43476),l=e.i(22623),n=e.i(67881),r=e.i(94179),t=e.i(88511),i=e.i(98919),c=e.i(95468),o=e.i(7486),d=e.i(25652),h=e.i(61911),x=e.i(1928),m=e.i(7233),u=e.i(64659),g=e.i(88844),p=e.i(69074),j=e.i(12426),f=e.i(3116),N=e.i(78583),v=e.i(71645),b=e.i(70065),y=e.i(30374),C=e.i(23750),w=e.i(10708),S=e.i(63415),k=e.i(62870),T=e.i(18566),I=e.i(40160),D=e.i(31278),B=e.i(53198),O=e.i(46696);function P({open:e,onOpenChange:a}){let[l,r]=(0,v.useState)(!1),[t,i]=(0,v.useState)(null),[c,o]=(0,v.useState)([]);(0,v.useEffect)(()=>{e&&d()},[e]);let d=async()=>{try{let e=await fetch("/api/branches?status=active"),a=await e.json();a.success?o(a.data||[]):(console.error("Error fetching branches:",a.error),O.toast.error("Failed to fetch branches"))}catch(e){console.error("Error fetching branches:",e),O.toast.error("Failed to fetch branches")}},h=async()=>{if(!t)return void O.toast.error("Please select a file to upload");r(!0);try{let e=new FormData;e.append("file",t),e.append("branchId","global");let s=await fetch("/api/shifts/close-excel",{method:"POST",body:e}),l=await s.json();if(!s.ok)throw Error(l.error||"Upload failed");O.toast.success(`Successfully closed shifts for ${l.results?.length||0} branches`),l.errors&&l.errors.length>0&&O.toast.warning(`Some errors occurred: ${l.errors.join(", ")}`),i(null),a(!1)}catch(e){console.error("Upload error:",e),O.toast.error(e instanceof Error?e.message:"Failed to close shifts")}finally{r(!1)}};return(0,s.jsx)(y.Dialog,{open:e,onOpenChange:a,children:(0,s.jsxs)(y.DialogContent,{className:"sm:max-w-[500px]",children:[(0,s.jsx)(y.DialogHeader,{children:(0,s.jsx)(y.DialogTitle,{children:"Global Shift Management - Close All Branch Shifts"})}),(0,s.jsxs)("div",{className:"space-y-6 py-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{children:"Step 1: Download Global Template"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Download the Excel template with separate sheets for each branch. Each sheet contains the branch name in the first row."}),(0,s.jsxs)(n.Button,{onClick:()=>{0===c.length?O.toast.error("No active branches found"):((0,B.generateGlobalShiftCloseTemplate)(c),O.toast.success("Global template downloaded successfully"))},variant:"outline",className:"w-full bg-transparent",disabled:0===c.length,children:[(0,s.jsx)(I.Download,{className:"mr-2 h-4 w-4"}),"Download Global Shift Close Template (",c.length," branches)"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{children:"Step 2: Fill Template & Upload"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Fill in the meter readings and tank volumes for each branch, then upload to close all shifts at once."}),(0,s.jsx)(C.Input,{type:"file",accept:".xlsx,.xls",onChange:e=>{let a=e.target.files?.[0];a&&i(a)},className:"cursor-pointer"}),t&&(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Selected: ",t.name]})]}),(0,s.jsx)(n.Button,{onClick:h,disabled:!t||l,className:"w-full",children:l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Closing All Shifts..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.Upload,{className:"mr-2 h-4 w-4"}),"Upload & Close All Shifts"]})})]})]})})}var M=e.i(33541),F=e.i(69296);function L(){let e=(0,T.useRouter)(),[I,D]=(0,v.useState)(!1),[B,O]=(0,v.useState)(!1),[L,$]=(0,v.useState)(!1),[_,E]=(0,v.useState)(null),[U,z]=(0,v.useState)(!1),[A,H]=(0,v.useState)(!1),[R,q]=(0,v.useState)(null),[G,V]=(0,v.useState)([]),[J,K]=(0,v.useState)(!0),[W,X]=(0,v.useState)(!1),{formatCurrency:Z}=(0,M.useCurrency)();(0,v.useEffect)(()=>{Q()},[]);let Q=async()=>{try{K(!0);let e=(0,F.getCurrentUser)(),a=e?.id,s=a?`/api/branches/list?user_id=${a}`:"/api/branches/list",l=await fetch(s);if(l.ok){let e=(await l.json()).map(e=>({id:e.id,name:e.name,location:e.location,status:e.status.charAt(0).toUpperCase()+e.status.slice(1),revenue:e.monthly_revenue||425e4,monthToDateRevenue:e.mtd_revenue||245e4,currentShiftRevenue:e.current_shift_revenue||145e3,transactions:e.transactions||1245,inventory:e.inventory||342,performance:e.performance||"+12.5%",gradient:"from-blue-600 via-blue-500 to-cyan-400",manager:e.manager,phone:e.phone,email:e.email,bhfId:e.bhf_id,tankConfig:e.tank_config||{},storageIndices:e.storage_indices||[],device_token:e.device_token}));V(e)}else console.error("Failed to fetch branches:",l.status)}catch(e){console.error("Error fetching branches:",e)}finally{K(!1)}},Y=async()=>{if(R)try{let e=new FormData;e.append("file",R),(await fetch("/api/global-uploads",{method:"POST",body:e})).ok?(alert("File uploaded successfully!"),H(!1),q(null)):alert("Failed to upload file")}catch(e){console.error("Upload error:",e),alert("Error uploading file")}},[ee,ea]=(0,v.useState)({name:"",location:"",manager:"",phone:"",email:"",address:"",county:"",localTaxOffice:"",hardwareType:"",serialNumber:"",storageIndices:[],newStorageIndex:"",tankConfig:{}}),es=G.reduce((e,a)=>e+a.revenue,0),el=G.reduce((e,a)=>e+a.transactions,0),en=G.reduce((e,a)=>e+a.inventory,0),er=async()=>{if(!ee.name||!ee.location||!ee.county||!ee.localTaxOffice)return void alert("Please fill in all required fields (Branch Name, Location, County, Local Tax Office)");z(!0);try{let e=await fetch("/api/branches",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:ee.name,location:ee.location,manager:ee.manager,email:ee.email,phone:ee.phone,status:"active",storage_indices:ee.storageIndices,county:ee.county,address:ee.address,local_tax_office:ee.localTaxOffice})}),s=await e.json();if(!s.success){console.error("[v0] Branch creation error:",s.error),alert(`Branch creation failed: ${s.error}`),z(!1);return}console.log("[v0] Branch created:",s.data);let l=s.data,n=new Map,r=[];Object.entries(ee.tankConfig).forEach(([e,a])=>{let s=a.fuelType||"Petrol";r.push({branch_id:l.id,tank_name:e,fuel_type:s,capacity:Number.parseFloat(a.tankCapacity||"0"),current_stock:Number.parseFloat(a.initialStock||"0"),status:"active"}),a.dispensers.forEach(e=>{let a=Number.parseInt(e.replace(/\D/g,""))||n.size+1;n.has(a)||n.set(a,new Set),n.get(a).add(s)})});let t=Array.from(n.entries()).map(([e,a])=>({branch_id:l.id,dispenser_number:e,fuel_type:Array.from(a)[0],status:"active"}));if(r.length>0){for(let e of r)await fetch("/api/tanks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});console.log("[v0] Tanks created:",r)}let i=0;if(t.length>0){console.log("[v0] Creating dispensers:",{dispensersToCreate:t});let e=[];for(let a of t){let s=await fetch("/api/dispensers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),l=await s.json();l.success&&e.push(l.data)}console.log("[v0] Dispensers created:",e);let a=[];if(e.forEach(e=>{let s=n.get(e.dispenser_number);if(s){let n=1;s.forEach(s=>{a.push({branch_id:l.id,dispenser_id:e.id,nozzle_number:n++,fuel_type:s,initial_meter_reading:0,status:"active"})})}}),a.length>0){for(let e of(console.log("[v0] Creating nozzles:",{nozzlesToCreate:a}),a))await fetch("/api/nozzles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});i=a.length}}try{let e=await fetch("/api/branches/register-backend",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branchId:l.id,name:ee.name,location:ee.location,county:ee.county,address:ee.address,organization:a.default.env.NEXT_PUBLIC_ORGANIZATION_ID})}),s=await e.json();e.ok&&s.success?alert(`Branch "${ee.name}" created successfully!
Local database entry created
${r.length} tank(s) created
${t.length} dispenser(s) created
${i} nozzle(s) created
Backend registration completed`):alert(`Branch "${ee.name}" created successfully!
Local database entry created
${r.length} tank(s) created
${t.length} dispenser(s) created
${i} nozzle(s) created
Backend registration failed (can be retried later)`)}catch(e){console.log("[v0] Backend registration failed:",e),alert(`Branch "${ee.name}" created successfully!
Local database entry created
${r.length} tank(s) created
${t.length} dispenser(s) created
${i} nozzle(s) created
Backend registration unavailable (can be retried later)`)}D(!1),ea({name:"",location:"",manager:"",email:"",phone:"",address:"",county:"",localTaxOffice:"",hardwareType:"",serialNumber:"",storageIndices:[],newStorageIndex:"",tankConfig:{}}),await Q()}catch(e){console.error("Error creating branch:",e),alert(`Branch creation failed: ${e.message||"Unknown error"}`)}finally{z(!1)}},et=e=>{console.log("[v0] Opening edit dialog for branch:",e),E(G.find(a=>a.id===e.id)||e),ea({name:e.name||"",location:e.location||"",manager:e.manager||"",email:e.email||"",phone:e.phone||"",address:e.address||"",county:e.county||"",localTaxOffice:e.local_tax_office||"",hardwareType:"",serialNumber:"",storageIndices:e.storage_indices||[],newStorageIndex:"",tankConfig:e.tank_config||{}}),O(!0)},ei=async()=>{if(_){if(console.log("[v0] Updating branch:",_.id,ee),!ee.name||!ee.location||!ee.county||!ee.localTaxOffice)return void alert("Please fill in all required fields (Branch Name, Location, County, Local Tax Office)");try{let e=await fetch(`/api/branches/${_.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:ee.name,location:ee.location,manager:ee.manager,email:ee.email,phone:ee.phone,address:ee.address,county:ee.county,localTaxOffice:ee.localTaxOffice,storageIndices:ee.storageIndices,tankConfig:ee.tankConfig})});if(e.ok)alert("Branch updated successfully!"),O(!1),E(null),await Q();else{let a=await e.json();console.error("Update error:",a),alert(`Failed to update branch: ${a.error||"Unknown error"}`)}}catch(e){console.error("Error updating branch:",e),alert("Error updating branch. Please try again.")}}},ec=async(e,a)=>{if(confirm(`Are you sure you want to delete the branch "${a}"? This action cannot be undone.`))try{let s=await fetch(`/api/branches/${e}`,{method:"DELETE"});if(s.ok)alert(`Branch "${a}" deleted successfully!`),await Q();else{let e=await s.json();console.error("Delete error:",e),alert(`Failed to delete branch: ${e.error||"Unknown error"}`)}}catch(e){console.error("Error deleting branch:",e),alert("Error deleting branch. Please try again.")}};return(0,s.jsxs)("div",{className:"flex h-screen flex-col overflow-hidden bg-gradient-to-b from-slate-900 via-blue-900 to-white",children:[(0,s.jsx)(l.DashboardHeader,{currentBranch:"hq"}),(0,s.jsxs)("main",{className:"flex-1 overflow-y-auto p-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-balance text-white",children:"Headquarters Overview"}),(0,s.jsx)("p",{className:"mt-1 text-white/80 text-pretty",children:"Monitor all branches and organization performance"})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(S.DropdownMenu,{children:[(0,s.jsx)(S.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(n.Button,{variant:"outline",className:"rounded-xl bg-white hover:bg-gray-50",children:[(0,s.jsx)(o.Building2,{className:"mr-2 h-4 w-4"}),"Branches",(0,s.jsx)(u.ChevronDown,{className:"ml-2 h-4 w-4"})]})}),(0,s.jsxs)(S.DropdownMenuContent,{align:"end",className:"w-56 rounded-xl",children:[(0,s.jsxs)(S.DropdownMenuItem,{onSelect:()=>D(!0),className:"cursor-pointer rounded-lg",children:[(0,s.jsx)(m.Plus,{className:"mr-2 h-4 w-4"}),"Create Branch"]}),(0,s.jsxs)(S.DropdownMenuSub,{children:[(0,s.jsxs)(S.DropdownMenuSubTrigger,{className:"cursor-pointer rounded-lg",children:[(0,s.jsx)(t.Edit,{className:"mr-2 h-4 w-4"}),"Edit Branch Details"]}),(0,s.jsx)(S.DropdownMenuSubContent,{className:"rounded-xl",children:G.map(e=>(0,s.jsx)(S.DropdownMenuItem,{onSelect:()=>et(e),className:"cursor-pointer rounded-lg",children:e.name},e.id))})]}),(0,s.jsxs)(S.DropdownMenuItem,{onSelect:()=>e.push("/headquarters/inventory"),className:"cursor-pointer rounded-lg",children:[(0,s.jsx)(g.Package,{className:"mr-2 h-4 w-4"}),"Inventory"]}),(0,s.jsxs)(S.DropdownMenuItem,{onSelect:()=>H(!0),className:"cursor-pointer rounded-lg",children:[(0,s.jsx)(p.Upload,{className:"mr-2 h-4 w-4"}),"Global Uploads"]})]})]}),(0,s.jsxs)(S.DropdownMenu,{children:[(0,s.jsx)(S.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(n.Button,{variant:"outline",className:"gap-2 rounded-xl bg-white hover:bg-gray-50",children:[(0,s.jsx)(h.Users,{className:"h-4 w-4"}),"Users",(0,s.jsx)(u.ChevronDown,{className:"h-4 w-4"})]})}),(0,s.jsxs)(S.DropdownMenuContent,{align:"end",className:"w-56 rounded-xl",children:[(0,s.jsx)(S.DropdownMenuItem,{asChild:!0,className:"cursor-pointer rounded-lg",children:(0,s.jsxs)("a",{href:"/headquarters/staff-management",className:"flex items-center gap-2",children:[(0,s.jsx)(h.Users,{className:"h-4 w-4"}),"Staff Management"]})}),(0,s.jsx)(S.DropdownMenuItem,{asChild:!0,className:"cursor-pointer rounded-lg",children:(0,s.jsxs)("a",{href:"/headquarters/roles",className:"flex items-center gap-2",children:[(0,s.jsx)(i.Shield,{className:"h-4 w-4"}),"Roles & Permissions"]})}),(0,s.jsx)(S.DropdownMenuItem,{asChild:!0,className:"cursor-pointer rounded-lg",children:(0,s.jsxs)("a",{href:"/headquarters/approvals",className:"flex items-center gap-2",children:[(0,s.jsx)(c.CheckCircle2,{className:"h-4 w-4"}),"Approval Workflows"]})})]})]}),(0,s.jsxs)(S.DropdownMenu,{children:[(0,s.jsx)(S.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(n.Button,{variant:"outline",className:"rounded-xl bg-white hover:bg-gray-50",children:[(0,s.jsx)(f.Clock,{className:"mr-2 h-4 w-4"}),"Shift Management",(0,s.jsx)(u.ChevronDown,{className:"ml-2 h-4 w-4"})]})}),(0,s.jsxs)(S.DropdownMenuContent,{align:"end",className:"w-56 rounded-xl",children:[(0,s.jsxs)(S.DropdownMenuItem,{onSelect:()=>X(!0),className:"cursor-pointer rounded-lg",children:[(0,s.jsx)(p.Upload,{className:"mr-2 h-4 w-4"}),"Global Shift Upload"]}),(0,s.jsx)(S.DropdownMenuItem,{asChild:!0,className:"cursor-pointer rounded-lg",children:(0,s.jsxs)("a",{href:"/reports/shifts",children:[(0,s.jsx)(N.FileText,{className:"mr-2 h-4 w-4"}),"View Shift Reports"]})})]})]})]})]}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-white",children:"Organization Summary"}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsxs)(b.Card,{className:"rounded-2xl",children:[(0,s.jsx)(b.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(b.CardTitle,{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),(0,s.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-blue-100",children:(0,s.jsx)(g.Package,{className:"h-5 w-5 text-blue-600"})})]})}),(0,s.jsxs)(b.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:Z(es)}),(0,s.jsx)("p",{className:"text-xs text-green-600 mt-1",children:"+10.8% from last month"})]})]}),(0,s.jsxs)(b.Card,{className:"rounded-2xl",children:[(0,s.jsx)(b.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(b.CardTitle,{className:"text-sm font-medium text-gray-600",children:"Transactions"}),(0,s.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-purple-100",children:(0,s.jsx)(x.ShoppingCart,{className:"h-5 w-5 text-purple-600"})})]})}),(0,s.jsxs)(b.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:el.toLocaleString()}),(0,s.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"Across all branches"})]})]}),(0,s.jsxs)(b.Card,{className:"rounded-2xl",children:[(0,s.jsx)(b.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(b.CardTitle,{className:"text-sm font-medium text-gray-600",children:"Total Employees"}),(0,s.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-orange-100",children:(0,s.jsx)(h.Users,{className:"h-5 w-5 text-orange-600"})})]})}),(0,s.jsxs)(b.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:G.length}),(0,s.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["In ",G.length," branches"]})]})]}),(0,s.jsxs)(b.Card,{className:"rounded-2xl",children:[(0,s.jsx)(b.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(b.CardTitle,{className:"text-sm font-medium text-gray-600",children:"Inventory Items"}),(0,s.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-green-100",children:(0,s.jsx)(g.Package,{className:"h-5 w-5 text-green-600"})})]})}),(0,s.jsxs)(b.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:en}),(0,s.jsx)("p",{className:"text-xs text-green-600 mt-1",children:"+7.3% stock increase"})]})]})]})]}),(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-white",children:"Performance Analytics"}),(0,s.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,s.jsxs)(b.Card,{className:"rounded-2xl",children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Organization Revenue Trend"}),(0,s.jsx)(b.CardDescription,{children:"Monthly revenue across all branches"})]}),(0,s.jsx)(b.CardContent,{className:"px-2",children:(0,s.jsx)("div",{className:"h-[300px] w-full",children:(0,s.jsx)("div",{className:"h-full w-full"})})})]}),(0,s.jsxs)(b.Card,{className:"rounded-2xl",children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Branch Performance Comparison"}),(0,s.jsx)(b.CardDescription,{children:"Sales vs Purchases by branch"})]}),(0,s.jsx)(b.CardContent,{className:"px-2",children:(0,s.jsx)("div",{className:"h-[300px] w-full",children:(0,s.jsx)("div",{className:"h-full w-full"})})})]})]})]}),J?(0,s.jsx)("div",{className:"text-center py-12 text-white",children:(0,s.jsx)("p",{children:"Loading branches..."})}):0===G.length?(0,s.jsx)("div",{className:"text-center py-12 text-white",children:(0,s.jsx)("p",{children:"No branches found. Create your first branch to get started."})}):(0,s.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:G.map(a=>(0,s.jsxs)(b.Card,{onClick:()=>{var s;"hq"===(s=a.id)?e.push("/headquarters"):e.push(`/sales?branch=${s}`)},className:"rounded-2xl hover:shadow-xl transition-all duration-300 cursor-pointer overflow-hidden group hover:scale-105",children:[(0,s.jsx)("div",{className:`h-3 bg-gradient-to-r ${a.gradient}`}),(0,s.jsx)(b.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("div",{className:`flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br ${a.gradient} shadow-lg`,children:(0,s.jsx)(o.Building2,{className:"h-6 w-6 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(b.CardTitle,{className:"group-hover:text-blue-600 transition-colors text-base",children:a.name}),(0,s.jsx)(b.CardDescription,{className:"text-xs",children:a.location})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:`rounded-full text-xs px-2 py-1 ${"active"===a.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.status}),(0,s.jsx)(n.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:e=>{e.stopPropagation(),et(a)},children:(0,s.jsx)(t.Edit,{className:"h-4 w-4"})})]})]})}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 text-gray-600 text-xs",children:[(0,s.jsx)(g.Package,{className:"h-3 w-3"}),"MTD Revenue"]}),(0,s.jsx)("div",{className:"font-semibold text-sm",children:Z(a.monthToDateRevenue)})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 text-gray-600 text-xs",children:[(0,s.jsx)(j.DollarSign,{className:"h-3 w-3"})," ","Current Shift"]}),(0,s.jsx)("div",{className:"font-semibold text-sm",children:Z(a.currentShiftRevenue)})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 text-gray-600 text-xs",children:[(0,s.jsx)(d.TrendingUp,{className:"h-3 w-3"}),"Growth"]}),(0,s.jsx)("div",{className:"font-semibold text-sm text-green-600",children:a.performance})]})]})})]},a.id))})]}),(0,s.jsxs)(y.Dialog,{open:I,onOpenChange:D,children:[(0,s.jsx)(y.DialogTrigger,{asChild:!0,children:(0,s.jsxs)(n.Button,{onClick:()=>{ea({name:"",location:"",manager:"",email:"",phone:"",address:"",county:"",localTaxOffice:"",hardwareType:"",serialNumber:"",storageIndices:[],newStorageIndex:"",tankConfig:{}}),D(!0)},size:"lg",className:"rounded-xl shadow-lg",children:[(0,s.jsx)(m.Plus,{className:"h-5 w-5 mr-2"}),"Create New Branch"]})}),(0,s.jsxs)(y.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto rounded-2xl",children:[(0,s.jsxs)(y.DialogHeader,{children:[(0,s.jsx)(y.DialogTitle,{className:"text-2xl",children:"Create New Branch"}),(0,s.jsx)(y.DialogDescription,{children:"Fill in the details to create a new branch location with device initialization"})]}),(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Branch Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"branch-name",children:"Branch Name *"}),(0,s.jsx)(C.Input,{id:"branch-name",placeholder:"e.g., Mombasa Branch",value:ee.name,onChange:e=>ea({...ee,name:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"location",children:"Location *"}),(0,s.jsx)(C.Input,{id:"location",placeholder:"e.g., Mombasa, Kenya",value:ee.location,onChange:e=>ea({...ee,location:e.target.value}),className:"rounded-xl"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"address",children:"Physical Address"}),(0,s.jsx)(C.Input,{id:"address",placeholder:"Street address, building, floor",value:ee.address,onChange:e=>ea({...ee,address:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"county",children:"County *"}),(0,s.jsx)(C.Input,{id:"county",placeholder:"e.g., Mombasa",value:ee.county,onChange:e=>ea({...ee,county:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"tax-office",children:"Local Tax Office *"}),(0,s.jsx)(C.Input,{id:"tax-office",placeholder:"e.g., Mombasa Tax Office",value:ee.localTaxOffice,onChange:e=>ea({...ee,localTaxOffice:e.target.value}),className:"rounded-xl"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Staff Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"manager",children:"Branch Manager"}),(0,s.jsx)(C.Input,{id:"manager",placeholder:"Manager name",value:ee.manager,onChange:e=>ea({...ee,manager:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"email",children:"Email"}),(0,s.jsx)(C.Input,{id:"email",type:"email",placeholder:"branch@flow360.com",value:ee.email,onChange:e=>ea({...ee,email:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"phone",children:"Phone Number"}),(0,s.jsx)(C.Input,{id:"phone",type:"tel",placeholder:"+254...",value:ee.phone,onChange:e=>ea({...ee,phone:e.target.value}),className:"rounded-xl"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Hardware Assignment"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"hardware-type",children:"Hardware Type"}),(0,s.jsxs)(k.Select,{value:ee.hardwareType,onValueChange:e=>ea({...ee,hardwareType:e}),children:[(0,s.jsx)(k.SelectTrigger,{className:"rounded-xl",children:(0,s.jsx)(k.SelectValue,{placeholder:"Select hardware type"})}),(0,s.jsxs)(k.SelectContent,{className:"rounded-xl",children:[(0,s.jsx)(k.SelectItem,{value:"Controller",children:"Controller"}),(0,s.jsx)(k.SelectItem,{value:"MiniPC",children:"Mini PC"}),(0,s.jsx)(k.SelectItem,{value:"POS",children:"POS"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"serial-number",children:"Serial Number"}),(0,s.jsx)(C.Input,{id:"serial-number",placeholder:"e.g., SN-12345",value:ee.serialNumber,onChange:e=>ea({...ee,serialNumber:e.target.value}),className:"rounded-xl"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Storage Indices"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Configure unique storage locations for this branch (e.g., Tank, Warehouse, Cold Storage)"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(k.Select,{value:ee.newStorageIndex,onValueChange:e=>ea({...ee,newStorageIndex:e}),children:[(0,s.jsx)(k.SelectTrigger,{className:"rounded-xl",children:(0,s.jsx)(k.SelectValue,{placeholder:"Select storage type"})}),(0,s.jsxs)(k.SelectContent,{children:[(0,s.jsx)(k.SelectItem,{value:"Tank",children:"Tank"}),(0,s.jsx)(k.SelectItem,{value:"Warehouse",children:"Warehouse"}),(0,s.jsx)(k.SelectItem,{value:"Cold Storage",children:"Cold Storage"}),(0,s.jsx)(k.SelectItem,{value:"Dry Storage",children:"Dry Storage"})]})]}),(0,s.jsx)(C.Input,{placeholder:"e.g., Tank 1",value:ee.newStorageIndex&&ee.newStorageIndex.split(" ")[1]||"",onChange:e=>{let a=ee.newStorageIndex&&ee.newStorageIndex.split(" ")[0]||"";ea({...ee,newStorageIndex:`${a} ${e.target.value}`})},className:"rounded-xl"}),(0,s.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>{if(ee.newStorageIndex.trim()){let e=ee.newStorageIndex.trim();e.toLowerCase().includes("tank")?ea({...ee,storageIndices:[...ee.storageIndices,e],tankConfig:{...ee.tankConfig,[e]:{dispensers:[],initialStock:"",fuelType:"Petrol",tankCapacity:""}},newStorageIndex:""}):ea({...ee,storageIndices:[...ee.storageIndices,e],newStorageIndex:""})}},className:"rounded-xl",children:"Add"})]}),ee.storageIndices.length>0&&(0,s.jsx)("div",{className:"space-y-4 mt-4",children:ee.storageIndices.map((e,a)=>(0,s.jsxs)("div",{className:"border rounded-xl p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(r.Badge,{variant:"secondary",className:"rounded-lg",children:e}),(0,s.jsx)("button",{type:"button",onClick:()=>{let s={...ee.tankConfig};delete s[e],ea({...ee,storageIndices:ee.storageIndices.filter((e,s)=>s!==a),tankConfig:s})},className:"text-sm text-destructive hover:underline",children:"Remove"})]}),e.toLowerCase().includes("tank")&&(0,s.jsxs)("div",{className:"space-y-4 bg-muted/50 p-3 rounded-lg",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{children:"Fuel Type"}),(0,s.jsxs)(k.Select,{value:ee.tankConfig[e]?.fuelType||"Petrol",onValueChange:a=>{let s=ee.tankConfig[e]||{dispensers:[],initialStock:"",fuelType:"Petrol",tankCapacity:""};ea({...ee,tankConfig:{...ee.tankConfig,[e]:{...s,fuelType:a}}})},children:[(0,s.jsx)(k.SelectTrigger,{children:(0,s.jsx)(k.SelectValue,{placeholder:"Select fuel type"})}),(0,s.jsxs)(k.SelectContent,{children:[(0,s.jsx)(k.SelectItem,{value:"Petrol",children:"Petrol"}),(0,s.jsx)(k.SelectItem,{value:"Diesel",children:"Diesel"}),(0,s.jsx)(k.SelectItem,{value:"Kerosene",children:"Kerosene"}),(0,s.jsx)(k.SelectItem,{value:"Super",children:"Super"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:`tank-capacity-${a}`,children:"Tank Capacity (Litres) *"}),(0,s.jsx)(C.Input,{id:`tank-capacity-${a}`,type:"number",placeholder:"e.g., 10000",value:ee.tankConfig[e]?.tankCapacity||"",onChange:a=>{let s=ee.tankConfig[e]||{dispensers:[],initialStock:"",fuelType:"Petrol",tankCapacity:""};ea({...ee,tankConfig:{...ee.tankConfig,[e]:{...s,tankCapacity:a.target.value}}})},className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{children:"Dispensers Served by This Tank *"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(C.Input,{placeholder:"e.g., Dispenser 01",id:`new-dispenser-${e}`,className:"rounded-xl"}),(0,s.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>{let a=document.getElementById(`new-dispenser-${e}`),s=a?.value?.trim();if(s){let l=ee.tankConfig[e]||{dispensers:[],initialStock:"",fuelType:"Petrol",tankCapacity:""};ea({...ee,tankConfig:{...ee.tankConfig,[e]:{...l,dispensers:[...l.dispensers||[],s]}}}),a.value=""}},className:"rounded-xl",children:"Add Dispenser"})]}),ee.tankConfig[e]?.dispensers?.length>0&&(0,s.jsx)("div",{className:"space-y-2 mt-2",children:ee.tankConfig[e].dispensers.map((l,n)=>(0,s.jsxs)("div",{className:"flex items-center justify-between bg-background p-2 rounded-lg",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:l}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(C.Input,{type:"number",placeholder:"Initial meter reading",className:"w-48 rounded-lg",id:`meter-${a}-${n}`}),(0,s.jsx)("button",{type:"button",onClick:()=>{let a=ee.tankConfig[e]||{dispensers:[],initialStock:"",fuelType:"Petrol",tankCapacity:""},s=a.dispensers.filter((e,a)=>a!==n);ea({...ee,tankConfig:{...ee.tankConfig,[e]:{...a,dispensers:s}}})},className:"text-xs text-destructive hover:underline",children:"Remove"})]})]},n))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:`tank-stock-${e}`,children:"Initial Stock Position (Litres) *"}),(0,s.jsx)(C.Input,{id:`tank-stock-${e}`,type:"number",placeholder:"e.g., 5000",value:ee.tankConfig[e]?.initialStock||"",onChange:a=>{let s=ee.tankConfig[e]||{dispensers:[],initialStock:"",fuelType:"Petrol",tankCapacity:""};ea({...ee,tankConfig:{...ee.tankConfig,[e]:{...s,initialStock:a.target.value}}})},className:"rounded-xl",required:!0})]})]})]},a))})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>D(!1),className:"rounded-xl",disabled:U,children:"Cancel"}),(0,s.jsx)(n.Button,{onClick:er,className:"rounded-xl bg-blue-600 hover:bg-blue-700",disabled:!ee.name||!ee.location||!ee.county||!ee.localTaxOffice||U,children:U?"Creating...":"Create Branch"})]})]})]}),(0,s.jsx)(y.Dialog,{open:B,onOpenChange:O,children:(0,s.jsxs)(y.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto rounded-2xl",children:[(0,s.jsxs)(y.DialogHeader,{children:[(0,s.jsx)(y.DialogTitle,{className:"text-2xl",children:"Edit Branch Details"}),(0,s.jsxs)(y.DialogDescription,{children:["Update the information for ",_?.name]})]}),(0,s.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"edit-branch-name",children:"Branch Name *"}),(0,s.jsx)(C.Input,{id:"edit-branch-name",placeholder:"e.g., Nairobi Branch",value:ee.name,onChange:e=>ea({...ee,name:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"edit-location",children:"Location *"}),(0,s.jsx)(C.Input,{id:"edit-location",placeholder:"e.g., Nairobi, Kenya",value:ee.location,onChange:e=>ea({...ee,location:e.target.value}),className:"rounded-xl"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"edit-address",children:"Physical Address"}),(0,s.jsx)(C.Input,{id:"edit-address",placeholder:"Street address, building, floor",value:ee.address,onChange:e=>ea({...ee,address:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"edit-manager",children:"Branch Manager"}),(0,s.jsx)(C.Input,{id:"edit-manager",placeholder:"Manager name",value:ee.manager,onChange:e=>ea({...ee,manager:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"edit-email",children:"Email"}),(0,s.jsx)(C.Input,{id:"edit-email",type:"email",placeholder:"branch@flow360.com",value:ee.email,onChange:e=>ea({...ee,email:e.target.value}),className:"rounded-xl"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(w.Label,{htmlFor:"edit-phone",children:"Phone Number"}),(0,s.jsx)(C.Input,{id:"edit-phone",type:"tel",placeholder:"+254...",value:ee.phone,onChange:e=>ea({...ee,phone:e.target.value}),className:"rounded-xl"})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center pt-4 border-t",children:[(0,s.jsx)(n.Button,{variant:"destructive",onClick:()=>{_&&(ec(_.id,_.name),O(!1))},className:"rounded-xl",children:"Delete Branch"}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>O(!1),className:"rounded-xl",children:"Cancel"}),(0,s.jsx)(n.Button,{onClick:ei,className:"rounded-xl bg-blue-600 hover:bg-blue-700",disabled:!ee.name||!ee.location||!ee.county||!ee.localTaxOffice,children:"Update Branch"})]})]})]})}),(0,s.jsx)(y.Dialog,{open:L,onOpenChange:$,children:(0,s.jsxs)(y.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto rounded-2xl",children:[(0,s.jsxs)(y.DialogHeader,{children:[(0,s.jsx)(y.DialogTitle,{className:"text-2xl",children:"Hardware Inventory"}),(0,s.jsx)(y.DialogDescription,{children:"View all hardware assigned to branches"})]}),(0,s.jsx)("div",{className:"py-4",children:(0,s.jsx)("p",{className:"text-center text-muted-foreground",children:"Hardware inventory data will be displayed here. Navigate to the Inventory page for full details."})})]})}),(0,s.jsx)(y.Dialog,{open:A,onOpenChange:H,children:(0,s.jsxs)(y.DialogContent,{className:"max-w-2xl rounded-2xl",children:[(0,s.jsxs)(y.DialogHeader,{children:[(0,s.jsx)(y.DialogTitle,{className:"text-2xl",children:"Global Uploads"}),(0,s.jsx)(y.DialogDescription,{children:"Upload meter readings and stock positions for all branches"})]}),(0,s.jsxs)("div",{className:"space-y-6 py-4",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold",children:"File Requirements"}),(0,s.jsxs)("ul",{className:"text-sm text-muted-foreground space-y-1 list-disc list-inside",children:[(0,s.jsx)("li",{children:"Excel or CSV file format"}),(0,s.jsx)("li",{children:"Must include: Branch Name, Dispenser ID, Opening Meter Reading, Closing Meter Reading"}),(0,s.jsx)("li",{children:"Must include: Tank ID, Opening Stock, Closing Stock"}),(0,s.jsx)("li",{children:"One row per dispenser/tank reading"})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(w.Label,{htmlFor:"upload-file",children:"Select File *"}),(0,s.jsx)(C.Input,{id:"upload-file",type:"file",accept:".xlsx,.xls,.csv",onChange:e=>q(e.target.files?.[0]||null),className:"rounded-xl"}),R&&(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Selected: ",R.name]})]}),(0,s.jsxs)("div",{className:"bg-muted/50 p-4 rounded-xl",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold mb-2",children:"Sample Format"}),(0,s.jsxs)("div",{className:"text-xs font-mono bg-background p-3 rounded-lg overflow-x-auto",children:[(0,s.jsx)("div",{children:"Branch,Dispenser,Opening,Closing,Tank,Opening Stock,Closing Stock"}),(0,s.jsx)("div",{children:"Nairobi,Dispenser 01,1000,1500,Tank 1,5000,4200"}),(0,s.jsx)("div",{children:"Mombasa,Dispenser 02,2000,2300,Tank 2,6000,5800"})]})]})]}),(0,s.jsxs)(y.DialogFooter,{children:[(0,s.jsx)(n.Button,{variant:"outline",onClick:()=>H(!1),className:"rounded-xl",children:"Cancel"}),(0,s.jsxs)(n.Button,{onClick:Y,disabled:!R,className:"rounded-xl",children:[(0,s.jsx)(p.Upload,{className:"mr-2 h-4 w-4"}),"Upload"]})]})]})}),(0,s.jsx)(P,{open:W,onOpenChange:X})]})}e.s(["default",()=>L],76009)}]);