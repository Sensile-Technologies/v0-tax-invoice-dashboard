(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,20800,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(32219),r=e.i(22623),o=e.i(67881),n=e.i(70065),i=e.i(23750),l=e.i(10708),d=e.i(47627),c=e.i(25652),f=e.i(75254);let u=(0,f.default)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);var m=e.i(55436);e.i(99602),(0,f.default)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),(0,f.default)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);var x=e.i(22858),h=e.i(78583),y=e.i(16715),p=e.i(33541),g=e.i(62870),b=e.i(30374);let _=(0,f.default)("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);var j=e.i(7233),v=e.i(88511),T=e.i(88844),k=e.i(94179);e.i(7670),!function(e){if(!e||"undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",t.firstChild?t.insertBefore(a,t.firstChild):t.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var N=e=>"number"==typeof e&&!isNaN(e);function w({enter:e,exit:t,appendPosition:s=!1,collapse:r=!0,collapseDuration:o=300}){return function({children:n,position:i,preventExitTransition:l,done:d,nodeRef:c,isIn:f,playToast:u}){let m=s?`${e}--${i}`:e,x=s?`${t}--${i}`:t,h=(0,a.useRef)(0);return(0,a.useLayoutEffect)(()=>{let e=c.current,t=m.split(" "),a=s=>{s.target===c.current&&(u(),e.removeEventListener("animationend",a),e.removeEventListener("animationcancel",a),0===h.current&&"animationcancel"!==s.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",a),e.addEventListener("animationcancel",a)},[]),(0,a.useEffect)(()=>{let e=c.current,t=()=>{e.removeEventListener("animationend",t),r?function(e,t,a=300){let{scrollHeight:s,style:r}=e;requestAnimationFrame(()=>{r.minHeight="initial",r.height=s+"px",r.transition=`all ${a}ms`,requestAnimationFrame(()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(t,a)})})}(e,d,o):d()};f||(l?t():(h.current=1,e.className+=` ${x}`,e.addEventListener("animationend",t)))},[f]),a.default.createElement(a.default.Fragment,null,n)}}var C=1,S=()=>`${C++}`,I=new Map,L=[],B=new Set;function D(e,t){I.forEach(a=>{null!=t&&null!=t&&t.containerId&&(null==t?void 0:t.containerId)!==a.id||a.toggle(e,null==t?void 0:t.id)})}function R(e,t){let s;return s=e,((0,a.isValidElement)(s)||"string"==typeof s||"function"==typeof s||N(s))&&(I.size>0||L.push({content:e,options:t}),I.forEach(a=>{a.buildToast(e,t)})),t.toastId}function O(e,t){var a;return{...t,type:t&&t.type||e,toastId:(a=t)&&("string"==typeof a.toastId||N(a.toastId))?a.toastId:S()}}function H(e){return(t,a)=>R(t,O(e,a))}function q(e,t){return R(e,O("default",t))}q.loading=(e,t)=>R(e,O("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),q.promise=function(e,{pending:t,error:a,success:s},r){let o;t&&(o="string"==typeof t?q.loading(t,r):q.loading(t.render,{...r,...t}));let n={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},i=(e,t,a)=>{if(null==t)return void q.dismiss(o);let s={type:e,...n,...r,data:a},i="string"==typeof t?{render:t}:t;return o?q.update(o,{...s,...i}):q(i.render,{...s,...i}),a},l="function"==typeof e?e():e;return l.then(e=>i("success",s,e)).catch(e=>i("error",a,e)),l},q.success=H("success"),q.info=H("info"),q.error=H("error"),q.warning=H("warning"),q.warn=q.warning,q.dark=(e,t)=>R(e,O("default",{theme:"dark",...t})),q.dismiss=function(e){!function(e){let t;if(!(I.size>0)){L=L.filter(t=>null!=e&&t.options.toastId!==e);return}if(null==e||"string"==typeof(t=e)||N(t))I.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=I.get(e.containerId);t?t.removeToast(e.id):I.forEach(t=>{t.removeToast(e.id)})}}(e)},q.clearWaitingQueue=(e={})=>{I.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})},q.isActive=function(e,t){var a;if(t)return!!(null!=(a=I.get(t))&&a.isToastActive(e));let s=!1;return I.forEach(t=>{t.isToastActive(e)&&(s=!0)}),s},q.update=(e,t={})=>{let a=((e,{containerId:t})=>{var a;return null==(a=I.get(t||1))?void 0:a.toasts.get(e)})(e,t);if(a){let{props:s,content:r}=a,o={delay:100,...s,...t,toastId:t.toastId||e,updateId:S()};o.toastId!==e&&(o.staleId=e);let n=o.render||r;delete o.render,R(n,o)}},q.done=e=>{q.update(e,{progress:1})},q.onChange=function(e){return B.add(e),()=>{B.delete(e)}},q.play=e=>D(!0,e),q.pause=e=>D(!1,e),"undefined"!=typeof window?a.useLayoutEffect:a.useEffect;var E=(e,t=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t});function z({branchId:e}){let[s,r]=(0,a.useState)([]),[d,c]=(0,a.useState)([]),[f,u]=(0,a.useState)(!0),[m,h]=(0,a.useState)(!1),[y,p]=(0,a.useState)(!1),[N,w]=(0,a.useState)(!1),[C,S]=(0,a.useState)(!1),[I,L]=(0,a.useState)(!1),[B,D]=(0,a.useState)(null),[R,O]=(0,a.useState)(null),[H,E]=(0,a.useState)({quantity:"",reason:"",requestedBy:""}),[z,A]=(0,a.useState)({quantity:"",reason:"",requestedBy:""}),[F,P]=(0,a.useState)({toTankId:"",toBranchId:e,quantity:"",notes:"",requestedBy:""}),[$,M]=(0,a.useState)({tankName:"",fuelType:"Petrol",capacity:"",initialStock:""}),[U,V]=(0,a.useState)({dispenserNumber:""});(0,a.useEffect)(()=>{e&&(K(),X())},[e]);let K=async()=>{u(!0);try{let t=await fetch(`/api/tanks?branch_id=${e}`),a=await t.json();if(!a.success){console.error("Error fetching tanks:",a.error),u(!1);return}let[s,o]=await Promise.all([fetch(`/api/dispensers?branch_id=${e}`),fetch(`/api/nozzles?branch_id=${e}`)]),n=await s.json(),i=await o.json(),l=n.success?n.data:[],d=i.success?i.data:[],c=(a.data||[]).map(e=>({...e,dispensers:l,nozzles:d.filter(t=>t.fuel_type===e.fuel_type)}));r(c)}catch(e){console.error("Error fetching tanks:",e)}finally{u(!1)}},X=async()=>{try{let e=await fetch("/api/branches"),t=await e.json();t.success&&c(t.data||[])}catch(e){console.error("Error fetching branches:",e)}},J=async()=>{if(!B)return;let t=Number.parseFloat(H.quantity);try{let a=await fetch("/api/stock/adjust",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tank_id:B.id,branch_id:e,adjustment_type:t>=0?"increase":"decrease",quantity:Math.abs(t),reason:H.reason,approved_by:H.requestedBy,sync_to_kra:!0})}),s=await a.json();a.ok&&s.success?(q.success(`Stock adjusted: ${s.data.previousStock} -> ${s.data.newStock} litres`),s.kraSync?.synced&&q.info("Stock synced to KRA")):q.error(s.error||"Error adjusting stock"),h(!1),E({quantity:"",reason:"",requestedBy:""}),K()}catch(e){console.error("Error adjusting stock:",e),q.error("Error adjusting stock")}},Q=async()=>{if(!B)return;let t=Number.parseFloat(z.quantity);try{let a=await fetch("/api/stock/receive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch_id:e,tank_id:B.id,quantity:t,unit_price:0,supplier_name:z.requestedBy||"Unknown",notes:z.reason,sync_to_kra:!0})}),s=await a.json();a.ok&&s.success?(q.success(`Received ${t} litres. New stock: ${s.data.newStock}`),s.kraSync?.synced&&q.info("Stock synced to KRA")):q.error(s.error||"Error receiving stock"),p(!1),A({quantity:"",reason:"",requestedBy:""}),K()}catch(e){console.error("Error receiving stock:",e),q.error("Error receiving stock")}},Y=async()=>{if(!B)return;let t=Number.parseFloat(F.quantity);try{if(!(await fetch("/api/stock-transfers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({from_tank_id:B.id,to_tank_id:F.toTankId,from_branch_id:e,to_branch_id:F.toBranchId,quantity:t,requested_by:F.requestedBy,notes:F.notes,approval_status:"pending"})})).ok)return void console.error("Error creating transfer");w(!1),P({toTankId:"",toBranchId:e,quantity:"",notes:"",requestedBy:""}),K()}catch(e){console.error("Error creating transfer:",e)}},G=async()=>{if(e)try{(await fetch("/api/tanks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch_id:e,tank_name:$.tankName,fuel_type:$.fuelType,capacity:Number.parseFloat($.capacity),current_stock:Number.parseFloat($.initialStock||"0"),status:"active"})})).ok?(q.success(`Tank ${$.tankName} added successfully`),S(!1),M({tankName:"",fuelType:"Petrol",capacity:"",initialStock:""}),K()):(console.error("Error adding tank"),q.error("Failed to add tank"))}catch(e){console.error("Error adding tank:",e),q.error("Failed to add tank")}},W=async()=>{if(R)try{let t=await fetch(`/api/dispensers?branch_id=${e}`),a=await t.json(),r=((a.success?a.data:[])||[]).map(e=>Number(e.dispenser_number)||0),o=(r.length>0?Math.max(...r):0)+1,n=s.find(e=>e.id===R),i=n?.fuel_type||"Petrol";(await fetch("/api/dispensers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch_id:e,dispenser_number:o,fuel_type:i,status:"active"})})).ok?(q.success(`Dispenser ${o} added successfully`),L(!1),V({dispenserNumber:""}),O(null),K()):q.error("Failed to add dispenser")}catch(e){console.error("Error adding dispenser:",e),q.error("Failed to add dispenser")}};return f||!e?(0,t.jsx)("div",{className:"p-6",children:"Loading tank management..."}):(0,t.jsxs)("div",{className:"space-y-6 p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"Tank Management"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage fuel tanks, stock levels, and transfers"})]}),(0,t.jsxs)(o.Button,{onClick:()=>S(!0),className:"rounded-xl",children:[(0,t.jsx)(j.Plus,{className:"h-4 w-4 mr-2"}),"Add New Tank"]})]}),(0,t.jsx)("div",{className:"grid gap-4",children:s.map(e=>{let a=Number.parseFloat((e.current_stock/e.capacity*100).toFixed(1)),s=a<20?"critical":a<50?"low":"normal";return(0,t.jsxs)(n.Card,{className:"rounded-2xl",children:[(0,t.jsx)(n.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,t.jsx)(x.Fuel,{className:"h-5 w-5 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(n.CardTitle,{className:"text-lg",children:e.tank_name}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.fuel_type})]})]}),(0,t.jsxs)(k.Badge,{variant:"critical"===s?"destructive":"low"===s?"secondary":"default",children:[a,"% Full"]})]})}),(0,t.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Capacity"}),(0,t.jsxs)("p",{className:"text-lg font-semibold",children:[e.capacity.toLocaleString()," L"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Current Stock"}),(0,t.jsxs)("p",{className:"text-lg font-semibold",children:[e.current_stock.toLocaleString()," L"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Available Space"}),(0,t.jsxs)("p",{className:"text-lg font-semibold",children:[(e.capacity-e.current_stock).toLocaleString()," L"]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Serving Dispensers/Nozzles"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[e.dispensers?.map(e=>(0,t.jsxs)(k.Badge,{variant:"outline",children:["D",e.dispenser_number]},e.id)),e.nozzles?.map(e=>(0,t.jsxs)(k.Badge,{variant:"outline",children:["N",e.nozzle_number]},e.id)),!e.dispensers?.length&&!e.nozzles?.length&&(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"No dispensers/nozzles assigned"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>{D(e),p(!0)},className:"rounded-xl",children:[(0,t.jsx)(T.Package,{className:"h-4 w-4 mr-2"}),"Receive Stock"]}),(0,t.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>{D(e),h(!0)},className:"rounded-xl",children:[(0,t.jsx)(v.Edit,{className:"h-4 w-4 mr-2"}),"Adjust Stock"]}),(0,t.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>{D(e),w(!0)},className:"rounded-xl",children:[(0,t.jsx)(_,{className:"h-4 w-4 mr-2"}),"Transfer Stock"]}),(0,t.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>{O(e),L(!0)},className:"rounded-xl",children:[(0,t.jsx)(j.Plus,{className:"mr-2 h-4 w-4"}),"Add Dispenser"]})]})]})]},e.id)})}),(0,t.jsx)(b.Dialog,{open:m,onOpenChange:h,children:(0,t.jsxs)(b.DialogContent,{className:"rounded-2xl",children:[(0,t.jsxs)(b.DialogHeader,{children:[(0,t.jsx)(b.DialogTitle,{children:"Adjust Stock Level"}),(0,t.jsxs)(b.DialogDescription,{children:["Manually adjust stock for ",B?.tank_name,". Positive values increase stock, negative values decrease it."]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Adjustment Quantity (Litres)"}),(0,t.jsx)(i.Input,{type:"number",placeholder:"e.g., +500 or -200",value:H.quantity,onChange:e=>E({...H,quantity:e.target.value}),className:"rounded-xl"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Reason for Adjustment"}),(0,t.jsx)(i.Input,{placeholder:"e.g., Physical count correction",value:H.reason,onChange:e=>E({...H,reason:e.target.value}),className:"rounded-xl"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Requested By"}),(0,t.jsx)(i.Input,{placeholder:"Your name",value:H.requestedBy,onChange:e=>E({...H,requestedBy:e.target.value}),className:"rounded-xl"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"This adjustment requires approval before taking effect."})]}),(0,t.jsxs)(b.DialogFooter,{children:[(0,t.jsx)(o.Button,{variant:"outline",onClick:()=>h(!1),className:"rounded-xl",children:"Cancel"}),(0,t.jsx)(o.Button,{onClick:J,className:"rounded-xl",children:"Submit for Approval"})]})]})}),(0,t.jsx)(b.Dialog,{open:y,onOpenChange:p,children:(0,t.jsxs)(b.DialogContent,{className:"rounded-2xl",children:[(0,t.jsxs)(b.DialogHeader,{children:[(0,t.jsx)(b.DialogTitle,{children:"Receive Stock"}),(0,t.jsxs)(b.DialogDescription,{children:["Record stock received into ",B?.tank_name]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Quantity Received (Litres)"}),(0,t.jsx)(i.Input,{type:"number",placeholder:"e.g., 5000",value:z.quantity,onChange:e=>A({...z,quantity:e.target.value}),className:"rounded-xl"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Delivery Note / Reference"}),(0,t.jsx)(i.Input,{placeholder:"e.g., DN-12345",value:z.reason,onChange:e=>A({...z,reason:e.target.value}),className:"rounded-xl"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Received By"}),(0,t.jsx)(i.Input,{placeholder:"Your name",value:z.requestedBy,onChange:e=>A({...z,requestedBy:e.target.value}),className:"rounded-xl"})]})]}),(0,t.jsxs)(b.DialogFooter,{children:[(0,t.jsx)(o.Button,{variant:"outline",onClick:()=>p(!1),className:"rounded-xl",children:"Cancel"}),(0,t.jsx)(o.Button,{onClick:Q,className:"rounded-xl",children:"Receive Stock"})]})]})}),(0,t.jsx)(b.Dialog,{open:N,onOpenChange:w,children:(0,t.jsxs)(b.DialogContent,{className:"rounded-2xl",children:[(0,t.jsxs)(b.DialogHeader,{children:[(0,t.jsx)(b.DialogTitle,{children:"Transfer Stock"}),(0,t.jsxs)(b.DialogDescription,{children:["Transfer stock from ",B?.tank_name," to another tank"]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Destination Branch"}),(0,t.jsxs)(g.Select,{value:F.toBranchId||void 0,onValueChange:e=>P({...F,toBranchId:e,toTankId:""}),children:[(0,t.jsx)(g.SelectTrigger,{className:"rounded-xl",children:(0,t.jsx)(g.SelectValue,{placeholder:"Select branch"})}),(0,t.jsx)(g.SelectContent,{children:d.map(e=>(0,t.jsx)(g.SelectItem,{value:e.id,children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Destination Tank"}),(0,t.jsxs)(g.Select,{value:F.toTankId,onValueChange:e=>P({...F,toTankId:e}),children:[(0,t.jsx)(g.SelectTrigger,{className:"rounded-xl",children:(0,t.jsx)(g.SelectValue,{placeholder:"Select tank"})}),(0,t.jsx)(g.SelectContent,{children:s.filter(e=>e.id!==B?.id&&e.fuel_type===B?.fuel_type).map(e=>(0,t.jsx)(g.SelectItem,{value:e.id,children:e.tank_name},e.id))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Quantity to Transfer (Litres)"}),(0,t.jsx)(i.Input,{type:"number",placeholder:"e.g., 1000",value:F.quantity,onChange:e=>P({...F,quantity:e.target.value}),className:"rounded-xl"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Transfer Notes"}),(0,t.jsx)(i.Input,{placeholder:"Reason for transfer",value:F.notes,onChange:e=>P({...F,notes:e.target.value}),className:"rounded-xl"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Requested By"}),(0,t.jsx)(i.Input,{placeholder:"Your name",value:F.requestedBy,onChange:e=>P({...F,requestedBy:e.target.value}),className:"rounded-xl"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"This transfer requires approval before taking effect."})]}),(0,t.jsxs)(b.DialogFooter,{children:[(0,t.jsx)(o.Button,{variant:"outline",onClick:()=>w(!1),className:"rounded-xl",children:"Cancel"}),(0,t.jsx)(o.Button,{onClick:Y,className:"rounded-xl",children:"Submit Transfer Request"})]})]})}),(0,t.jsx)(b.Dialog,{open:C,onOpenChange:S,children:(0,t.jsxs)(b.DialogContent,{className:"rounded-2xl",children:[(0,t.jsxs)(b.DialogHeader,{children:[(0,t.jsx)(b.DialogTitle,{children:"Add New Tank"}),(0,t.jsx)(b.DialogDescription,{children:"Add a new fuel tank to this branch"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Tank Name"}),(0,t.jsx)(i.Input,{placeholder:"e.g., Tank 03",value:$.tankName,onChange:e=>M({...$,tankName:e.target.value}),className:"rounded-xl"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Fuel Type"}),(0,t.jsxs)(g.Select,{value:$.fuelType,onValueChange:e=>M({...$,fuelType:e}),children:[(0,t.jsx)(g.SelectTrigger,{className:"rounded-xl",children:(0,t.jsx)(g.SelectValue,{})}),(0,t.jsxs)(g.SelectContent,{children:[(0,t.jsx)(g.SelectItem,{value:"Petrol",children:"Petrol"}),(0,t.jsx)(g.SelectItem,{value:"Diesel",children:"Diesel"}),(0,t.jsx)(g.SelectItem,{value:"Kerosene",children:"Kerosene"}),(0,t.jsx)(g.SelectItem,{value:"Super",children:"Super"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Tank Capacity (Litres)"}),(0,t.jsx)(i.Input,{type:"number",placeholder:"e.g., 10000",value:$.capacity,onChange:e=>M({...$,capacity:e.target.value}),className:"rounded-xl"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Initial Stock (Litres)"}),(0,t.jsx)(i.Input,{type:"number",placeholder:"e.g., 5000",value:$.initialStock,onChange:e=>M({...$,initialStock:e.target.value}),className:"rounded-xl"})]})]}),(0,t.jsxs)(b.DialogFooter,{children:[(0,t.jsx)(o.Button,{variant:"outline",onClick:()=>S(!1),className:"rounded-xl",children:"Cancel"}),(0,t.jsx)(o.Button,{onClick:G,className:"rounded-xl",children:"Add Tank"})]})]})}),(0,t.jsx)(b.Dialog,{open:I,onOpenChange:L,children:(0,t.jsxs)(b.DialogContent,{className:"rounded-2xl",children:[(0,t.jsxs)(b.DialogHeader,{children:[(0,t.jsxs)(b.DialogTitle,{children:["Add Dispenser to ",R?.tank_name]}),(0,t.jsxs)(b.DialogDescription,{children:["Add a new dispenser for ",R?.fuel_type," fuel"]})]}),(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"A new dispenser will be automatically assigned the next available number."})}),(0,t.jsxs)(b.DialogFooter,{children:[(0,t.jsx)(o.Button,{variant:"outline",onClick:()=>{L(!1),O(null)},className:"rounded-xl",children:"Cancel"}),(0,t.jsx)(o.Button,{onClick:W,className:"rounded-xl",children:"Add Dispenser"})]})]})})]})}function A(){let[e,s]=(0,a.useState)("cards"),[r,f]=(0,a.useState)(""),[b,_]=(0,a.useState)(""),[j,v]=(0,a.useState)(""),[T,N]=(0,a.useState)(""),[w,C]=(0,a.useState)(null),{formatCurrency:S}=(0,p.useCurrency)(),[I,L]=(0,a.useState)([]),[B,D]=(0,a.useState)(""),[R,O]=(0,a.useState)([]),[H,q]=(0,a.useState)([]),[E,A]=(0,a.useState)(null),[F,P]=(0,a.useState)(!1);(0,a.useEffect)(()=>{$();try{let e=localStorage.getItem("selectedBranch");if(e){let t=JSON.parse(e);t.id&&D(t.id)}}catch{}},[]);let $=async()=>{try{let e=await fetch("/api/branches"),t=await e.json();t.success&&L(t.data||[])}catch(e){console.error("Error fetching branches:",e)}},M=(0,a.useCallback)(async()=>{if(B){P(!0);try{let e=`/api/stock-report?branch_id=${B}`;b&&(e+=`&start_date=${b}`),j&&(e+=`&end_date=${j}`);let t=await fetch(e),a=await t.json();a.success&&(O(a.data.summary||[]),q(a.data.movements||[]),A(a.data.totals||null))}catch(e){console.error("Error fetching stock report:",e)}finally{P(!1)}}},[B,b,j]);(0,a.useEffect)(()=>{("stockReport"===e||"stockIn"===e||"stockOut"===e)&&M()},[e,M]);let U=H.filter(e=>"receive"===e.adjustment_type||"stock_receive"===e.adjustment_type||"addition"===e.adjustment_type||"increase"===e.adjustment_type||"manual_adjustment"===e.adjustment_type&&e.quantity>0||"transfer_in"===e.adjustment_type),V=H.filter(e=>"sale"===e.adjustment_type||"deduction"===e.adjustment_type||"decrease"===e.adjustment_type||"manual_adjustment"===e.adjustment_type&&e.quantity<0||"transfer_out"===e.adjustment_type||"transfer"===e.adjustment_type),K=e=>new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),X=e=>({receive:"bg-green-100 text-green-800",stock_receive:"bg-green-100 text-green-800",addition:"bg-green-100 text-green-800",increase:"bg-green-100 text-green-800",sale:"bg-blue-100 text-blue-800",deduction:"bg-red-100 text-red-800",decrease:"bg-red-100 text-red-800",manual_adjustment:"bg-yellow-100 text-yellow-800",transfer_in:"bg-purple-100 text-purple-800",transfer_out:"bg-orange-100 text-orange-800",transfer:"bg-orange-100 text-orange-800"})[e]||"bg-gray-100 text-gray-800";return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-balance",children:"Inventory Management"}),(0,t.jsx)("p",{className:"mt-1 text-muted-foreground text-pretty",children:"Monitor and manage your stock levels"})]})}),"cards"===e&&(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,t.jsxs)(n.Card,{className:"rounded-2xl cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>s("stockReport"),children:[(0,t.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(n.CardTitle,{className:"text-sm font-medium",children:"Stock Report"}),(0,t.jsx)(h.FileText,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(n.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:"View Report"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Per tank stock summary"})]})]}),(0,t.jsxs)(n.Card,{className:"rounded-2xl cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>s("stockIn"),children:[(0,t.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(n.CardTitle,{className:"text-sm font-medium",children:"Stock In History"}),(0,t.jsx)(c.TrendingUp,{className:"h-4 w-4 text-green-600"})]}),(0,t.jsxs)(n.CardContent,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[U.length," Entries"]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Stock received & adjusted in"})]})]}),(0,t.jsxs)(n.Card,{className:"rounded-2xl cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>s("stockOut"),children:[(0,t.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(n.CardTitle,{className:"text-sm font-medium",children:"Stock Out History"}),(0,t.jsx)(u,{className:"h-4 w-4 text-red-600"})]}),(0,t.jsxs)(n.CardContent,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[V.length," Entries"]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Sales & deductions"})]})]}),(0,t.jsxs)(n.Card,{className:"rounded-2xl cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>s("tankManagement"),children:[(0,t.jsxs)(n.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(n.CardTitle,{className:"text-sm font-medium",children:"Tank Management"}),(0,t.jsx)(x.Fuel,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(n.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:"Manage Tanks"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Stock levels & transfers"})]})]})]}),"cards"===e&&E&&(0,t.jsxs)(n.Card,{className:"rounded-2xl",children:[(0,t.jsx)(n.CardHeader,{children:(0,t.jsx)(n.CardTitle,{children:"Stock Summary"})}),(0,t.jsx)(n.CardContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"p-4 bg-green-50 rounded-xl",children:[(0,t.jsx)("p",{className:"text-sm text-green-700",children:"Total Received"}),(0,t.jsxs)("p",{className:"text-xl font-bold text-green-800",children:[E.total_received.toLocaleString()," L"]})]}),(0,t.jsxs)("div",{className:"p-4 bg-blue-50 rounded-xl",children:[(0,t.jsx)("p",{className:"text-sm text-blue-700",children:"Total Sold"}),(0,t.jsxs)("p",{className:"text-xl font-bold text-blue-800",children:[E.total_sold.toLocaleString()," L"]})]}),(0,t.jsxs)("div",{className:"p-4 bg-yellow-50 rounded-xl",children:[(0,t.jsx)("p",{className:"text-sm text-yellow-700",children:"Adjusted In/Out"}),(0,t.jsxs)("p",{className:"text-xl font-bold text-yellow-800",children:["+",E.total_adjusted_in.toLocaleString()," / -",E.total_adjusted_out.toLocaleString()," L"]})]}),(0,t.jsxs)("div",{className:"p-4 bg-purple-50 rounded-xl",children:[(0,t.jsx)("p",{className:"text-sm text-purple-700",children:"Current Stock"}),(0,t.jsxs)("p",{className:"text-xl font-bold text-purple-800",children:[E.current_stock.toLocaleString()," L"]})]})]})})]}),"stockReport"===e&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(o.Button,{variant:"outline",className:"rounded-xl bg-transparent",onClick:()=>s("cards"),children:"← Back to Overview"}),(0,t.jsxs)(o.Button,{variant:"outline",className:"rounded-xl",onClick:M,disabled:F,children:[(0,t.jsx)(y.RefreshCw,{className:`h-4 w-4 mr-2 ${F?"animate-spin":""}`}),"Refresh"]})]}),(0,t.jsxs)(n.Card,{className:"rounded-2xl",children:[(0,t.jsx)(n.CardHeader,{children:(0,t.jsx)(n.CardTitle,{children:"Stock Report by Tank"})}),(0,t.jsxs)(n.CardContent,{children:[(0,t.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"w-64",children:[(0,t.jsx)(l.Label,{children:"Branch"}),(0,t.jsxs)(g.Select,{value:B,onValueChange:D,children:[(0,t.jsx)(g.SelectTrigger,{className:"rounded-xl",children:(0,t.jsx)(g.SelectValue,{placeholder:"Select branch"})}),(0,t.jsx)(g.SelectContent,{children:I.map(e=>(0,t.jsx)(g.SelectItem,{value:e.id,children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Start Date"}),(0,t.jsx)(i.Input,{type:"date",value:b,onChange:e=>_(e.target.value),className:"rounded-xl w-48"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"End Date"}),(0,t.jsx)(i.Input,{type:"date",value:j,onChange:e=>v(e.target.value),className:"rounded-xl w-48"})]})]}),F?(0,t.jsx)("div",{className:"text-center py-8",children:"Loading..."}):0===R.length?(0,t.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:B?"No stock data found":"Select a branch to view report"}):(0,t.jsx)("div",{className:"rounded-xl border overflow-hidden",children:(0,t.jsxs)(d.Table,{children:[(0,t.jsx)(d.TableHeader,{children:(0,t.jsxs)(d.TableRow,{children:[(0,t.jsx)(d.TableHead,{children:"Tank"}),(0,t.jsx)(d.TableHead,{children:"Fuel Type"}),(0,t.jsx)(d.TableHead,{className:"text-right",children:"Capacity"}),(0,t.jsx)(d.TableHead,{className:"text-right",children:"Current Stock"}),(0,t.jsx)(d.TableHead,{className:"text-right text-green-700",children:"Received"}),(0,t.jsx)(d.TableHead,{className:"text-right text-yellow-700",children:"Adjusted +/-"}),(0,t.jsx)(d.TableHead,{className:"text-right text-blue-700",children:"Sold"}),(0,t.jsx)(d.TableHead,{className:"text-right text-purple-700",children:"Transferred In/Out"})]})}),(0,t.jsx)(d.TableBody,{children:R.map(e=>(0,t.jsxs)(d.TableRow,{children:[(0,t.jsx)(d.TableCell,{className:"font-medium",children:e.tank_name}),(0,t.jsx)(d.TableCell,{children:e.fuel_type}),(0,t.jsxs)(d.TableCell,{className:"text-right",children:[Number(e.capacity).toLocaleString()," L"]}),(0,t.jsxs)(d.TableCell,{className:"text-right font-medium",children:[Number(e.current_stock).toLocaleString()," L"]}),(0,t.jsxs)(d.TableCell,{className:"text-right text-green-600",children:["+",Number(e.total_received).toLocaleString()]}),(0,t.jsxs)(d.TableCell,{className:"text-right text-yellow-600",children:["+",Number(e.total_adjusted_in).toLocaleString()," / -",Number(e.total_adjusted_out).toLocaleString()]}),(0,t.jsx)(d.TableCell,{className:"text-right text-blue-600",children:Number(e.total_sold).toLocaleString()}),(0,t.jsxs)(d.TableCell,{className:"text-right text-purple-600",children:["+",Number(e.total_transferred_in).toLocaleString()," / -",Number(e.total_transferred_out).toLocaleString()]})]},e.tank_id))})]})})]})]}),H.length>0&&(0,t.jsxs)(n.Card,{className:"rounded-2xl",children:[(0,t.jsx)(n.CardHeader,{children:(0,t.jsx)(n.CardTitle,{children:"Recent Stock Movements"})}),(0,t.jsx)(n.CardContent,{children:(0,t.jsx)("div",{className:"rounded-xl border overflow-hidden",children:(0,t.jsxs)(d.Table,{children:[(0,t.jsx)(d.TableHeader,{children:(0,t.jsxs)(d.TableRow,{children:[(0,t.jsx)(d.TableHead,{children:"Date"}),(0,t.jsx)(d.TableHead,{children:"Tank"}),(0,t.jsx)(d.TableHead,{children:"Type"}),(0,t.jsx)(d.TableHead,{className:"text-right",children:"Quantity"}),(0,t.jsx)(d.TableHead,{className:"text-right",children:"Before"}),(0,t.jsx)(d.TableHead,{className:"text-right",children:"After"}),(0,t.jsx)(d.TableHead,{children:"Reason"}),(0,t.jsx)(d.TableHead,{children:"KRA Status"})]})}),(0,t.jsx)(d.TableBody,{children:H.slice(0,20).map(e=>(0,t.jsxs)(d.TableRow,{children:[(0,t.jsx)(d.TableCell,{className:"text-sm",children:K(e.created_at)}),(0,t.jsx)(d.TableCell,{className:"font-medium",children:e.tank_name}),(0,t.jsx)(d.TableCell,{children:(0,t.jsx)(k.Badge,{className:X(e.adjustment_type),children:e.adjustment_type.replace(/_/g," ")})}),(0,t.jsxs)(d.TableCell,{className:`text-right font-medium ${e.quantity>=0?"text-green-600":"text-red-600"}`,children:[e.quantity>=0?"+":"",Number(e.quantity).toLocaleString()]}),(0,t.jsx)(d.TableCell,{className:"text-right",children:Number(e.previous_stock).toLocaleString()}),(0,t.jsx)(d.TableCell,{className:"text-right",children:Number(e.new_stock).toLocaleString()}),(0,t.jsx)(d.TableCell,{className:"text-sm text-muted-foreground max-w-[200px] truncate",children:e.reason||"-"}),(0,t.jsx)(d.TableCell,{children:"synced"===e.kra_sync_status?(0,t.jsx)(k.Badge,{className:"bg-green-100 text-green-800",children:"Synced"}):"failed"===e.kra_sync_status?(0,t.jsx)(k.Badge,{className:"bg-red-100 text-red-800",children:"Failed"}):(0,t.jsx)(k.Badge,{className:"bg-gray-100 text-gray-600",children:"Pending"})})]},e.id))})]})})})]})]}),("stockIn"===e||"stockOut"===e)&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(o.Button,{variant:"outline",className:"rounded-xl bg-transparent",onClick:()=>s("cards"),children:"← Back to Overview"}),(0,t.jsxs)(o.Button,{variant:"outline",className:"rounded-xl",onClick:M,disabled:F,children:[(0,t.jsx)(y.RefreshCw,{className:`h-4 w-4 mr-2 ${F?"animate-spin":""}`}),"Refresh"]})]}),(0,t.jsxs)(n.Card,{className:"rounded-2xl",children:[(0,t.jsx)(n.CardHeader,{children:(0,t.jsx)(n.CardTitle,{children:"stockIn"===e?"Stock In History":"Stock Out History"})}),(0,t.jsxs)(n.CardContent,{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"w-64",children:[(0,t.jsx)(l.Label,{children:"Branch"}),(0,t.jsxs)(g.Select,{value:B,onValueChange:D,children:[(0,t.jsx)(g.SelectTrigger,{className:"rounded-xl",children:(0,t.jsx)(g.SelectValue,{placeholder:"Select branch"})}),(0,t.jsx)(g.SelectContent,{children:I.map(e=>(0,t.jsx)(g.SelectItem,{value:e.id,children:e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)(l.Label,{children:"Search"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(m.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(i.Input,{placeholder:"Search by tank or reason...",value:r,onChange:e=>f(e.target.value),className:"pl-9 rounded-xl"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"Start Date"}),(0,t.jsx)(i.Input,{type:"date",value:b,onChange:e=>_(e.target.value),className:"rounded-xl w-48"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Label,{children:"End Date"}),(0,t.jsx)(i.Input,{type:"date",value:j,onChange:e=>v(e.target.value),className:"rounded-xl w-48"})]})]}),F?(0,t.jsx)("div",{className:"text-center py-8",children:"Loading..."}):(0,t.jsx)("div",{className:"rounded-xl border overflow-hidden",children:(0,t.jsxs)(d.Table,{children:[(0,t.jsx)(d.TableHeader,{children:(0,t.jsxs)(d.TableRow,{children:[(0,t.jsx)(d.TableHead,{children:"Date"}),(0,t.jsx)(d.TableHead,{children:"Tank"}),(0,t.jsx)(d.TableHead,{children:"Fuel Type"}),(0,t.jsx)(d.TableHead,{children:"Type"}),(0,t.jsx)(d.TableHead,{className:"text-right",children:"Quantity"}),(0,t.jsx)(d.TableHead,{children:"Reason"}),(0,t.jsx)(d.TableHead,{children:"KRA Status"})]})}),(0,t.jsxs)(d.TableBody,{children:[("stockIn"===e?U:V).filter(e=>""===r||e.tank_name?.toLowerCase().includes(r.toLowerCase())||e.reason?.toLowerCase().includes(r.toLowerCase())).map(a=>(0,t.jsxs)(d.TableRow,{children:[(0,t.jsx)(d.TableCell,{className:"text-sm",children:K(a.created_at)}),(0,t.jsx)(d.TableCell,{className:"font-medium",children:a.tank_name}),(0,t.jsx)(d.TableCell,{children:a.fuel_type}),(0,t.jsx)(d.TableCell,{children:(0,t.jsx)(k.Badge,{className:X(a.adjustment_type),children:a.adjustment_type.replace(/_/g," ")})}),(0,t.jsxs)(d.TableCell,{className:`text-right font-medium ${"stockIn"===e?"text-green-600":"text-red-600"}`,children:["stockIn"===e?"+":"-",Math.abs(Number(a.quantity)).toLocaleString()," L"]}),(0,t.jsx)(d.TableCell,{className:"text-sm text-muted-foreground max-w-[200px] truncate",children:a.reason||"-"}),(0,t.jsx)(d.TableCell,{children:"synced"===a.kra_sync_status?(0,t.jsx)(k.Badge,{className:"bg-green-100 text-green-800",children:"Synced"}):"failed"===a.kra_sync_status?(0,t.jsx)(k.Badge,{className:"bg-red-100 text-red-800",children:"Failed"}):(0,t.jsx)(k.Badge,{className:"bg-gray-100 text-gray-600",children:"Pending"})})]},a.id)),0===("stockIn"===e?U:V).length&&(0,t.jsx)(d.TableRow,{children:(0,t.jsx)(d.TableCell,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:B?"No stock movements found":"Select a branch to view history"})})]})]})})]})]})]}),"tankManagement"===e&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)(o.Button,{variant:"outline",className:"rounded-xl bg-transparent",onClick:()=>s("cards"),children:"← Back to Overview"})}),(0,t.jsx)(z,{branchId:(()=>{try{let e=localStorage.getItem("selectedBranch");if(!e)return"";return JSON.parse(e).id||""}catch{return""}})()})]})]})}function F(){let[e,o]=(0,a.useState)(!1);return(0,t.jsxs)("div",{className:"flex min-h-screen bg-gradient-to-b from-slate-900 via-blue-900 to-white",children:[(0,t.jsx)(s.DashboardSidebar,{collapsed:e,onToggle:()=>o(!e)}),(0,t.jsx)("div",{className:"flex-1 flex flex-col ml-8 my-6 mr-6",children:(0,t.jsxs)("div",{className:"bg-white rounded-tl-3xl shadow-2xl flex-1 flex flex-col overflow-hidden",children:[(0,t.jsx)(r.DashboardHeader,{}),(0,t.jsx)("main",{className:"flex-1 overflow-y-auto bg-slate-50 p-6",children:(0,t.jsxs)("div",{className:"mx-auto max-w-7xl space-y-6",children:[(0,t.jsx)(A,{}),(0,t.jsxs)("footer",{className:"mt-12 border-t pt-6 pb-4 text-center text-sm text-muted-foreground",children:["Powered by ",(0,t.jsx)("span",{className:"font-semibold text-foreground",children:"Sensile Technologies East Africa Ltd"})]})]})})]})})]})}w(E("bounce",!0)),w(E("slide",!0)),w(E("zoom")),w(E("flip")),e.s(["default",()=>F],20800)}]);