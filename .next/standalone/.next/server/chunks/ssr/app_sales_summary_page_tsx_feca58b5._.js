module.exports=[14459,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(344),e=a.i(69265),f=a.i(65733),g=a.i(3130),h=a.i(40695),i=a.i(5522),j=a.i(17171),k=a.i(87682),l=a.i(76504),m=a.i(23292),n=a.i(92e3),o=a.i(5784),p=a.i(15618),q=a.i(65602),r=a.i(74575),s=a.i(46893),t=a.i(32221),u=a.i(29154),v=a.i(30342),w=a.i(37539),x=a.i(33441),y=a.i(97895),z=a.i(64321),A=a.i(27165),B=a.i(67149),C=a.i(18155),D=a.i(23665),E=a.i(58042),F=a.i(94222),G=a.i(54419),H=a.i(59854),I=a.i(48662),J=a.i(54031),K=a.i(77924);function L(){let a,d,e,L,M,{formatCurrency:N}=(0,r.useCurrency)(),[O,P]=(0,c.useState)([]),[Q,R]=(0,c.useState)([]),[S,T]=(0,c.useState)([]),[U,V]=(0,c.useState)([]),[W,X]=(0,c.useState)(null),[Y,Z]=(0,c.useState)(!1),[$,_]=(0,c.useState)(!1),[aa,ab]=(0,c.useState)(!1),[ac,ad]=(0,c.useState)(null),[ae,af]=(0,c.useState)(!1),[ag,ah]=(0,c.useState)(null),[ai,aj]=(0,c.useState)([]),[ak,al]=(0,c.useState)(!1),[am,an]=(0,c.useState)({nozzle_id:"",fuel_type:"",amount:"",payment_method:"cash",customer_name:"",vehicle_number:"",customer_pin:"",meter_reading_after:"",is_loyalty_sale:!1,loyalty_customer_name:"",loyalty_customer_pin:"",discount_type:"fixed",discount_value:""}),[ao,ap]=(0,c.useState)({date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),closing_cash:"",notes:""}),[aq,ar]=(0,c.useState)(!1);async function as(){try{Z(!0);let a=localStorage.getItem("selectedBranch");if(!a){m.toast.error("No branch selected"),Z(!1);return}let b=JSON.parse(a).id,[c,d,e,f]=await Promise.all([fetch(`/api/nozzles?branch_id=${b}&status=active`),fetch(`/api/dispensers?branch_id=${b}`),fetch(`/api/fuel-prices?branch_id=${b}`),fetch(`/api/shifts?branch_id=${b}&status=active`)]),[g,h,i,j]=await Promise.all([c.json(),d.json(),e.json(),f.json()]);g.success&&R(g.data||[]),h.success&&T(h.data||[]),i.success&&V(i.data||[]),j.success&&j.data?X(j.data):X(null),await at()}catch(a){console.error("Error fetching data:",a),m.toast.error("Failed to load sales data")}finally{Z(!1)}}async function at(){try{let a=localStorage.getItem("selectedBranch");if(!a)return;let b=JSON.parse(a).id,c=await fetch(`/api/sales?branch_id=${b}&limit=50`),d=await c.json();if(d.success){let a=(d.data||[]).map(a=>({...a,quantity:Number(a.quantity)||0,unit_price:Number(a.unit_price)||0,total_amount:Number(a.total_amount)||0,meter_reading_after:Number(a.meter_reading_after)||0,loyalty_points_earned:Number(a.loyalty_points_earned)||0}));P(a)}}catch(a){console.error("Error fetching sales:",a)}}async function au(){if(!am.nozzle_id||!am.fuel_type||!am.amount)return void m.toast.error("Please fill in all required fields");if(!W)return void m.toast.error("Please start a shift before recording sales");Z(!0);try{let a=localStorage.getItem("selectedBranch");if(!a)return void m.toast.error("No branch selected");let b=JSON.parse(a).id,c=U.find(a=>a.fuel_type===am.fuel_type);if(!c)return void m.toast.error(`No price configured for ${am.fuel_type}`);let d=Q.find(a=>a.id===am.nozzle_id),e=await fetch(`/api/sales?nozzle_id=${am.nozzle_id}`),f=await e.json(),g=f.success?f.data:[],h=Number(d?.initial_meter_reading)||0;if(g&&g.length>0){let a=g.reduce((a,b)=>a+Number(b.quantity),0);h+=a}let i=Number.parseFloat(am.amount),j=Number.parseFloat(c.price),k=0;if(am.discount_value&&Number.parseFloat(am.discount_value)>0)if("percentage"===am.discount_type){let a=Math.min(Number.parseFloat(am.discount_value),100);k=i*a/100}else k=Math.min(Number.parseFloat(am.discount_value),i);let l=Math.max(i-k,0),n=l/j;h+=n;let o=`INV-${Date.now()}`,p=`RCP-${Date.now()}`,q=await fetch("/api/sales",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch_id:b,shift_id:W.id,nozzle_id:am.nozzle_id,fuel_type:am.fuel_type,quantity:n,unit_price:j,total_amount:l,payment_method:am.payment_method,customer_name:am.customer_name||null,vehicle_number:am.vehicle_number||null,customer_pin:am.customer_pin||null,invoice_number:o,meter_reading_after:h,transmission_status:"pending",receipt_number:p,is_loyalty_sale:am.is_loyalty_sale,loyalty_customer_name:am.is_loyalty_sale?am.loyalty_customer_name:null,loyalty_customer_pin:am.is_loyalty_sale?am.loyalty_customer_pin:null})}),r=await q.json();if(q.ok&&r.success){let a=r.data;try{let c=await fetch("/api/kra/test-sale",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch_id:b,invoice_number:a.invoice_number,receipt_number:a.receipt_number,fuel_type:am.fuel_type,quantity:n,unit_price:j,total_amount:l,payment_method:am.payment_method,customer_name:am.customer_name||"Walk-in Customer",customer_pin:am.customer_pin||""})}),d=await c.json();console.log("KRA API Response:",JSON.stringify(d,null,2))}catch(a){console.error("Error calling KRA endpoint:",a)}m.toast.success("Sale recorded successfully!"),an({nozzle_id:"",fuel_type:"",amount:"",payment_method:"cash",customer_name:"",vehicle_number:"",customer_pin:"",meter_reading_after:"",is_loyalty_sale:!1,loyalty_customer_name:"",loyalty_customer_pin:"",discount_type:"fixed",discount_value:""}),_(!1),await at()}else console.error("Sale creation error:",r.error),m.toast.error(`Error recording sale: ${r.error||"Unknown error"}`)}catch(a){console.error("Sale creation error:",a),m.toast.error("Failed to record sale")}finally{Z(!1)}}async function av(){if(!ao.date||!ao.time)return void m.toast.error("Please select date and time");ar(!0);try{let a=localStorage.getItem("selectedBranch");if(!a){m.toast.error("No branch selected. Please select a branch from the header."),ar(!1);return}let b=JSON.parse(a).id,c=new Date(`${ao.date}T${ao.time}`),d={branch_id:b,start_time:c.toISOString(),status:"active",opening_cash:0,notes:ao.notes||null},e=await fetch("/api/shifts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),f=await e.json();e.ok&&f.success?(m.toast.success("Shift started successfully"),X(f.data),ab(!1),ap({date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),closing_cash:"",notes:""})):(console.error("Error starting shift:",f.error),m.toast.error(`Failed to start shift: ${f.error||"Unknown error"}`))}catch(a){console.error("Error starting shift:",a),m.toast.error(`Failed to start shift: ${a instanceof Error?a.message:"Unknown error"}`)}finally{ar(!1)}}async function aw(){if(!W)return void m.toast.error("No active shift to end");ar(!0);try{let a=await fetch("/api/shifts",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:W.id,end_time:new Date().toISOString(),status:"completed",closing_cash:ao.closing_cash?Number.parseFloat(ao.closing_cash):0,notes:ao.notes||null})}),b=await a.json();a.ok&&b.success?(m.toast.success("Shift ended successfully"),X(null),ab(!1),ap({date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),closing_cash:"",notes:""})):(console.error("Error ending shift:",b.error),m.toast.error("Failed to end shift"))}catch(a){console.error("Error ending shift:",a),m.toast.error("Failed to end shift")}finally{ar(!1)}}(0,c.useEffect)(()=>{let a=localStorage.getItem("selectedBranch");a&&ah(JSON.parse(a)),as()},[]),(0,c.useEffect)(()=>{async function a(){try{let a=await fetch(`/api/customers?branch_id=${ag?.id}`),b=await a.json();b.success&&aj((b.data||[]).map(a=>({id:a.id,name:a.cust_nm||"",pin:a.cust_tin||""})))}catch(a){console.error("Error fetching loyalty customers:",a)}}ag?.id&&a()},[ag?.id]);let ax=W?new Date(W.start_time).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Unknown";return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-slate-900",children:"Sales Summary"}),(0,b.jsx)("p",{className:"text-slate-600",children:"Overview of sales performance and trends"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(l.DropdownMenu,{children:[(0,b.jsx)(l.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(h.Button,{variant:"outline",children:["Shift Management ",(0,b.jsx)(o.ChevronDown,{className:"ml-2 h-4 w-4"})]})}),(0,b.jsxs)(l.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(l.DropdownMenuItem,{onClick:()=>{ad("start"),ab(!0)},disabled:!!W,children:"Start Shift"}),(0,b.jsx)(l.DropdownMenuItem,{onClick:()=>af(!0),disabled:!W,children:"End Shift (Excel Upload)"}),(0,b.jsx)(l.DropdownMenuItem,{children:"Configure Automatic Shifts"})]})]}),(0,b.jsxs)(h.Button,{onClick:()=>_(!0),disabled:!W,children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Record Sale"]})]})]}),W?(0,b.jsx)(q.Alert,{className:"bg-green-50 border-green-200",children:(0,b.jsxs)(q.AlertDescription,{className:"text-green-800",children:["Current ongoing shift started at ",ax]})}):(0,b.jsxs)(q.Alert,{className:"bg-amber-50 border-amber-200",children:[(0,b.jsx)(n.AlertCircle,{className:"h-4 w-4 text-amber-600"}),(0,b.jsx)(q.AlertDescription,{className:"text-amber-800",children:"No active shift. Please start a shift before recording sales."})]}),O.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-4 mb-4",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-base text-black",children:"Sales by Fuel Type"}),(0,b.jsx)(g.CardDescription,{className:"text-xs text-black/70",children:"Revenue by fuel type"})]}),(0,b.jsx)(g.CardContent,{className:"pt-2",children:(0,b.jsx)(I.ResponsiveContainer,{width:"100%",height:220,children:(0,b.jsxs)(z.PieChart,{children:[(0,b.jsx)(A.Pie,{data:Object.entries(O.reduce((a,b)=>(a[b.fuel_type]=(a[b.fuel_type]||0)+b.total_amount,a),{})).map(([a,b])=>({name:a,value:b})),cx:"50%",cy:"50%",labelLine:!1,label:a=>{let{cx:c,cy:d,midAngle:e,innerRadius:f,outerRadius:g,percent:h,name:i}=a,j=f+(g-f)*.5,k=c+j*Math.cos(-(Math.PI/180*e)),l=d+j*Math.sin(-(Math.PI/180*e));return(0,b.jsx)("text",{x:k,y:l,fill:"#000000",textAnchor:k>c?"start":"end",dominantBaseline:"central",fontSize:"11",fontWeight:"500",children:`${i} ${(100*h).toFixed(0)}%`})},outerRadius:70,fill:"#8884d8",dataKey:"value",children:(a={Diesel:"#FFFF00",Petrol:"#FF0000",Unleaded:"#FF0000",Super:"#10B981"},Object.keys(O.reduce((a,b)=>(a[b.fuel_type]=(a[b.fuel_type]||0)+b.total_amount,a),{})).map((c,d)=>(0,b.jsx)(B.Cell,{fill:a[c]||"#6B7280"},`cell-${d}`)))}),(0,b.jsx)(H.Tooltip,{formatter:a=>N(a),contentStyle:{color:"#000"}})]})})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-base text-black",children:"Payment Methods"}),(0,b.jsx)(g.CardDescription,{className:"text-xs text-black/70",children:"Payment breakdown"})]}),(0,b.jsx)(g.CardContent,{className:"pt-2",children:(0,b.jsx)(I.ResponsiveContainer,{width:"100%",height:220,children:(0,b.jsxs)(z.PieChart,{children:[(0,b.jsx)(A.Pie,{data:Object.entries(O.reduce((a,b)=>{let c,d="mpesa"===(c=(b.payment_method||"cash").toLowerCase())||"m-pesa"===c||"mobile_money"===c?"Mobile Money":"card"===c?"Card":"credit"===c?"Credit":"Cash";return a[d]=(a[d]||0)+b.total_amount,a},{})).map(([a,b])=>({name:a,value:b})),cx:"50%",cy:"50%",labelLine:!1,label:a=>{let{cx:c,cy:d,midAngle:e,innerRadius:f,outerRadius:g,percent:h,name:i}=a,j=f+(g-f)*.5,k=c+j*Math.cos(-(Math.PI/180*e)),l=d+j*Math.sin(-(Math.PI/180*e));return(0,b.jsx)("text",{x:k,y:l,fill:"#000000",textAnchor:k>c?"start":"end",dominantBaseline:"central",fontSize:"11",fontWeight:"500",children:`${"Mobile Money"===i?"M.Money":i} ${(100*h).toFixed(0)}%`})},outerRadius:70,fill:"#8884d8",dataKey:"value",children:(d={Cash:"#3A7085","Mobile Money":"#008C51",Card:"#F59E0B",Credit:"#EF4444"},Object.keys(O.reduce((a,b)=>{let c,d="mpesa"===(c=(b.payment_method||"cash").toLowerCase())||"m-pesa"===c||"mobile_money"===c?"Mobile Money":"card"===c?"Card":"credit"===c?"Credit":"Cash";return a[d]=(a[d]||0)+b.total_amount,a},{})).map((a,c)=>(0,b.jsx)(B.Cell,{fill:d[a]||"#6B7280"},`cell-${c}`)))}),(0,b.jsx)(H.Tooltip,{formatter:a=>N(a),contentStyle:{color:"#000"}})]})})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-base text-black",children:"Loyalty Program"}),(0,b.jsx)(g.CardDescription,{className:"text-xs text-black/70",children:"Loyalty vs Walk-in sales"})]}),(0,b.jsx)(g.CardContent,{className:"pt-2",children:(0,b.jsx)(I.ResponsiveContainer,{width:"100%",height:220,children:(0,b.jsxs)(z.PieChart,{children:[(0,b.jsxs)(A.Pie,{data:[{name:"Loyalty",value:O.filter(a=>a.is_loyalty_sale).reduce((a,b)=>a+b.total_amount,0)},{name:"Walk-in",value:O.filter(a=>!a.is_loyalty_sale).reduce((a,b)=>a+b.total_amount,0)}],cx:"50%",cy:"50%",labelLine:!1,label:a=>{let{cx:c,cy:d,midAngle:e,innerRadius:f,outerRadius:g,percent:h,name:i}=a,j=f+(g-f)*.5,k=c+j*Math.cos(-(Math.PI/180*e)),l=d+j*Math.sin(-(Math.PI/180*e));return(0,b.jsx)("text",{x:k,y:l,fill:"#000000",textAnchor:k>c?"start":"end",dominantBaseline:"central",fontSize:"11",fontWeight:"500",children:`${i} ${(100*h).toFixed(0)}%`})},outerRadius:70,fill:"#8884d8",dataKey:"value",children:[(0,b.jsx)(B.Cell,{fill:"#C8A2C8"}),(0,b.jsx)(B.Cell,{fill:"#87CEEB"})]}),(0,b.jsx)(H.Tooltip,{formatter:a=>N(a),contentStyle:{color:"#000"}})]})})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-base text-black",children:"Revenue vs VAT"}),(0,b.jsx)(g.CardDescription,{className:"text-xs text-black/70",children:"Month-to-date comparison"})]}),(0,b.jsx)(g.CardContent,{className:"pt-2",children:(0,b.jsx)(I.ResponsiveContainer,{width:"100%",height:220,children:(0,b.jsxs)(C.BarChart,{data:(L=new Date((e=new Date).getFullYear(),e.getMonth(),1),[{name:"Revenue",value:M=O.filter(a=>new Date(a.sale_date)>=L).reduce((a,b)=>a+b.total_amount,0)},{name:"VAT",value:.16*M}]),margin:{top:5,right:5,left:5,bottom:5},children:[(0,b.jsx)(G.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(E.XAxis,{dataKey:"name",tick:{fill:"#000",fontSize:11}}),(0,b.jsx)(F.YAxis,{tick:{fill:"#000",fontSize:10}}),(0,b.jsx)(H.Tooltip,{formatter:a=>N(a),contentStyle:{color:"#000"}}),(0,b.jsxs)(D.Bar,{dataKey:"value",children:[(0,b.jsx)(B.Cell,{fill:"#15426D"}),(0,b.jsx)(B.Cell,{fill:"#D55402"})]})]})})})]})]}),(0,b.jsxs)(g.Card,{className:"rounded-2xl md:col-span-2",children:[(0,b.jsxs)(g.CardHeader,{className:"pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-base text-black",children:"Daily Sales Trend"}),(0,b.jsx)(g.CardDescription,{className:"text-xs text-black/70",children:"Sales per product over 7 days"})]}),(0,b.jsx)(g.CardContent,{className:"pt-2",children:(0,b.jsx)(I.ResponsiveContainer,{width:"100%",height:220,children:(0,b.jsxs)(J.LineChart,{data:(()=>{let a=[];for(let b=6;b>=0;b--){let c=new Date;c.setDate(c.getDate()-b);let d=c.toISOString().split("T")[0],e={date:d};[...new Set(O.map(a=>a.fuel_type))].forEach(a=>{let b=O.filter(b=>b.sale_date.startsWith(d)&&b.fuel_type===a).reduce((a,b)=>a+b.total_amount,0);e[a]=b}),a.push(e)}return a})(),margin:{top:5,right:10,left:0,bottom:5},children:[(0,b.jsx)(G.CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,b.jsx)(E.XAxis,{dataKey:"date",tick:{fontSize:10,fill:"#000"},tickFormatter:a=>new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),(0,b.jsx)(F.YAxis,{tick:{fontSize:11,fill:"#000"}}),(0,b.jsx)(H.Tooltip,{formatter:a=>N(a),contentStyle:{color:"#000"},labelFormatter:a=>new Date(a).toLocaleDateString()}),[...new Set(O.map(a=>a.fuel_type))].map(a=>{let c={Diesel:"#FFFF00",Petrol:"#FF0000",Unleaded:"#FF0000",Super:"#10B981"};return(0,b.jsx)(K.Line,{type:"monotone",dataKey:a,stroke:c[a]||"#000",strokeWidth:2,dot:{fill:c[a]||"#000"},name:a},a)})]})})})]})]}),0===O.length&&!Y&&(0,b.jsx)(g.Card,{className:"rounded-2xl",children:(0,b.jsx)(g.CardContent,{className:"py-12 text-center",children:(0,b.jsx)("p",{className:"text-slate-500",children:"No sales data available. Start a shift and record sales to see performance metrics."})})}),(0,b.jsx)(f.Dialog,{open:aa,onOpenChange:ab,children:(0,b.jsxs)(f.DialogContent,{children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{children:"start"===ac?"Start New Shift":"End Current Shift"}),(0,b.jsx)(f.DialogDescription,{children:"start"===ac?"Enter details to start a new shift":"Enter closing details to end the shift"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:["start"===ac&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"shift-date",children:"Date"}),(0,b.jsx)(i.Input,{id:"shift-date",type:"date",value:ao.date,onChange:a=>ap({...ao,date:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"shift-time",children:"Time"}),(0,b.jsx)(i.Input,{id:"shift-time",type:"time",value:ao.time,onChange:a=>ap({...ao,time:a.target.value})})]})]}),"end"===ac&&(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"closing-cash",children:"Closing Cash"}),(0,b.jsx)(i.Input,{id:"closing-cash",type:"number",placeholder:"0.00",value:ao.closing_cash,onChange:a=>ap({...ao,closing_cash:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"shift-notes",children:"Notes"}),(0,b.jsx)(s.Textarea,{id:"shift-notes",placeholder:"Optional notes...",value:ao.notes,onChange:a=>ap({...ao,notes:a.target.value})})]})]}),(0,b.jsxs)(f.DialogFooter,{children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>ab(!1),children:"Cancel"}),(0,b.jsx)(h.Button,{onClick:"start"===ac?av:aw,disabled:aq,children:"start"===ac?"Start Shift":"End Shift"})]})]})}),(0,b.jsx)(f.Dialog,{open:$,onOpenChange:_,children:(0,b.jsxs)(f.DialogContent,{className:"max-w-2xl",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{children:"Record Fuel Sale"}),(0,b.jsx)(f.DialogDescription,{children:"Enter sale details to record a new fuel transaction"})]}),(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"nozzle",children:"Nozzle *"}),(0,b.jsxs)(k.Select,{value:am.nozzle_id,onValueChange:a=>{let b=Q.find(b=>b.id===a);an({...am,nozzle_id:a,fuel_type:b?.fuel_type||""})},children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select nozzle"})}),(0,b.jsx)(k.SelectContent,{children:Q.map(a=>{let c=S.find(b=>b.id===a.dispenser_id);return(0,b.jsxs)(k.SelectItem,{value:a.id,children:[c?`D${c.dispenser_number}N${a.nozzle_number}`:`Nozzle ${a.nozzle_number}`," - ",a.fuel_type]},a.id)})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"fuel-type",children:"Fuel Type *"}),(0,b.jsx)(i.Input,{id:"fuel-type",value:am.fuel_type,readOnly:!0,className:"bg-slate-50"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"amount",children:"Amount (KES) *"}),(0,b.jsx)(i.Input,{id:"amount",type:"number",placeholder:"0.00",value:am.amount,onChange:a=>an({...am,amount:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"payment-method",children:"Payment Method"}),(0,b.jsxs)(k.Select,{value:am.payment_method,onValueChange:a=>an({...am,payment_method:a}),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"cash",children:"Cash"}),(0,b.jsx)(k.SelectItem,{value:"mobile_money",children:"Mobile Money"}),(0,b.jsx)(k.SelectItem,{value:"card",children:"Card"}),(0,b.jsx)(k.SelectItem,{value:"credit",children:"Credit"})]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"discount-type",children:"Discount Type"}),(0,b.jsxs)(k.Select,{value:am.discount_type,onValueChange:a=>an({...am,discount_type:a}),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"fixed",children:"Fixed Amount"}),(0,b.jsx)(k.SelectItem,{value:"percentage",children:"Percentage"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"discount-value",children:"Discount Value"}),(0,b.jsx)(i.Input,{id:"discount-value",type:"number",placeholder:"percentage"===am.discount_type?"0%":"0.00",value:am.discount_value,onChange:a=>an({...am,discount_value:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"customer-name",children:"Customer Name"}),(0,b.jsx)(i.Input,{id:"customer-name",placeholder:"Walk-in Customer",value:am.customer_name,onChange:a=>an({...am,customer_name:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"vehicle-number",children:"Vehicle Number"}),(0,b.jsx)(i.Input,{id:"vehicle-number",placeholder:"KAA 123A",value:am.vehicle_number,onChange:a=>an({...am,vehicle_number:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"is-loyalty",checked:am.is_loyalty_sale,onChange:a=>an({...am,is_loyalty_sale:a.target.checked}),className:"h-4 w-4"}),(0,b.jsx)(j.Label,{htmlFor:"is-loyalty",children:"Loyalty Customer"})]}),am.is_loyalty_sale&&(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Select Loyalty Customer"}),(0,b.jsxs)(v.Popover,{open:ak,onOpenChange:al,children:[(0,b.jsx)(v.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(h.Button,{variant:"outline",role:"combobox",className:"w-full justify-between",children:[am.loyalty_customer_name||"Select customer...",(0,b.jsx)(w.ChevronsUpDown,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,b.jsx)(v.PopoverContent,{className:"w-full p-0",children:(0,b.jsxs)(u.Command,{children:[(0,b.jsx)(u.CommandInput,{placeholder:"Search customer..."}),(0,b.jsxs)(u.CommandList,{children:[(0,b.jsx)(u.CommandEmpty,{children:"No customer found."}),(0,b.jsx)(u.CommandGroup,{children:ai.map(a=>(0,b.jsxs)(u.CommandItem,{value:a.name,onSelect:()=>{an({...am,loyalty_customer_name:a.name,loyalty_customer_pin:a.pin}),al(!1)},children:[(0,b.jsx)(x.Check,{className:(0,y.cn)("mr-2 h-4 w-4",am.loyalty_customer_name===a.name?"opacity-100":"opacity-0")}),a.name," (",a.pin,")"]},a.id))})]})]})})]})]})]}),(0,b.jsxs)(f.DialogFooter,{children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),(0,b.jsx)(h.Button,{onClick:au,disabled:Y,children:"Record Sale"})]})]})}),(0,b.jsx)(t.ShiftManagementDialog,{open:ae,onOpenChange:af,currentShift:W,onShiftEnded:()=>{X(null),as()}})]})}function M(){let[a,f]=(0,c.useState)(!1);return(0,b.jsxs)("div",{className:"flex min-h-screen bg-gradient-to-b from-slate-900 via-blue-900 to-white",children:[(0,b.jsx)(d.DashboardSidebar,{collapsed:a,onToggle:()=>f(!a)}),(0,b.jsx)("div",{className:"flex-1 flex flex-col ml-8 my-6 mr-6",children:(0,b.jsxs)("div",{className:"bg-white rounded-tl-3xl shadow-2xl flex-1 flex flex-col overflow-hidden",children:[(0,b.jsx)(e.DashboardHeader,{}),(0,b.jsx)("main",{className:"flex-1 overflow-y-auto bg-slate-50 p-6",children:(0,b.jsxs)("div",{className:"mx-auto max-w-7xl space-y-6",children:[(0,b.jsx)(L,{}),(0,b.jsxs)("footer",{className:"mt-12 border-t pt-6 pb-4 text-center text-sm text-muted-foreground",children:["Powered by ",(0,b.jsx)("span",{className:"font-semibold text-foreground",children:"Sensile Technologies East Africa Ltd"})]})]})})]})})]})}a.s(["default",()=>M],14459)}];

//# sourceMappingURL=app_sales_summary_page_tsx_feca58b5._.js.map