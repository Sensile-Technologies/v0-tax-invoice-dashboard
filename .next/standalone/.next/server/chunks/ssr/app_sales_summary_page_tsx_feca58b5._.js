module.exports=[14459,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(344),e=a.i(69265),f=a.i(65733),g=a.i(3130),h=a.i(40695),i=a.i(5522),j=a.i(17171),k=a.i(87682),l=a.i(76504),m=a.i(23292),n=a.i(92e3),o=a.i(5784),p=a.i(187),q=a.i(97895);let r=(0,p.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function s({className:a,variant:c,...d}){return(0,b.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,q.cn)(r({variant:c}),a),...d})}function t({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"alert-description",className:(0,q.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a),...c})}var u=a.i(74575),v=a.i(46893),w=a.i(46470),x=a.i(29154),y=a.i(30342),z=a.i(37539),A=a.i(33441),B=a.i(554),C=a.i(77071),D=a.i(28792),E=a.i(97210),F=a.i(70647),G=a.i(77368),H=a.i(30159);function I(a){var b=(0,G.useAppDispatch)();return(0,c.useEffect)(()=>{b((0,H.updatePolarOptions)(a))},[b,a]),null}var J=a.i(34962),K=a.i(87293),L=["layout"];function M(){return(M=Object.assign.bind()).apply(null,arguments)}var N={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},O=(0,c.forwardRef)(function(a,b){var d,e=(0,K.resolveDefaultProps)(a.categoricalChartProps,N),{layout:f}=e,g=function(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c={};for(var d in a)if(({}).hasOwnProperty.call(a,d)){if(-1!==b.indexOf(d))continue;c[d]=a[d]}return c}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],-1===b.indexOf(c)&&({}).propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}(e,L),{chartName:h,defaultTooltipEventType:i,validateTooltipEventTypes:j,tooltipPayloadSearcher:k}=a;return c.createElement(C.RechartsStoreProvider,{preloadedState:{options:{chartName:h,defaultTooltipEventType:i,validateTooltipEventTypes:j,tooltipPayloadSearcher:k,eventEmitter:void 0}},reduxStoreName:null!=(d=e.id)?d:h},c.createElement(D.ChartDataContextProvider,{chartData:e.data}),c.createElement(E.ReportMainChartProps,{layout:f,margin:e.margin}),c.createElement(F.ReportChartProps,{baseValue:void 0,accessibilityLayer:e.accessibilityLayer,barCategoryGap:e.barCategoryGap,maxBarSize:e.maxBarSize,stackOffset:e.stackOffset,barGap:e.barGap,barSize:e.barSize,syncId:e.syncId,syncMethod:e.syncMethod,className:e.className,reverseStackOrder:e.reverseStackOrder}),c.createElement(I,{cx:e.cx,cy:e.cy,startAngle:e.startAngle,endAngle:e.endAngle,innerRadius:e.innerRadius,outerRadius:e.outerRadius}),c.createElement(J.CategoricalChart,M({},g,{ref:b})))});function P(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function Q(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?P(Object(c),!0).forEach(function(b){var d,e,f;d=a,e=b,f=c[b],(e=function(a){var b=function(a,b){if("object"!=typeof a||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=typeof d)return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==typeof b?b:b+""}(e))in d?Object.defineProperty(d,e,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[e]=f}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):P(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}var R=["item"],S=Q(Q({},N),{},{layout:"centric",startAngle:0,endAngle:360}),T=(0,c.forwardRef)((a,b)=>{var d=(0,K.resolveDefaultProps)(a,S);return c.createElement(O,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:R,tooltipPayloadSearcher:B.arrayTooltipSearcher,categoricalChartProps:d,ref:b})}),U=a.i(88804),V=a.i(98621),W=a.i(44381),X=a.i(98563),Y=a.i(1351),Z=a.i(56295),$=a.i(12168),_=a.i(98382),aa=a.i(44407),ab=a.i(41386),ac=a.i(51434),ad=a=>a.graphicalItems.polarItems,ae=(0,W.createSelector)([aa.pickAxisType,ab.pickAxisId],$.itemAxisPredicate),af=(0,W.createSelector)([ad,$.selectBaseAxis,ae],$.combineGraphicalItemsSettings),ag=(0,W.createSelector)([af],$.combineGraphicalItemsData),ah=(0,W.createSelector)([ag,X.selectChartDataAndAlwaysIgnoreIndexes],$.combineDisplayedData),ai=(0,W.createSelector)([ah,$.selectBaseAxis,af],$.combineAppliedValues);(0,W.createSelector)([ah,$.selectBaseAxis,af],(a,b,c)=>c.length>0?a.flatMap(a=>c.flatMap(c=>{var d;return{value:(0,Z.getValueByDataKey)(a,null!=(d=b.dataKey)?d:c.dataKey),errorDomain:[]}})).filter(Boolean):(null==b?void 0:b.dataKey)!=null?a.map(a=>({value:(0,Z.getValueByDataKey)(a,b.dataKey),errorDomain:[]})):a.map(a=>({value:a,errorDomain:[]})));var aj=()=>void 0,ak=(0,W.createSelector)([ah,$.selectBaseAxis,af,$.selectAllErrorBarSettings,aa.pickAxisType],$.combineDomainOfAllAppliedNumericalValuesIncludingErrorValues),al=(0,W.createSelector)([$.selectBaseAxis,$.selectDomainDefinition,$.selectDomainFromUserPreference,aj,ak,aj,_.selectChartLayout,aa.pickAxisType],$.combineNumericalDomain),am=(0,W.createSelector)([$.selectBaseAxis,_.selectChartLayout,ah,ai,ac.selectStackOffsetType,aa.pickAxisType,al],$.combineAxisDomain),an=(0,W.createSelector)([am,$.selectBaseAxis,$.selectRealScaleType],$.combineNiceTicks);function ao(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function ap(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?ao(Object(c),!0).forEach(function(b){var d,e,f;d=a,e=b,f=c[b],(e=function(a){var b=function(a,b){if("object"!=typeof a||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=typeof d)return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==typeof b?b:b+""}(e))in d?Object.defineProperty(d,e,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[e]=f}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):ao(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}(0,W.createSelector)([$.selectBaseAxis,am,an,aa.pickAxisType],$.combineAxisDomainWithNiceTicks);var aq=(0,W.createSelector)([ad,(a,b)=>b],(a,b)=>a.filter(a=>"pie"===a.type).find(a=>a.id===b)),ar=[],as=(a,b,c)=>(null==c?void 0:c.length)===0?ar:c,at=(0,W.createSelector)([X.selectChartDataAndAlwaysIgnoreIndexes,aq,as],(a,b,c)=>{var d,{chartData:e}=a;if(null!=b&&((d=(null==b?void 0:b.data)!=null&&b.data.length>0?b.data:e)&&d.length||null==c||(d=c.map(a=>ap(ap({},b.presentationProps),a.props))),null!=d))return d}),au=(0,W.createSelector)([at,aq,as],(a,b,c)=>{if(null!=a&&null!=b)return a.map((a,d)=>{var e,f,g=(0,Z.getValueByDataKey)(a,b.nameKey,b.name);return f=null!=c&&null!=(e=c[d])&&null!=(e=e.props)&&e.fill?c[d].props.fill:"object"==typeof a&&null!=a&&"fill"in a?a.fill:b.fill,{value:(0,Z.getTooltipNameProp)(g,b.dataKey),color:f,payload:a,type:b.legendType}})}),av=(0,W.createSelector)([at,aq,as,Y.selectChartOffsetInternal],(a,b,c,d)=>{if(null!=b&&null!=a)return function(a){var b,c,d,{pieSettings:e,displayedData:f,cells:g,offset:h}=a,{cornerRadius:i,startAngle:j,endAngle:k,dataKey:l,nameKey:m,tooltipType:n}=e,o=Math.abs(e.minAngle),p=(0,aC.mathSign)(k-j)*Math.min(Math.abs(k-j),360),q=Math.abs(p),r=f.length<=1?0:null!=(b=e.paddingAngle)?b:0,s=f.filter(a=>0!==(0,Z.getValueByDataKey)(a,l,0)).length,t=q-s*o-(q>=360?s:s-1)*r,u=f.reduce((a,b)=>{var c=(0,Z.getValueByDataKey)(b,l,0);return a+((0,aC.isNumber)(c)?c:0)},0);return u>0&&(c=f.map((a,b)=>{var c,f=(0,Z.getValueByDataKey)(a,l,0),k=(0,Z.getValueByDataKey)(a,m,b),q=((a,b,c)=>{var d,{top:e,left:f,width:g,height:h}=b,i=(0,aB.getMaxRadius)(g,h),j=f+(0,aC.getPercentValue)(a.cx,g,g/2),k=e+(0,aC.getPercentValue)(a.cy,h,h/2),l=(0,aC.getPercentValue)(a.innerRadius,i,0);return{cx:j,cy:k,innerRadius:l,outerRadius:(d=a.outerRadius,"function"==typeof d?(0,aC.getPercentValue)(d(c),i,.8*i):(0,aC.getPercentValue)(d,i,.8*i)),maxRadius:a.maxRadius||Math.sqrt(g*g+h*h)/2}})(e,h,a),s=((0,aC.isNumber)(f)?f:0)/u,v=aX(aX({},a),g&&g[b]&&g[b].props),w=(c=b?d.endAngle+(0,aC.mathSign)(p)*r*(0!==f):j)+(0,aC.mathSign)(p)*((0!==f?o:0)+s*t),x=(c+w)/2,y=(q.innerRadius+q.outerRadius)/2,z=[{name:k,value:f,payload:v,dataKey:l,type:n}],A=(0,aB.polarToCartesian)(q.cx,q.cy,y,x);return d=aX(aX(aX(aX({},e.presentationProps),{},{percent:s,cornerRadius:"string"==typeof i?parseFloat(i):i,name:k,tooltipPayload:z,midAngle:x,middleRadius:y,tooltipPosition:A},v),q),{},{value:f,dataKey:l,startAngle:c,endAngle:w,payload:v,paddingAngle:(0,aC.mathSign)(p)*r})})),c}({offset:d,pieSettings:b,displayedData:a,cells:c})}),aw=a.i(88949),ax=a.i(13667),ay=a.i(20299),az=a.i(67149),aA=a.i(37082),aB=a.i(30261),aC=a.i(68932),aD=a.i(52517),aE=a.i(56998),aF=a.i(89205),aG=a.i(12791),aH=a.i(86505),aI=a.i(92430),aJ=a.i(5911),aK=a.i(62320),aL=a.i(46780),aM=a.i(77025),aN=a.i(72853),aO=a.i(78437),aP=a.i(36319),aQ=a.i(96268),aR=a.i(31080),aS=["key"],aT=["onMouseEnter","onClick","onMouseLeave"],aU=["id"],aV=["id"];function aW(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function aX(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?aW(Object(c),!0).forEach(function(b){var d,e,f;d=a,e=b,f=c[b],(e=function(a){var b=function(a,b){if("object"!=typeof a||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=typeof d)return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==typeof b?b:b+""}(e))in d?Object.defineProperty(d,e,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[e]=f}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):aW(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function aY(){return(aY=Object.assign.bind()).apply(null,arguments)}function aZ(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c={};for(var d in a)if(({}).hasOwnProperty.call(a,d)){if(-1!==b.indexOf(d))continue;c[d]=a[d]}return c}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],-1===b.indexOf(c)&&({}).propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}function a$(a){var b=(0,c.useMemo)(()=>(0,aA.findAllByType)(a.children,az.Cell),[a.children]),d=(0,G.useAppSelector)(c=>au(c,a.id,b));return null==d?null:c.createElement(aI.SetPolarLegendPayload,{legendPayload:d})}var a_=c.memo(a=>{var{dataKey:b,nameKey:d,sectors:e,stroke:f,strokeWidth:g,fill:h,name:i,hide:j,tooltipType:k}=a,l={dataDefinedOnItem:e.map(a=>a.tooltipPayload),positions:e.map(a=>a.tooltipPosition),settings:{stroke:f,strokeWidth:g,fill:h,dataKey:b,nameKey:d,name:(0,Z.getTooltipNameProp)(i,b),hide:j,type:k,color:h,unit:""}};return c.createElement(aG.SetTooltipEntrySettings,{tooltipEntrySettings:l})});function a0(a){var{sectors:b,props:d,showLabels:e}=a,{label:f,labelLine:g,dataKey:h}=d;if(!e||!f||!b)return null;var i=(0,aN.svgPropertiesNoEvents)(d),j=(0,aN.svgPropertiesNoEventsFromUnknown)(f),k=(0,aN.svgPropertiesNoEventsFromUnknown)(g),l="object"==typeof f&&"offsetRadius"in f&&"number"==typeof f.offsetRadius&&f.offsetRadius||20,m=b.map((a,b)=>{var d,e,m=(a.startAngle+a.endAngle)/2,n=(0,aB.polarToCartesian)(a.cx,a.cy,a.outerRadius+l,m),o=aX(aX(aX(aX({},i),a),{},{stroke:"none"},j),{},{index:b,textAnchor:(d=n.x)>(e=a.cx)?"start":d<e?"end":"middle"},n),p=aX(aX(aX(aX({},i),a),{},{fill:"none",stroke:a.fill},k),{},{index:b,points:[(0,aB.polarToCartesian)(a.cx,a.cy,a.outerRadius,m),n],key:"line"});return c.createElement(aQ.ZIndexLayer,{zIndex:aR.DefaultZIndexes.label,key:"label-".concat(a.startAngle,"-").concat(a.endAngle,"-").concat(a.midAngle,"-").concat(b)},c.createElement(aw.Layer,null,g&&((a,b)=>{if(c.isValidElement(a))return c.cloneElement(a,b);if("function"==typeof a)return a(b);var d=(0,V.clsx)("recharts-pie-label-line","boolean"!=typeof a?a.className:""),{key:e}=b,f=aZ(b,aS);return c.createElement(ax.Curve,aY({},f,{type:"linear",className:d}))})(g,p),((a,b,d)=>{if(c.isValidElement(a))return c.cloneElement(a,b);var e=d;if("function"==typeof a&&(e=a(b),c.isValidElement(e)))return e;var f=(0,V.clsx)("recharts-pie-label-text",a&&"object"==typeof a&&"className"in a&&"string"==typeof a.className?a.className:"");return c.createElement(ay.Text,aY({},b,{alignmentBaseline:"middle",className:f}),e)})(f,o,(0,Z.getValueByDataKey)(a,h))))});return c.createElement(aw.Layer,{className:"recharts-pie-labels"},m)}function a1(a){var{sectors:b,props:d,showLabels:e}=a,{label:f}=d;return"object"==typeof f&&null!=f&&"position"in f?c.createElement(aP.LabelListFromLabelProp,{label:f}):c.createElement(a0,{sectors:b,props:d,showLabels:e})}function a2(a){var{sectors:b,activeShape:d,inactiveShape:e,allOtherPieProps:f,shape:g,id:h}=a,i=(0,G.useAppSelector)(aH.selectActiveTooltipIndex),j=(0,G.useAppSelector)(aH.selectActiveTooltipDataKey),k=(0,G.useAppSelector)(aH.selectActiveTooltipGraphicalItemId),{onMouseEnter:l,onClick:m,onMouseLeave:n}=f,o=aZ(f,aT),p=(0,aF.useMouseEnterItemDispatch)(l,f.dataKey,h),q=(0,aF.useMouseLeaveItemDispatch)(n),r=(0,aF.useMouseClickItemDispatch)(m,f.dataKey,h);return null==b||0===b.length?null:c.createElement(c.Fragment,null,b.map((a,l)=>{if((null==a?void 0:a.startAngle)===0&&(null==a?void 0:a.endAngle)===0&&1!==b.length)return null;var m=null==k||k===h,n=String(l)===i&&(null==j||f.dataKey===j)&&m,s=d&&n?d:i?e:null,t=aX(aX({},a),{},{stroke:a.stroke,tabIndex:-1,[aJ.DATA_ITEM_INDEX_ATTRIBUTE_NAME]:l,[aJ.DATA_ITEM_DATAKEY_ATTRIBUTE_NAME]:f.dataKey});return c.createElement(aw.Layer,aY({key:"sector-".concat(null==a?void 0:a.startAngle,"-").concat(null==a?void 0:a.endAngle,"-").concat(a.midAngle,"-").concat(l),tabIndex:-1,className:"recharts-pie-sector"},(0,aD.adaptEventsOfChild)(o,a,l),{onMouseEnter:p(a,l),onMouseLeave:q(a,l),onClick:r(a,l)}),c.createElement(aE.Shape,aY({option:null!=g?g:s,index:l,shapeType:"sector",isActive:n},t)))}))}function a3(a){var{showLabels:b,sectors:d,children:e}=a,f=(0,c.useMemo)(()=>b&&d?d.map(a=>({value:a.value,payload:a.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:a.cx,cy:a.cy,innerRadius:a.innerRadius,outerRadius:a.outerRadius,startAngle:a.startAngle,endAngle:a.endAngle,clockWise:!1},fill:a.fill})):[],[d,b]);return c.createElement(aP.PolarLabelListContextProvider,{value:b?f:void 0},e)}function a4(a){var{props:b,previousSectorsRef:d,id:e}=a,{sectors:f,isAnimationActive:g,animationBegin:h,animationDuration:i,animationEasing:j,activeShape:k,inactiveShape:l,onAnimationStart:m,onAnimationEnd:n}=b,o=(0,aK.useAnimationId)(b,"recharts-pie-"),p=d.current,[q,r]=(0,c.useState)(!1),s=(0,c.useCallback)(()=>{"function"==typeof n&&n(),r(!1)},[n]),t=(0,c.useCallback)(()=>{"function"==typeof m&&m(),r(!0)},[m]);return c.createElement(a3,{showLabels:!q,sectors:f},c.createElement(aO.JavascriptAnimate,{animationId:o,begin:h,duration:i,isActive:g,easing:j,onAnimationStart:t,onAnimationEnd:s,key:o},a=>{var g=[],h=f&&f[0],i=null==h?void 0:h.startAngle;return null==f||f.forEach((b,c)=>{var d=p&&p[c],e=c>0?(0,U.default)(b,"paddingAngle",0):0;if(d){var f=(0,aC.interpolate)(d.endAngle-d.startAngle,b.endAngle-b.startAngle,a),h=aX(aX({},b),{},{startAngle:i+e,endAngle:i+f+e});g.push(h),i=h.endAngle}else{var{endAngle:j,startAngle:k}=b,l=(0,aC.interpolate)(0,j-k,a),m=aX(aX({},b),{},{startAngle:i+e,endAngle:i+l+e});g.push(m),i=m.endAngle}}),d.current=g,c.createElement(aw.Layer,null,c.createElement(a2,{sectors:g,activeShape:k,inactiveShape:l,allOtherPieProps:b,shape:b.shape,id:e}))}),c.createElement(a1,{showLabels:!q,sectors:f,props:b}),b.children)}var a5={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:aR.DefaultZIndexes.area};function a6(a){var{id:b}=a,d=aZ(a,aU),{hide:e,className:f,rootTabIndex:g}=a,h=(0,c.useMemo)(()=>(0,aA.findAllByType)(a.children,az.Cell),[a.children]),i=(0,G.useAppSelector)(a=>av(a,b,h)),j=(0,c.useRef)(null),k=(0,V.clsx)("recharts-pie",f);return e||null==i?(j.current=null,c.createElement(aw.Layer,{tabIndex:g,className:k})):c.createElement(aQ.ZIndexLayer,{zIndex:a.zIndex},c.createElement(a_,{dataKey:a.dataKey,nameKey:a.nameKey,sectors:i,stroke:a.stroke,strokeWidth:a.strokeWidth,fill:a.fill,name:a.name,hide:a.hide,tooltipType:a.tooltipType}),c.createElement(aw.Layer,{tabIndex:g,className:k},c.createElement(a4,{props:aX(aX({},d),{},{sectors:i}),previousSectorsRef:j,id:b})))}function a7(a){var b=(0,K.resolveDefaultProps)(a,a5),{id:d}=b,e=aZ(b,aV),f=(0,aN.svgPropertiesNoEvents)(e);return c.createElement(aL.RegisterGraphicalItemId,{id:d,type:"pie"},a=>c.createElement(c.Fragment,null,c.createElement(aM.SetPolarGraphicalItem,{type:"pie",id:a,data:e.data,dataKey:e.dataKey,hide:e.hide,angleAxisId:0,radiusAxisId:0,name:e.name,nameKey:e.nameKey,tooltipType:e.tooltipType,legendType:e.legendType,fill:e.fill,cx:e.cx,cy:e.cy,startAngle:e.startAngle,endAngle:e.endAngle,paddingAngle:e.paddingAngle,minAngle:e.minAngle,innerRadius:e.innerRadius,outerRadius:e.outerRadius,cornerRadius:e.cornerRadius,presentationProps:f,maxRadius:b.maxRadius}),c.createElement(a$,aY({},e,{id:a})),c.createElement(a6,aY({},e,{id:a}))))}a7.displayName="Pie";var a8=a.i(18155),a9=a.i(23665),ba=a.i(58042),bb=a.i(94222),bc=a.i(54419),bd=a.i(59854),be=a.i(48662),bf=a.i(54031),bg=a.i(77924);function bh(){let a,d,e,p,r,{formatCurrency:B}=(0,u.useCurrency)(),[C,D]=(0,c.useState)([]),[E,F]=(0,c.useState)([]),[G,H]=(0,c.useState)([]),[I,J]=(0,c.useState)([]),[K,L]=(0,c.useState)([]),[M,N]=(0,c.useState)({}),[O,P]=(0,c.useState)({}),[Q,R]=(0,c.useState)({}),[S,U]=(0,c.useState)({}),[V,W]=(0,c.useState)({}),[X,Y]=(0,c.useState)(null),[Z,$]=(0,c.useState)(!1),[_,aa]=(0,c.useState)(!1),[ab,ac]=(0,c.useState)(!1),[ad,ae]=(0,c.useState)(!1),[af,ag]=(0,c.useState)(null),[ah,ai]=(0,c.useState)(null),[aj,ak]=(0,c.useState)([]),[al,am]=(0,c.useState)(!1),[an,ao]=(0,c.useState)(null),[ap,aq]=(0,c.useState)({nozzle_id:"",fuel_type:"",amount:"",payment_method:"cash",customer_name:"",vehicle_number:"",customer_pin:"",meter_reading_after:"",is_loyalty_sale:!1,loyalty_customer_name:"",loyalty_customer_pin:"",discount_type:"fixed",discount_value:""}),[ar,as]=(0,c.useState)({date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),closing_cash:"",notes:""}),[at,au]=(0,c.useState)(!1),[av,aw]=(0,c.useState)(!1),[ax,ay]=(0,c.useState)(!1),[aA,aB]=(0,c.useState)(null),[aC,aD]=(0,c.useState)(!1),[aE,aF]=(0,c.useState)({amount:"",nozzle_id:"",customer_pin:"",payment_method:"cash",discount_type:"fixed",discount_value:"",is_loyalty_sale:!1,loyalty_customer_id:"",loyalty_customer_name:"",loyalty_customer_pin:""});async function aG(){try{$(!0);let a=localStorage.getItem("selectedBranch");if(!a){m.toast.error("No branch selected"),$(!1);return}let b=JSON.parse(a).id,[c,d,e,f,g]=await Promise.all([fetch(`/api/nozzles?branch_id=${b}&status=active`),fetch(`/api/dispensers?branch_id=${b}`),fetch(`/api/fuel-prices?branch_id=${b}`),fetch(`/api/shifts?branch_id=${b}&status=active`),fetch(`/api/tanks?branch_id=${b}`)]),[h,i,j,k,l]=await Promise.all([c.json(),d.json(),e.json(),f.json(),g.json()]);h.success&&F(h.data||[]),i.success&&J(i.data||[]),j.success&&L(j.data||[]),l.success&&H(l.data||[]),k.success&&k.data?(Y(k.data),await aH(k.data.id)):(Y(null),D([]))}catch(a){console.error("Error fetching data:",a),m.toast.error("Failed to load sales data")}finally{$(!1)}}async function aH(a){try{let a=localStorage.getItem("selectedBranch");if(!a)return;let b=JSON.parse(a).id,c=new Date().toISOString().split("T")[0],d=`/api/sales?branch_id=${b}&limit=100&start_date=${c}`,e=await fetch(d),f=await e.json();if(f.success){let a=(f.data||[]).map(a=>({...a,quantity:Number(a.quantity)||0,unit_price:Number(a.unit_price)||0,total_amount:Number(a.total_amount)||0,meter_reading_after:Number(a.meter_reading_after)||0,loyalty_points_earned:Number(a.loyalty_points_earned)||0}));D(a)}}catch(a){console.error("Error fetching sales:",a)}}async function aI(){if(!ap.nozzle_id||!ap.fuel_type||!ap.amount)return void m.toast.error("Please fill in all required fields");if(!X)return void m.toast.error("Please start a shift before recording sales");aa(!0);try{let a=localStorage.getItem("selectedBranch");if(!a){m.toast.error("No branch selected"),aa(!1);return}let b=JSON.parse(a).id,c=K.find(a=>a.fuel_type===ap.fuel_type);if(!c){m.toast.error(`No price configured for ${ap.fuel_type}`),aa(!1);return}let d=Number.parseFloat(ap.amount),e=Number.parseFloat(c.price),f=0;if(ap.discount_value&&Number.parseFloat(ap.discount_value)>0)if("percentage"===ap.discount_type){let a=Math.min(Number.parseFloat(ap.discount_value),100);f=d*a/100}else f=Math.min(Number.parseFloat(ap.discount_value),d);let g=Math.max(d-f,0),h=g/e,i=`INV-${Date.now()}`,j=`RCP-${Date.now()}`,k=await fetch("/api/sales",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch_id:b,shift_id:X.id,nozzle_id:ap.nozzle_id,fuel_type:ap.fuel_type,quantity:h,unit_price:e,total_amount:g,payment_method:ap.payment_method,customer_name:ap.customer_name||null,vehicle_number:ap.vehicle_number||null,customer_pin:ap.customer_pin||null,invoice_number:i,meter_reading_after:0,transmission_status:"pending",receipt_number:j,is_loyalty_sale:ap.is_loyalty_sale,loyalty_customer_name:ap.is_loyalty_sale?ap.loyalty_customer_name:null,loyalty_customer_pin:ap.is_loyalty_sale?ap.loyalty_customer_pin:null})}),l=await k.json();if(k.ok&&l.success){let a=l.data;try{let c=await fetch("/api/kra/test-sale",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch_id:b,invoice_number:a.invoice_number,receipt_number:a.receipt_number,fuel_type:ap.fuel_type,quantity:h,unit_price:e,total_amount:g,payment_method:ap.payment_method,customer_name:ap.customer_name||"Walk-in Customer",customer_pin:ap.customer_pin||""})}),d=await c.json();console.log("KRA API Response:",JSON.stringify(d,null,2))}catch(a){console.error("Error calling KRA endpoint:",a)}m.toast.success("Sale recorded successfully!"),aq({nozzle_id:"",fuel_type:"",amount:"",payment_method:"cash",customer_name:"",vehicle_number:"",customer_pin:"",meter_reading_after:"",is_loyalty_sale:!1,loyalty_customer_name:"",loyalty_customer_pin:"",discount_type:"fixed",discount_value:""}),ac(!1),aa(!1),aH(X?.id).catch(console.error);return}console.error("Sale creation error:",l.error),m.toast.error(`Error recording sale: ${l.error||"Unknown error"}`)}catch(a){console.error("Sale creation error:",a),m.toast.error("Failed to record sale")}finally{aa(!1)}}async function aJ(){if(!ar.date||!ar.time)return void m.toast.error("Please select date and time");au(!0);try{let a=localStorage.getItem("selectedBranch");if(!a){m.toast.error("No branch selected. Please select a branch from the header."),au(!1);return}let b=JSON.parse(a).id,c=new Date(`${ar.date}T${ar.time}`),d={branch_id:b,start_time:c.toISOString(),status:"active",opening_cash:0,notes:ar.notes||null,user_id:an},e=await fetch("/api/shifts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),f=await e.json();if(e.ok&&f.success)m.toast.success("Shift started successfully"),Y(f.data),ae(!1),as({date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),closing_cash:"",notes:""});else if(f.error?.includes("active shift already exists")){let a=await fetch(`/api/shifts?branch_id=${b}&status=active`),c=await a.json();c.success&&c.data?(Y(c.data),await aH(c.data.id),m.toast.info("Using existing active shift"),ae(!1)):m.toast.error("An active shift exists but couldn't be loaded. Please refresh the page.")}else console.error("Error starting shift:",f.error),m.toast.error(`Failed to start shift: ${f.error||"Unknown error"}`)}catch(a){console.error("Error starting shift:",a),m.toast.error(`Failed to start shift: ${a instanceof Error?a.message:"Unknown error"}`)}finally{au(!1)}}async function aK(){if(!X)return void m.toast.error("No active shift to end");au(!0);try{let a=C.reduce((a,b)=>a+(parseFloat(b.total_amount)||0),0),b=Object.entries(M).filter(([a,b])=>""!==b).map(([a,b])=>({nozzle_id:a,closing_reading:parseFloat(b)})),c=Object.entries(O).filter(([a,b])=>""!==b).map(([a,b])=>({tank_id:a,closing_reading:parseFloat(b),stock_received:parseFloat(Q[a]||"0")||0})),d=await fetch("/api/shifts",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:X.id,end_time:new Date().toISOString(),status:"completed",closing_cash:ar.closing_cash?Number.parseFloat(ar.closing_cash):0,total_sales:a,notes:ar.notes||null,nozzle_readings:b,tank_stocks:c})}),e=await d.json();d.ok&&e.success?(m.toast.success("Shift ended & new shift started"),e.newShift&&Y(e.newShift),ae(!1),as({date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().slice(0,5),closing_cash:"",notes:""}),N({}),P({}),R({}),aG()):(console.error("Error ending shift:",e.error),m.toast.error(e.error||"Failed to end shift"))}catch(a){console.error("Error ending shift:",a),m.toast.error("Failed to end shift")}finally{au(!1)}}async function aL(a){if(ag(a),ae(!0),"end"===a&&ah?.id)try{let a=await fetch(`/api/shifts/baselines?branch_id=${ah.id}`),b=await a.json();b.success&&(U(b.nozzleBaselines||{}),W(b.tankBaselines||{}))}catch(a){console.error("Error fetching baselines:",a)}}(0,c.useEffect)(()=>{!async function(){try{let a=await fetch("/api/auth/session",{credentials:"include"});if(a.ok){let b=(await a.json()).user;if(b){ao(b.id);let a=(b.role||"").toLowerCase();if(["supervisor","manager","cashier"].includes(a)&&b.branch_id&&b.branch_name){let a={id:b.branch_id,name:b.branch_name,type:"branch",status:"active"};ai(a),localStorage.setItem("selectedBranch",JSON.stringify(a));return}let c=localStorage.getItem("selectedBranch");if(c)try{ai(JSON.parse(c))}catch(a){}return}}}catch(a){console.error("Error fetching session:",a)}let a=localStorage.getItem("flow360_user")||localStorage.getItem("user");if(a)try{let b=JSON.parse(a);if(ao(b.id),b.branch_id&&b.branch_name){let a={id:b.branch_id,name:b.branch_name,type:"branch",status:"active"};ai(a),localStorage.setItem("selectedBranch",JSON.stringify(a));return}}catch(a){console.error("Error parsing user data:",a)}let b=localStorage.getItem("selectedBranch");if(b)try{ai(JSON.parse(b))}catch(a){}}();let a=a=>{"selectedBranch"===a.key&&a.newValue&&ai(JSON.parse(a.newValue))},b=setInterval(()=>{let a=localStorage.getItem("selectedBranch");if(a)try{let b=JSON.parse(a);ai(a=>a?.id!==b.id?b:a)}catch(a){}},500);return window.addEventListener("storage",a),()=>{window.removeEventListener("storage",a),clearInterval(b)}},[]),(0,c.useEffect)(()=>{ah?.id&&aG()},[ah?.id]),(0,c.useEffect)(()=>{async function a(){try{let a=await fetch(`/api/customers?branch_id=${ah?.id}`),b=await a.json();b.success&&ak((b.data||[]).map(a=>({id:a.id,name:a.cust_nm||"",pin:a.cust_tin||""})))}catch(a){console.error("Error fetching loyalty customers:",a)}}ah?.id&&a()},[ah?.id]);let aM=X?new Date(X.start_time).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Unknown";async function aN(){if(!aE.amount||!aE.nozzle_id)return void m.toast.error("Please fill in amount and select a nozzle");let a=localStorage.getItem("selectedBranch");if(!a)return void m.toast.error("No branch selected");let b=JSON.parse(a),c=E.find(a=>a.id===aE.nozzle_id);if(!c)return void m.toast.error("Invalid nozzle selected");ay(!0),aB(null);try{let a=await fetch("/api/kra/issue-invoice",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch_id:b.id,amount:parseFloat(aE.amount),nozzle_id:aE.nozzle_id,fuel_type:c.fuel_type,customer_pin:aE.is_loyalty_sale?aE.loyalty_customer_pin:aE.customer_pin,payment_method:aE.payment_method,discount_type:aE.discount_type,discount_value:aE.discount_value?parseFloat(aE.discount_value):0,is_loyalty_sale:aE.is_loyalty_sale,loyalty_customer_name:aE.loyalty_customer_name})}),d=await a.json();if(d.success)m.toast.success("Invoice issued successfully! Check logs for details."),aw(!1),aB(null),aF({amount:"",nozzle_id:"",customer_pin:"",payment_method:"cash",discount_type:"fixed",discount_value:"",is_loyalty_sale:!1,loyalty_customer_id:"",loyalty_customer_name:"",loyalty_customer_pin:""}),aG();else{let a=d.error||"Failed to issue invoice";aB(a),m.toast.error(a)}}catch(b){console.error("Error issuing invoice:",b);let a=b?.message||"Failed to issue invoice";aB(a),m.toast.error(a)}finally{ay(!1)}}return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-slate-900",children:"Sales Summary"}),(0,b.jsx)("p",{className:"text-slate-600",children:"Overview of sales performance and trends"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(l.DropdownMenu,{children:[(0,b.jsx)(l.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(h.Button,{variant:"outline",children:["Shift Management ",(0,b.jsx)(o.ChevronDown,{className:"ml-2 h-4 w-4"})]})}),(0,b.jsxs)(l.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(l.DropdownMenuItem,{onClick:()=>aL("start"),disabled:!!X,children:"Start Shift"}),(0,b.jsx)(l.DropdownMenuItem,{onClick:()=>aL("end"),disabled:!X,children:"End Shift"})]})]}),(0,b.jsx)(h.Button,{onClick:()=>{aB(null),aw(!0)},variant:"default",className:"bg-blue-600 hover:bg-blue-700",children:"Issue Invoice"})]})]}),X?(0,b.jsx)(s,{className:"bg-green-50 border-green-200",children:(0,b.jsxs)(t,{className:"text-green-800",children:["Current ongoing shift started at ",aM]})}):(0,b.jsxs)(s,{className:"bg-amber-50 border-amber-200",children:[(0,b.jsx)(n.AlertCircle,{className:"h-4 w-4 text-amber-600"}),(0,b.jsx)(t,{className:"text-amber-800",children:"No active shift. Please start a shift before recording sales."})]}),C.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-4 mb-4",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-base text-black",children:"Sales by Fuel Type"}),(0,b.jsx)(g.CardDescription,{className:"text-xs text-black/70",children:"Revenue by fuel type"})]}),(0,b.jsx)(g.CardContent,{className:"pt-2",children:(0,b.jsx)(be.ResponsiveContainer,{width:"100%",height:220,children:(0,b.jsxs)(T,{children:[(0,b.jsx)(a7,{data:Object.entries(C.reduce((a,b)=>(a[b.fuel_type]=(a[b.fuel_type]||0)+b.total_amount,a),{})).map(([a,b])=>({name:a,value:b})),cx:"50%",cy:"50%",labelLine:!1,label:a=>{let{cx:c,cy:d,midAngle:e,innerRadius:f,outerRadius:g,percent:h,name:i}=a,j=f+(g-f)*.5,k=c+j*Math.cos(-(Math.PI/180*e)),l=d+j*Math.sin(-(Math.PI/180*e));return(0,b.jsx)("text",{x:k,y:l,fill:"#000000",textAnchor:k>c?"start":"end",dominantBaseline:"central",fontSize:"11",fontWeight:"500",children:`${i} ${(100*h).toFixed(0)}%`})},outerRadius:70,fill:"#8884d8",dataKey:"value",children:(a={Diesel:"#FFFF00",Petrol:"#FF0000",Unleaded:"#FF0000",Super:"#10B981"},Object.keys(C.reduce((a,b)=>(a[b.fuel_type]=(a[b.fuel_type]||0)+b.total_amount,a),{})).map((c,d)=>(0,b.jsx)(az.Cell,{fill:a[c]||"#6B7280"},`cell-${d}`)))}),(0,b.jsx)(bd.Tooltip,{formatter:a=>B(a),contentStyle:{color:"#000"}})]})})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-base text-black",children:"Payment Methods"}),(0,b.jsx)(g.CardDescription,{className:"text-xs text-black/70",children:"Payment breakdown"})]}),(0,b.jsx)(g.CardContent,{className:"pt-2",children:(0,b.jsx)(be.ResponsiveContainer,{width:"100%",height:220,children:(0,b.jsxs)(T,{children:[(0,b.jsx)(a7,{data:Object.entries(C.reduce((a,b)=>{let c,d="mpesa"===(c=(b.payment_method||"cash").toLowerCase())||"m-pesa"===c||"mobile_money"===c?"Mobile Money":"card"===c?"Card":"credit"===c?"Credit":"Cash";return a[d]=(a[d]||0)+b.total_amount,a},{})).map(([a,b])=>({name:a,value:b})),cx:"50%",cy:"50%",labelLine:!1,label:a=>{let{cx:c,cy:d,midAngle:e,innerRadius:f,outerRadius:g,percent:h,name:i}=a,j=f+(g-f)*.5,k=c+j*Math.cos(-(Math.PI/180*e)),l=d+j*Math.sin(-(Math.PI/180*e));return(0,b.jsx)("text",{x:k,y:l,fill:"#000000",textAnchor:k>c?"start":"end",dominantBaseline:"central",fontSize:"11",fontWeight:"500",children:`${"Mobile Money"===i?"M.Money":i} ${(100*h).toFixed(0)}%`})},outerRadius:70,fill:"#8884d8",dataKey:"value",children:(d={Cash:"#3A7085","Mobile Money":"#008C51",Card:"#F59E0B",Credit:"#EF4444"},Object.keys(C.reduce((a,b)=>{let c,d="mpesa"===(c=(b.payment_method||"cash").toLowerCase())||"m-pesa"===c||"mobile_money"===c?"Mobile Money":"card"===c?"Card":"credit"===c?"Credit":"Cash";return a[d]=(a[d]||0)+b.total_amount,a},{})).map((a,c)=>(0,b.jsx)(az.Cell,{fill:d[a]||"#6B7280"},`cell-${c}`)))}),(0,b.jsx)(bd.Tooltip,{formatter:a=>B(a),contentStyle:{color:"#000"}})]})})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-base text-black",children:"Loyalty Program"}),(0,b.jsx)(g.CardDescription,{className:"text-xs text-black/70",children:"Loyalty vs Walk-in sales"})]}),(0,b.jsx)(g.CardContent,{className:"pt-2",children:(0,b.jsx)(be.ResponsiveContainer,{width:"100%",height:220,children:(0,b.jsxs)(T,{children:[(0,b.jsxs)(a7,{data:[{name:"Loyalty",value:C.filter(a=>a.is_loyalty_sale).reduce((a,b)=>a+b.total_amount,0)},{name:"Walk-in",value:C.filter(a=>!a.is_loyalty_sale).reduce((a,b)=>a+b.total_amount,0)}],cx:"50%",cy:"50%",labelLine:!1,label:a=>{let{cx:c,cy:d,midAngle:e,innerRadius:f,outerRadius:g,percent:h,name:i}=a,j=f+(g-f)*.5,k=c+j*Math.cos(-(Math.PI/180*e)),l=d+j*Math.sin(-(Math.PI/180*e));return(0,b.jsx)("text",{x:k,y:l,fill:"#000000",textAnchor:k>c?"start":"end",dominantBaseline:"central",fontSize:"11",fontWeight:"500",children:`${i} ${(100*h).toFixed(0)}%`})},outerRadius:70,fill:"#8884d8",dataKey:"value",children:[(0,b.jsx)(az.Cell,{fill:"#C8A2C8"}),(0,b.jsx)(az.Cell,{fill:"#87CEEB"})]}),(0,b.jsx)(bd.Tooltip,{formatter:a=>B(a),contentStyle:{color:"#000"}})]})})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{className:"pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-base text-black",children:"Revenue vs VAT"}),(0,b.jsx)(g.CardDescription,{className:"text-xs text-black/70",children:"Month-to-date comparison"})]}),(0,b.jsx)(g.CardContent,{className:"pt-2",children:(0,b.jsx)(be.ResponsiveContainer,{width:"100%",height:220,children:(0,b.jsxs)(a8.BarChart,{data:(p=new Date((e=new Date).getFullYear(),e.getMonth(),1),[{name:"Revenue",value:r=C.filter(a=>new Date(a.sale_date)>=p).reduce((a,b)=>a+b.total_amount,0)},{name:"VAT",value:.16*r}]),margin:{top:5,right:5,left:5,bottom:5},children:[(0,b.jsx)(bc.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(ba.XAxis,{dataKey:"name",tick:{fill:"#000",fontSize:11}}),(0,b.jsx)(bb.YAxis,{tick:{fill:"#000",fontSize:10}}),(0,b.jsx)(bd.Tooltip,{formatter:a=>B(a),contentStyle:{color:"#000"}}),(0,b.jsxs)(a9.Bar,{dataKey:"value",children:[(0,b.jsx)(az.Cell,{fill:"#15426D"}),(0,b.jsx)(az.Cell,{fill:"#D55402"})]})]})})})]})]}),(0,b.jsxs)(g.Card,{className:"rounded-2xl md:col-span-2",children:[(0,b.jsxs)(g.CardHeader,{className:"pb-2",children:[(0,b.jsx)(g.CardTitle,{className:"text-base text-black",children:"Daily Sales Trend"}),(0,b.jsx)(g.CardDescription,{className:"text-xs text-black/70",children:"Sales per product over 7 days"})]}),(0,b.jsx)(g.CardContent,{className:"pt-2",children:(0,b.jsx)(be.ResponsiveContainer,{width:"100%",height:220,children:(0,b.jsxs)(bf.LineChart,{data:(()=>{let a=[];for(let b=6;b>=0;b--){let c=new Date;c.setDate(c.getDate()-b);let d=c.toISOString().split("T")[0],e={date:d};[...new Set(C.map(a=>a.fuel_type))].forEach(a=>{let b=C.filter(b=>b.sale_date.startsWith(d)&&b.fuel_type===a).reduce((a,b)=>a+b.total_amount,0);e[a]=b}),a.push(e)}return a})(),margin:{top:5,right:10,left:0,bottom:5},children:[(0,b.jsx)(bc.CartesianGrid,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,b.jsx)(ba.XAxis,{dataKey:"date",tick:{fontSize:10,fill:"#000"},tickFormatter:a=>new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),(0,b.jsx)(bb.YAxis,{tick:{fontSize:11,fill:"#000"}}),(0,b.jsx)(bd.Tooltip,{formatter:a=>B(a),contentStyle:{color:"#000"},labelFormatter:a=>new Date(a).toLocaleDateString()}),[...new Set(C.map(a=>a.fuel_type))].map(a=>{let c={Diesel:"#FFFF00",Petrol:"#FF0000",Unleaded:"#FF0000",Super:"#10B981"};return(0,b.jsx)(bg.Line,{type:"monotone",dataKey:a,stroke:c[a]||"#000",strokeWidth:2,dot:{fill:c[a]||"#000"},name:a},a)})]})})})]})]}),0===C.length&&!Z&&(0,b.jsx)(g.Card,{className:"rounded-2xl",children:(0,b.jsx)(g.CardContent,{className:"py-12 text-center",children:(0,b.jsx)("p",{className:"text-slate-500",children:"No sales data available. Start a shift and record sales to see performance metrics."})})}),(0,b.jsx)(f.Dialog,{open:ad,onOpenChange:ae,children:(0,b.jsxs)(f.DialogContent,{className:"max-h-[90vh] overflow-hidden flex flex-col",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{children:"start"===af?"Start New Shift":"End Current Shift"}),(0,b.jsx)(f.DialogDescription,{children:"start"===af?"Enter details to start a new shift":"Enter closing details to end the shift"})]}),(0,b.jsxs)("div",{className:"flex-1 overflow-hidden",children:["start"===af&&(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"shift-date",children:"Date"}),(0,b.jsx)(i.Input,{id:"shift-date",type:"date",value:ar.date,onChange:a=>as({...ar,date:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"shift-time",children:"Time"}),(0,b.jsx)(i.Input,{id:"shift-time",type:"time",value:ar.time,onChange:a=>as({...ar,time:a.target.value})})]})]}),"end"===af&&X&&(0,b.jsx)(w.ScrollArea,{className:"h-[50vh]",children:(0,b.jsxs)("div",{className:"space-y-4 pr-4",children:[(0,b.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg space-y-2",children:[(0,b.jsx)("h4",{className:"font-semibold text-slate-700",children:"Shift Summary"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-slate-500",children:"Started:"}),(0,b.jsx)("span",{className:"ml-2 font-medium",children:aM})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-slate-500",children:"Duration:"}),(0,b.jsxs)("span",{className:"ml-2 font-medium",children:[Math.round((Date.now()-new Date(X.start_time).getTime())/36e5),"h"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-slate-500",children:"Opening Cash:"}),(0,b.jsxs)("span",{className:"ml-2 font-medium",children:["KES ",(X.opening_cash||0).toLocaleString()]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-slate-500",children:"Total Sales:"}),(0,b.jsxs)("span",{className:"ml-2 font-medium text-green-600",children:["KES ",C.reduce((a,b)=>a+(parseFloat(b.total_amount)||0),0).toLocaleString()]})]})]})]}),E.length>0&&(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("h4",{className:"font-semibold text-slate-700",children:"Nozzle Meter Readings"}),(0,b.jsx)("div",{className:"grid gap-3",children:E.map(a=>{let c=I.find(b=>b.id===a.dispenser_id),d=S[a.id]||0;return(0,b.jsxs)("div",{className:"bg-slate-50 p-3 rounded-lg space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("p",{className:"text-sm font-medium",children:[c?.name||"Dispenser"," - Nozzle ",a.nozzle_number]}),(0,b.jsxs)("p",{className:"text-xs text-slate-500 capitalize",children:[a.fuel_type," - Opening: ",d.toLocaleString()]})]}),(0,b.jsx)(i.Input,{type:"number",step:"0.01",min:d,placeholder:"Closing reading",className:"w-36",value:M[a.id]||"",onChange:b=>N({...M,[a.id]:b.target.value})})]}),M[a.id]&&parseFloat(M[a.id])<d&&(0,b.jsxs)("p",{className:"text-xs text-red-500",children:["Closing reading cannot be less than opening (",d,")"]})]},a.id)})})]}),G.length>0&&(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("h4",{className:"font-semibold text-slate-700",children:"Tank Closing Stock"}),(0,b.jsx)("div",{className:"grid gap-3",children:G.map(a=>{let c=V[a.id]||0,d=(parseFloat(O[a.id]||"0")||0)>c;return(0,b.jsxs)("div",{className:"bg-slate-50 p-3 rounded-lg space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:a.tank_name}),(0,b.jsxs)("p",{className:"text-xs text-slate-500 capitalize",children:[a.fuel_type," - Opening: ",c.toLocaleString()," L"]})]}),(0,b.jsx)(i.Input,{type:"number",step:"0.01",placeholder:"Closing stock (L)",className:"w-36",value:O[a.id]||"",onChange:b=>P({...O,[a.id]:b.target.value})})]}),d&&(0,b.jsxs)("div",{className:"flex items-center gap-2 pt-1 border-t border-slate-200",children:[(0,b.jsx)("span",{className:"text-xs text-amber-600 flex-1",children:"Stock increased - enter fuel received:"}),(0,b.jsx)(i.Input,{type:"number",step:"0.01",placeholder:"Stock received (L)",className:"w-36",value:Q[a.id]||"",onChange:b=>R({...Q,[a.id]:b.target.value})})]})]},a.id)})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"closing-cash",children:"Closing Cash Amount"}),(0,b.jsx)(i.Input,{id:"closing-cash",type:"number",placeholder:"Enter actual cash in drawer",value:ar.closing_cash,onChange:a=>as({...ar,closing_cash:a.target.value})}),(0,b.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Enter the actual cash amount in the drawer to calculate variance"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"shift-notes",children:"Notes (Optional)"}),(0,b.jsx)(v.Textarea,{id:"shift-notes",placeholder:"Add any notes about this shift",value:ar.notes,onChange:a=>as({...ar,notes:a.target.value})})]})]})}),"start"===af&&(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"shift-notes",children:"Notes (Optional)"}),(0,b.jsx)(v.Textarea,{id:"shift-notes",placeholder:"Add any notes about this shift",value:ar.notes,onChange:a=>as({...ar,notes:a.target.value})})]})})]}),(0,b.jsxs)(f.DialogFooter,{className:"mt-4",children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>ae(!1),children:"Cancel"}),(0,b.jsx)(h.Button,{onClick:"start"===af?aJ:aK,disabled:at,children:"start"===af?"Start Shift":"End Shift"})]})]})}),(0,b.jsx)(f.Dialog,{open:ab,onOpenChange:ac,children:(0,b.jsxs)(f.DialogContent,{className:"max-w-2xl",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{children:"Record Fuel Sale"}),(0,b.jsx)(f.DialogDescription,{children:"Enter sale details to record a new fuel transaction"})]}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault(),aI()},children:[(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"nozzle",children:"Nozzle *"}),(0,b.jsxs)(k.Select,{value:ap.nozzle_id,onValueChange:a=>{let b=E.find(b=>b.id===a);aq({...ap,nozzle_id:a,fuel_type:b?.fuel_type||""})},children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select nozzle"})}),(0,b.jsx)(k.SelectContent,{children:E.map(a=>{let c=I.find(b=>b.id===a.dispenser_id);return(0,b.jsxs)(k.SelectItem,{value:a.id,children:[c?`D${c.dispenser_number}N${a.nozzle_number}`:`Nozzle ${a.nozzle_number}`," - ",a.fuel_type]},a.id)})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"fuel-type",children:"Fuel Type *"}),(0,b.jsx)(i.Input,{id:"fuel-type",value:ap.fuel_type,readOnly:!0,className:"bg-slate-50"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"amount",children:"Amount (KES) *"}),(0,b.jsx)(i.Input,{id:"amount",type:"number",placeholder:"0.00",value:ap.amount,onChange:a=>aq({...ap,amount:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"payment-method",children:"Payment Method"}),(0,b.jsxs)(k.Select,{value:ap.payment_method,onValueChange:a=>aq({...ap,payment_method:a}),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"cash",children:"Cash"}),(0,b.jsx)(k.SelectItem,{value:"mobile_money",children:"Mobile Money"}),(0,b.jsx)(k.SelectItem,{value:"card",children:"Card"}),(0,b.jsx)(k.SelectItem,{value:"credit",children:"Credit"})]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"discount-type",children:"Discount Type"}),(0,b.jsxs)(k.Select,{value:ap.discount_type,onValueChange:a=>aq({...ap,discount_type:a}),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"fixed",children:"Fixed Amount"}),(0,b.jsx)(k.SelectItem,{value:"percentage",children:"Percentage"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"discount-value",children:"Discount Value"}),(0,b.jsx)(i.Input,{id:"discount-value",type:"number",placeholder:"percentage"===ap.discount_type?"0%":"0.00",value:ap.discount_value,onChange:a=>aq({...ap,discount_value:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"customer-name",children:"Customer Name"}),(0,b.jsx)(i.Input,{id:"customer-name",placeholder:"Walk-in Customer",value:ap.customer_name,onChange:a=>aq({...ap,customer_name:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"vehicle-number",children:"Vehicle Number"}),(0,b.jsx)(i.Input,{id:"vehicle-number",placeholder:"KAA 123A",value:ap.vehicle_number,onChange:a=>aq({...ap,vehicle_number:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"is-loyalty",checked:ap.is_loyalty_sale,onChange:a=>aq({...ap,is_loyalty_sale:a.target.checked}),className:"h-4 w-4"}),(0,b.jsx)(j.Label,{htmlFor:"is-loyalty",children:"Loyalty Customer"})]}),ap.is_loyalty_sale&&(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Select Loyalty Customer"}),(0,b.jsxs)(y.Popover,{open:al,onOpenChange:am,children:[(0,b.jsx)(y.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(h.Button,{variant:"outline",role:"combobox",className:"w-full justify-between",children:[ap.loyalty_customer_name||"Select customer...",(0,b.jsx)(z.ChevronsUpDown,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,b.jsx)(y.PopoverContent,{className:"w-full p-0",children:(0,b.jsxs)(x.Command,{children:[(0,b.jsx)(x.CommandInput,{placeholder:"Search customer..."}),(0,b.jsxs)(x.CommandList,{children:[(0,b.jsx)(x.CommandEmpty,{children:"No customer found."}),(0,b.jsx)(x.CommandGroup,{children:aj.map(a=>(0,b.jsxs)(x.CommandItem,{value:a.name,onSelect:()=>{aq({...ap,loyalty_customer_name:a.name,loyalty_customer_pin:a.pin}),am(!1)},children:[(0,b.jsx)(A.Check,{className:(0,q.cn)("mr-2 h-4 w-4",ap.loyalty_customer_name===a.name?"opacity-100":"opacity-0")}),a.name," (",a.pin,")"]},a.id))})]})]})})]})]})]}),(0,b.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,b.jsx)(h.Button,{type:"button",variant:"outline",onClick:()=>ac(!1),children:"Cancel"}),(0,b.jsx)(h.Button,{type:"button",className:"flex-1 h-12 text-lg font-bold bg-green-600 hover:bg-green-700 text-white",disabled:_,onClick:()=>aI(),children:_?"Processing...":"SELL"})]})]})]})}),(0,b.jsx)(f.Dialog,{open:av,onOpenChange:aw,children:(0,b.jsxs)(f.DialogContent,{className:"sm:max-w-[500px]",children:[(0,b.jsxs)(f.DialogHeader,{children:[(0,b.jsx)(f.DialogTitle,{children:"Issue Invoice"}),(0,b.jsx)(f.DialogDescription,{children:"Create and submit invoice to KRA eTIMS"})]}),aA&&(0,b.jsxs)(s,{variant:"destructive",className:"mb-4",children:[(0,b.jsx)(n.AlertCircle,{className:"h-4 w-4"}),(0,b.jsx)(t,{children:aA})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"invoice-amount",children:"Amount (KES)"}),(0,b.jsx)(i.Input,{id:"invoice-amount",type:"number",placeholder:"Enter amount",value:aE.amount,onChange:a=>aF({...aE,amount:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"invoice-nozzle",children:"Nozzle"}),(0,b.jsxs)(k.Select,{value:aE.nozzle_id,onValueChange:a=>aF({...aE,nozzle_id:a}),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select nozzle"})}),(0,b.jsx)(k.SelectContent,{children:I.map(a=>{let c=E.filter(b=>b.dispenser_id===a.id);return 0===c.length?null:(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"px-2 py-1 text-xs font-semibold text-gray-500",children:["Dispenser ",a.dispenser_number]}),c.map(a=>(0,b.jsxs)(k.SelectItem,{value:a.id,children:["Nozzle ",a.nozzle_number," - ",a.fuel_type]},a.id))]},a.id)})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"invoice-payment",children:"Payment Method"}),(0,b.jsxs)(k.Select,{value:aE.payment_method,onValueChange:a=>aF({...aE,payment_method:a}),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select payment method"})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"cash",children:"Cash"}),(0,b.jsx)(k.SelectItem,{value:"mpesa",children:"M-Pesa"}),(0,b.jsx)(k.SelectItem,{value:"card",children:"Card"}),(0,b.jsx)(k.SelectItem,{value:"credit",children:"Credit"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"invoice-discount-type",children:"Discount Type"}),(0,b.jsxs)(k.Select,{value:aE.discount_type,onValueChange:a=>aF({...aE,discount_type:a}),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"fixed",children:"Fixed (KES)"}),(0,b.jsx)(k.SelectItem,{value:"percentage",children:"Percentage (%)"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"invoice-discount-value",children:"Discount Value"}),(0,b.jsx)(i.Input,{id:"invoice-discount-value",type:"number",placeholder:"0",value:aE.discount_value,onChange:a=>aF({...aE,discount_value:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"invoice-is-loyalty",checked:aE.is_loyalty_sale,onChange:a=>aF({...aE,is_loyalty_sale:a.target.checked}),className:"h-4 w-4"}),(0,b.jsx)(j.Label,{htmlFor:"invoice-is-loyalty",children:"Loyalty Customer"})]}),aE.is_loyalty_sale?(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Select Loyalty Customer"}),(0,b.jsxs)(y.Popover,{open:aC,onOpenChange:aD,children:[(0,b.jsx)(y.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(h.Button,{variant:"outline",role:"combobox",className:"w-full justify-between",children:[aE.loyalty_customer_name||"Select customer...",(0,b.jsx)(z.ChevronsUpDown,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,b.jsx)(y.PopoverContent,{className:"w-full p-0",children:(0,b.jsxs)(x.Command,{children:[(0,b.jsx)(x.CommandInput,{placeholder:"Search customer..."}),(0,b.jsxs)(x.CommandList,{children:[(0,b.jsx)(x.CommandEmpty,{children:"No customer found."}),(0,b.jsx)(x.CommandGroup,{children:aj.map(a=>(0,b.jsxs)(x.CommandItem,{value:a.name,onSelect:()=>{aF({...aE,loyalty_customer_id:a.id,loyalty_customer_name:a.name,loyalty_customer_pin:a.pin}),aD(!1)},children:[(0,b.jsx)(A.Check,{className:(0,q.cn)("mr-2 h-4 w-4",aE.loyalty_customer_name===a.name?"opacity-100":"opacity-0")}),a.name," (",a.pin,")"]},a.id))})]})]})})]})]}):(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{htmlFor:"invoice-customer-pin",children:"Customer KRA PIN (Optional)"}),(0,b.jsx)(i.Input,{id:"invoice-customer-pin",placeholder:"e.g., P0123456789A",value:aE.customer_pin,onChange:a=>aF({...aE,customer_pin:a.target.value})})]})]}),(0,b.jsxs)(f.DialogFooter,{className:"mt-4",children:[(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>aw(!1),children:"Cancel"}),(0,b.jsx)(h.Button,{onClick:aN,disabled:ax,className:"bg-blue-600 hover:bg-blue-700",children:ax?"Processing...":"Submit Invoice"})]})]})})]})}function bi(){let[a,f]=(0,c.useState)(!1),[g,h]=(0,c.useState)(!1);return(0,b.jsxs)("div",{className:"flex min-h-screen bg-gradient-to-b from-slate-900 via-blue-900 to-white",children:[(0,b.jsx)(d.DashboardSidebar,{collapsed:a,onToggle:()=>f(!a),mobileOpen:g,onMobileClose:()=>h(!1)}),(0,b.jsx)("div",{className:"flex-1 flex flex-col lg:ml-8 my-0 lg:my-6 mr-0 lg:mr-6 relative z-10",children:(0,b.jsxs)("div",{className:"bg-white lg:rounded-tl-3xl shadow-2xl flex-1 flex flex-col overflow-hidden",children:[(0,b.jsx)(e.DashboardHeader,{onMobileMenuToggle:()=>h(!g)}),(0,b.jsx)("main",{className:"flex-1 overflow-y-auto bg-slate-50 p-4 lg:p-6 pointer-events-auto",children:(0,b.jsxs)("div",{className:"mx-auto max-w-7xl space-y-6",children:[(0,b.jsx)(bh,{}),(0,b.jsxs)("footer",{className:"mt-12 border-t pt-6 pb-4 text-center text-sm text-muted-foreground",children:["Powered by ",(0,b.jsx)("span",{className:"font-semibold text-foreground",children:"Sensile Technologies East Africa Ltd"})]})]})})]})})]})}a.s(["default",()=>bi],14459)}];

//# sourceMappingURL=app_sales_summary_page_tsx_feca58b5._.js.map