module.exports=[57533,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(344),e=a.i(69265),f=a.i(3130),g=a.i(5522),h=a.i(17171),i=a.i(40695),j=a.i(87682),k=a.i(88237),l=a.i(54161),m=a.i(74575),n=a.i(23292),o=a.i(13749),p=a.i(50522),q=a.i(4720),r=a.i(11156),s=a.i(79360),t=a.i(71931),u=a.i(84505);let v=(0,a.i(70106).default)("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);var w=a.i(76504),x=a.i(65733),y=a.i(97020),z=a.i(46893);function A(){let[a,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(!1),{formatCurrency:D}=(0,m.useCurrency)(),[E,F]=(0,c.useState)([]),[G,H]=(0,c.useState)([]),[I,J]=(0,c.useState)([]),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(1),[O,P]=(0,c.useState)(0),[Q,R]=(0,c.useState)({date:"",invoiceNumber:"",fuelType:"",nozzle:"",loyalty:"all",paymentMethod:"",documentType:"all"}),[S,T]=(0,c.useState)(null),[U,V]=(0,c.useState)(!1),[W,X]=(0,c.useState)(null),[Y,Z]=(0,c.useState)({refundType:"full",reasonCode:"01",partialAmount:"",notes:""});async function $(){try{L(!0);let a=localStorage.getItem("selectedBranch");if(!a)return void n.toast.error("No branch selected");let b=JSON.parse(a).id,[c,d,e]=await Promise.all([fetch(`/api/nozzles?branch_id=${b}&status=active`),fetch(`/api/dispensers?branch_id=${b}`),fetch(`/api/sales?branch_id=${b}&page=${M}&limit=20`)]),[f,g,h]=await Promise.all([c.json(),d.json(),e.json()]);H(f.success&&f.data||[]),J(g.success&&g.data||[]);let i=h.success&&h.data||[];P(h.totalCount||0);let j=i.map(a=>({...a,quantity:Number(a.quantity)||0,unit_price:Number(a.unit_price)||0,total_amount:Number(a.total_amount)||0,meter_reading_after:Number(a.meter_reading_after)||0}));F(j)}catch(a){console.error("Error fetching data:",a),n.toast.error("Failed to load sales data")}finally{L(!1)}}function _(a){let b=localStorage.getItem("selectedBranch");if(!b)return null;let c=JSON.parse(b),d=new URLSearchParams;return d.set("branch_id",c.id),d.set("format",a),d.set("export","true"),Q.date&&d.set("date",Q.date),Q.fuelType&&"all"!==Q.fuelType&&d.set("fuel_type",Q.fuelType),Q.nozzle&&"all"!==Q.nozzle&&d.set("nozzle_id",Q.nozzle),Q.paymentMethod&&"all"!==Q.paymentMethod&&d.set("payment_method",Q.paymentMethod),Q.documentType&&"all"!==Q.documentType&&d.set("document_type",Q.documentType),`/api/sales/export?${d.toString()}`}async function aa(){try{let a=_("pdf");if(!a)return void n.toast.error("No branch selected");n.toast.loading("Generating PDF...");let b=await fetch(a);if(!b.ok)throw Error("Failed to export");let c=await b.blob(),d=window.URL.createObjectURL(c),e=document.createElement("a");e.href=d,e.download=`sales-report-${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(d),n.toast.dismiss(),n.toast.success("PDF downloaded")}catch(a){n.toast.dismiss(),n.toast.error("Failed to export PDF")}}async function ab(){try{let a=_("excel");if(!a)return void n.toast.error("No branch selected");n.toast.loading("Generating Excel...");let b=await fetch(a);if(!b.ok)throw Error("Failed to export");let c=await b.blob(),d=window.URL.createObjectURL(c),e=document.createElement("a");e.href=d,e.download=`sales-report-${new Date().toISOString().split("T")[0]}.xlsx`,document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(d),n.toast.dismiss(),n.toast.success("Excel downloaded")}catch(a){n.toast.dismiss(),n.toast.error("Failed to export Excel")}}(0,c.useEffect)(()=>{$()},[M]);let ac=E.filter(a=>{if(Q.date&&new Date(a.sale_date).toISOString().split("T")[0]!==Q.date||Q.invoiceNumber&&!(a.invoice_number||a.receipt_number||"").toLowerCase().includes(Q.invoiceNumber.toLowerCase())||Q.fuelType&&"all"!==Q.fuelType&&a.fuel_type!==Q.fuelType||Q.nozzle&&"all"!==Q.nozzle&&a.nozzle_id!==Q.nozzle)return!1;if("loyalty"===Q.loyalty){if(!a.is_loyalty_sale)return!1}else if("non-loyalty"===Q.loyalty&&a.is_loyalty_sale)return!1;if(Q.paymentMethod&&"all"!==Q.paymentMethod){let b;if(("mpesa"===(b=(a.payment_method||"cash").toLowerCase())||"m-pesa"===b||"mobile_money"===b?"mobile_money":"card"===b?"card":"credit"===b?"credit":"cash")!==Q.paymentMethod)return!1}if("invoices"===Q.documentType){if(a.is_credit_note)return!1}else if("credit_notes"===Q.documentType&&!a.is_credit_note)return!1;return!0}),ad=Array.from(new Set(E.map(a=>a.fuel_type))),ae=Array.from(new Set(E.map(a=>a.nozzle_id))),af=Math.ceil(O/20);async function ag(){if(W){if("partial"===Y.refundType){let a=parseFloat(Y.partialAmount);if(isNaN(a)||a<=0)return void n.toast.error("Please enter a valid partial amount");if(a>Math.abs(parseFloat(W.total_amount)))return void n.toast.error("Partial amount cannot exceed original sale amount")}try{T(W.id);let a=localStorage.getItem("selectedBranch");if(!a)return void n.toast.error("No branch selected");let b=JSON.parse(a),c=await fetch("/api/credit-notes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sale_id:W.id,branch_id:b.id,reason_code:Y.reasonCode,refund_type:Y.refundType,partial_amount:"partial"===Y.refundType?parseFloat(Y.partialAmount):null,notes:Y.notes})}),d=await c.json();if(!c.ok||!d.success)throw Error(d.error||"Failed to issue credit note");n.toast.success(`Credit note ${d.creditNoteNumber} issued successfully`),V(!1),X(null),$()}catch(a){console.error("Error issuing credit note:",a),n.toast.error(a.message||"Failed to issue credit note")}finally{T(null)}}}async function ah(a){try{let b=localStorage.getItem("selectedBranch");if(!b)return void n.toast.error("No branch selected");let c=JSON.parse(b),d=await fetch("/api/receipt/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sale_id:a.id,branch_id:c.id})});if(!d.ok)throw Error("Failed to generate receipt");let e=await d.blob(),f=window.URL.createObjectURL(e),g=document.createElement("a");g.href=f,g.download=`receipt-${a.invoice_number||a.id}.pdf`,document.body.appendChild(g),g.click(),document.body.removeChild(g),window.URL.revokeObjectURL(f),n.toast.success("Receipt downloaded")}catch(a){console.error("Error generating receipt:",a),n.toast.error("Failed to generate receipt")}}return(0,b.jsxs)("div",{className:"flex min-h-screen bg-gradient-to-b from-slate-900 via-blue-900 to-white",children:[(0,b.jsx)(d.DashboardSidebar,{collapsed:a,onToggle:()=>A(!a),mobileOpen:B,onMobileClose:()=>C(!1)}),(0,b.jsx)("div",{className:"flex-1 flex flex-col lg:ml-8 my-2 lg:my-6 mx-2 lg:mr-6",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl lg:rounded-tl-3xl shadow-2xl flex-1 flex flex-col overflow-hidden",children:[(0,b.jsx)(e.DashboardHeader,{onMobileMenuToggle:()=>C(!B)}),(0,b.jsx)("main",{className:"flex-1 overflow-y-auto bg-slate-50 p-3 md:p-6",children:(0,b.jsxs)("div",{className:"mx-auto max-w-7xl space-y-4 md:space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl md:text-2xl font-bold text-slate-900",children:"Sales Reports"}),(0,b.jsx)("p",{className:"text-sm md:text-base text-slate-600",children:"View and filter sales transactions"})]}),(0,b.jsxs)(f.Card,{className:"rounded-2xl",children:[(0,b.jsx)(f.CardHeader,{className:"p-3 md:p-6",children:(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(f.CardTitle,{className:"text-lg md:text-xl",children:"Sales Report"}),(0,b.jsx)(f.CardDescription,{className:"text-sm",children:"Fuel sales transactions with filters and pagination"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:flex lg:flex-wrap gap-2 items-center",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1",children:[(0,b.jsx)(h.Label,{htmlFor:"date-filter",className:"text-xs sm:text-sm whitespace-nowrap",children:"Date:"}),(0,b.jsx)(g.Input,{id:"date-filter",type:"date",value:Q.date,onChange:a=>R({...Q,date:a.target.value}),className:"w-full sm:w-32 h-8 text-sm"})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1",children:[(0,b.jsx)(h.Label,{htmlFor:"invoice-filter",className:"text-xs sm:text-sm whitespace-nowrap",children:"Invoice:"}),(0,b.jsx)(g.Input,{id:"invoice-filter",type:"text",placeholder:"Search...",value:Q.invoiceNumber,onChange:a=>R({...Q,invoiceNumber:a.target.value}),className:"w-full sm:w-28 h-8 text-sm"})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1",children:[(0,b.jsx)(h.Label,{htmlFor:"fuel-filter",className:"text-xs sm:text-sm whitespace-nowrap",children:"Fuel:"}),(0,b.jsxs)(j.Select,{value:Q.fuelType,onValueChange:a=>R({...Q,fuelType:a}),children:[(0,b.jsx)(j.SelectTrigger,{id:"fuel-filter",className:"w-full sm:w-28 h-8 text-sm",children:(0,b.jsx)(j.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"all",children:"All"}),ad.map(a=>(0,b.jsx)(j.SelectItem,{value:a,children:a},a))]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1",children:[(0,b.jsx)(h.Label,{htmlFor:"nozzle-filter",className:"text-xs sm:text-sm whitespace-nowrap",children:"Nozzle:"}),(0,b.jsxs)(j.Select,{value:Q.nozzle,onValueChange:a=>R({...Q,nozzle:a}),children:[(0,b.jsx)(j.SelectTrigger,{id:"nozzle-filter",className:"w-full sm:w-28 h-8 text-sm",children:(0,b.jsx)(j.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"all",children:"All"}),ae.map(a=>{let c=G.find(b=>b.id===a),d=c?I.find(a=>a.id===c.dispenser_id):null;return(0,b.jsx)(j.SelectItem,{value:a,children:d&&c?`D${d.dispenser_number}N${c.nozzle_number}`:"Unknown"},a)})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1",children:[(0,b.jsx)(h.Label,{htmlFor:"payment-filter",className:"text-xs sm:text-sm whitespace-nowrap",children:"Payment:"}),(0,b.jsxs)(j.Select,{value:Q.paymentMethod,onValueChange:a=>R({...Q,paymentMethod:a}),children:[(0,b.jsx)(j.SelectTrigger,{id:"payment-filter",className:"w-full sm:w-28 h-8 text-sm",children:(0,b.jsx)(j.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"all",children:"All"}),(0,b.jsx)(j.SelectItem,{value:"cash",children:"Cash"}),(0,b.jsx)(j.SelectItem,{value:"mobile_money",children:"Mobile Money"}),(0,b.jsx)(j.SelectItem,{value:"card",children:"Card"}),(0,b.jsx)(j.SelectItem,{value:"credit",children:"Credit"})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1",children:[(0,b.jsx)(h.Label,{htmlFor:"doctype-filter",className:"text-xs sm:text-sm whitespace-nowrap",children:"Type:"}),(0,b.jsxs)(j.Select,{value:Q.documentType,onValueChange:a=>R({...Q,documentType:a}),children:[(0,b.jsx)(j.SelectTrigger,{id:"doctype-filter",className:"w-full sm:w-32 h-8 text-sm",children:(0,b.jsx)(j.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"all",children:"All"}),(0,b.jsx)(j.SelectItem,{value:"invoices",children:"Invoices"}),(0,b.jsx)(j.SelectItem,{value:"credit_notes",children:"Credit Notes"})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1",children:[(0,b.jsx)(h.Label,{htmlFor:"loyalty-filter",className:"text-xs sm:text-sm whitespace-nowrap",children:"Loyalty:"}),(0,b.jsxs)(j.Select,{value:Q.loyalty,onValueChange:a=>R({...Q,loyalty:a}),children:[(0,b.jsx)(j.SelectTrigger,{id:"loyalty-filter",className:"w-full sm:w-28 h-8 text-sm",children:(0,b.jsx)(j.SelectValue,{placeholder:"All"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"all",children:"All"}),(0,b.jsx)(j.SelectItem,{value:"loyalty",children:"Loyalty Only"}),(0,b.jsx)(j.SelectItem,{value:"non-loyalty",children:"Walk-in"})]})]})]}),(0,b.jsx)(i.Button,{variant:"outline",size:"sm",onClick:function(){R({date:"",invoiceNumber:"",fuelType:"",nozzle:"",loyalty:"all",paymentMethod:"",documentType:"all"})},className:"col-span-2 sm:col-span-1 h-8",children:"Clear"}),(0,b.jsxs)(i.Button,{variant:"outline",size:"sm",onClick:aa,className:"h-8",children:[(0,b.jsx)(u.Download,{className:"w-4 h-4 mr-1"}),"PDF"]}),(0,b.jsxs)(i.Button,{variant:"outline",size:"sm",onClick:ab,className:"h-8",children:[(0,b.jsx)(v,{className:"w-4 h-4 mr-1"}),"Excel"]})]})]})}),(0,b.jsx)(f.CardContent,{className:"p-3 md:p-6",children:(0,b.jsxs)("div",{className:"space-y-4",children:[0===ac.length?(0,b.jsx)("p",{className:"text-sm text-slate-500",children:0===E.length?"No sales recorded yet":"No sales match the current filters"}):(0,b.jsx)("div",{className:"overflow-x-auto -mx-3 md:mx-0",children:(0,b.jsxs)(k.Table,{className:"w-full min-w-[800px] md:min-w-0",children:[(0,b.jsx)(k.TableHeader,{children:(0,b.jsxs)(k.TableRow,{className:"text-xs md:text-sm",children:[(0,b.jsx)(k.TableCell,{className:"text-left p-2",children:"Date"}),(0,b.jsx)(k.TableCell,{className:"text-left p-2",children:"Invoice"}),(0,b.jsx)(k.TableCell,{className:"text-left p-2 hidden sm:table-cell",children:"Nozzle"}),(0,b.jsx)(k.TableCell,{className:"text-left p-2",children:"Fuel"}),(0,b.jsx)(k.TableCell,{className:"text-right p-2",children:"Qty (L)"}),(0,b.jsx)(k.TableCell,{className:"text-right p-2 hidden md:table-cell",children:"Unit Price"}),(0,b.jsx)(k.TableCell,{className:"text-right p-2",children:"Total"}),(0,b.jsx)(k.TableCell,{className:"text-center p-2 hidden lg:table-cell",children:"Payment"}),(0,b.jsx)(k.TableCell,{className:"text-center p-2 hidden lg:table-cell",children:"Loyalty"}),(0,b.jsx)(k.TableCell,{className:"text-right p-2 hidden xl:table-cell",children:"Meter"}),(0,b.jsx)(k.TableCell,{className:"text-center p-2",children:"Status"}),(0,b.jsx)(k.TableCell,{className:"text-center p-2",children:"Actions"})]})}),(0,b.jsx)(k.TableBody,{children:ac.map(a=>{let c,d=G.find(b=>b.id===a.nozzle_id),e=d?I.find(a=>a.id===d.dispenser_id):null;return(0,b.jsxs)(k.TableRow,{className:"hover:bg-slate-50 text-xs md:text-sm",children:[(0,b.jsx)(k.TableCell,{className:"p-1 md:p-2",children:new Date(a.sale_date).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),(0,b.jsx)(k.TableCell,{className:"p-1 md:p-2 font-mono text-xs",children:(a.invoice_number||a.receipt_number||"").slice(-8)}),(0,b.jsx)(k.TableCell,{className:"p-1 md:p-2 hidden sm:table-cell",children:e&&d?`D${e.dispenser_number}N${d.nozzle_number}`:"-"}),(0,b.jsx)(k.TableCell,{className:"p-1 md:p-2",children:a.fuel_type}),(0,b.jsx)(k.TableCell,{className:"p-1 md:p-2 text-right",children:Number(a.quantity).toFixed(2)}),(0,b.jsx)(k.TableCell,{className:"p-1 md:p-2 text-right hidden md:table-cell",children:D(a.unit_price)}),(0,b.jsx)(k.TableCell,{className:"p-1 md:p-2 text-right font-medium",children:D(a.total_amount)}),(0,b.jsx)(k.TableCell,{className:"p-1 md:p-2 text-center hidden lg:table-cell",children:(0,b.jsx)(l.Badge,{variant:"outline",className:"capitalize text-xs",children:"mpesa"===(c=(a.payment_method||"cash").toLowerCase())||"m-pesa"===c||"mobile_money"===c?"Mobile":"card"===c?"Card":"credit"===c?"Credit":"Cash"})}),(0,b.jsx)(k.TableCell,{className:"p-1 md:p-2 text-center hidden lg:table-cell",children:a.is_loyalty_sale&&(0,b.jsx)("div",{className:"flex items-center justify-center",children:(0,b.jsx)("svg",{className:"w-4 h-4 md:w-5 md:h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})}),(0,b.jsx)(k.TableCell,{className:"p-1 md:p-2 text-right font-mono text-xs hidden xl:table-cell",children:a.meter_reading_after.toFixed(2)}),(0,b.jsx)(k.TableCell,{className:"p-1 md:p-2 text-center",children:"success"===a.kra_status?(0,b.jsx)(i.Button,{variant:"ghost",size:"icon",className:"h-7 w-7 md:h-8 md:w-8 text-green-600 hover:text-green-700 hover:bg-green-50",onClick:()=>ah(a),title:"Print KRA Receipt",children:(0,b.jsx)(t.Printer,{className:"h-4 w-4 md:h-5 md:w-5"})}):(0,b.jsx)(l.Badge,{variant:function(a){switch(a){case"transmitted":case"success":return"default";case"pending":default:return"secondary";case"failed":case"flagged":return"destructive"}}(a.kra_status||a.transmission_status),className:"capitalize text-xs",children:a.kra_status||a.transmission_status||"pending"})}),(0,b.jsx)(k.TableCell,{className:"p-1 md:p-2 text-center",children:(0,b.jsxs)(w.DropdownMenu,{children:[(0,b.jsx)(w.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(i.Button,{variant:"ghost",size:"icon",className:"h-7 w-7 md:h-8 md:w-8",children:(0,b.jsx)(s.MoreVertical,{className:"h-4 w-4"})})}),(0,b.jsxs)(w.DropdownMenuContent,{align:"end",children:[(0,b.jsxs)(w.DropdownMenuItem,{onClick:()=>ah(a),children:[(0,b.jsx)(q.FileText,{className:"h-4 w-4 mr-2"}),"View Invoice"]}),!a.is_credit_note&&(0,b.jsxs)(w.DropdownMenuItem,{onClick:()=>{a.is_credit_note?n.toast.error("Cannot issue credit note for a credit note"):a.has_credit_note?n.toast.error("Credit note already issued for this sale"):(X(a),Z({refundType:"full",reasonCode:"01",partialAmount:"",notes:""}),V(!0))},disabled:a.has_credit_note,children:[(0,b.jsx)(r.CreditCard,{className:"h-4 w-4 mr-2"}),a.has_credit_note?"Credit Note Issued":"Issue Credit Note"]})]})]})})]},a.id)})})]})}),af>1&&(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between pt-4 border-t gap-3",children:[(0,b.jsxs)("p",{className:"text-xs sm:text-sm text-slate-600 text-center sm:text-left",children:["Showing ",(M-1)*20+1,"-",Math.min(20*M,O)," of ",O]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(i.Button,{variant:"outline",size:"sm",disabled:1===M,onClick:()=>N(M-1),className:"h-8 px-2 sm:px-3",children:[(0,b.jsx)(o.ChevronLeft,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline ml-1",children:"Previous"})]}),(0,b.jsxs)("span",{className:"text-xs sm:text-sm text-slate-600",children:[M,"/",af]}),(0,b.jsxs)(i.Button,{variant:"outline",size:"sm",disabled:M===af,onClick:()=>N(M+1),className:"h-8 px-2 sm:px-3",children:[(0,b.jsx)("span",{className:"hidden sm:inline mr-1",children:"Next"}),(0,b.jsx)(p.ChevronRight,{className:"h-4 w-4"})]})]})]})]})})]}),(0,b.jsxs)("footer",{className:"mt-12 border-t pt-6 pb-4 text-center text-sm text-muted-foreground",children:["Powered by ",(0,b.jsx)("span",{className:"font-semibold text-foreground",children:"Sensile Technologies East Africa Ltd"})]})]})})]})}),(0,b.jsx)(x.Dialog,{open:U,onOpenChange:V,children:(0,b.jsxs)(x.DialogContent,{className:"sm:max-w-[500px]",children:[(0,b.jsxs)(x.DialogHeader,{children:[(0,b.jsx)(x.DialogTitle,{children:"Issue Credit Note"}),(0,b.jsx)(x.DialogDescription,{children:W&&(0,b.jsxs)(b.Fragment,{children:["Create a credit note for invoice ",(0,b.jsx)("strong",{children:W.invoice_number})," ","(Amount: ",D(Math.abs(parseFloat(W.total_amount))),")"]})})]}),(0,b.jsxs)("div",{className:"space-y-6 py-4",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(h.Label,{children:"Refund Type"}),(0,b.jsxs)(y.RadioGroup,{value:Y.refundType,onValueChange:a=>Z({...Y,refundType:a}),className:"flex gap-6",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(y.RadioGroupItem,{value:"full",id:"full"}),(0,b.jsx)(h.Label,{htmlFor:"full",className:"font-normal cursor-pointer",children:"Full Refund"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(y.RadioGroupItem,{value:"partial",id:"partial"}),(0,b.jsx)(h.Label,{htmlFor:"partial",className:"font-normal cursor-pointer",children:"Partial Refund"})]})]})]}),"partial"===Y.refundType&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"partialAmount",children:"Refund Amount (KES)"}),(0,b.jsx)(g.Input,{id:"partialAmount",type:"number",step:"0.01",min:"0",max:W?Math.abs(parseFloat(W.total_amount)):void 0,placeholder:"Enter amount to refund",value:Y.partialAmount,onChange:a=>Z({...Y,partialAmount:a.target.value})}),W&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Maximum: ",D(Math.abs(parseFloat(W.total_amount)))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"reasonCode",children:"Reason for Credit Note"}),(0,b.jsxs)(j.Select,{value:Y.reasonCode,onValueChange:a=>Z({...Y,reasonCode:a}),children:[(0,b.jsx)(j.SelectTrigger,{id:"reasonCode",children:(0,b.jsx)(j.SelectValue,{placeholder:"Select reason"})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"01",children:"Wrong quantity delivered"}),(0,b.jsx)(j.SelectItem,{value:"02",children:"Wrong product delivered"}),(0,b.jsx)(j.SelectItem,{value:"03",children:"Product returned"}),(0,b.jsx)(j.SelectItem,{value:"04",children:"Goods damaged"}),(0,b.jsx)(j.SelectItem,{value:"05",children:"Goods rejected"}),(0,b.jsx)(j.SelectItem,{value:"06",children:"Other"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{htmlFor:"notes",children:"Additional Notes (Optional)"}),(0,b.jsx)(z.Textarea,{id:"notes",placeholder:"Enter any additional notes...",value:Y.notes,onChange:a=>Z({...Y,notes:a.target.value}),rows:3})]})]}),(0,b.jsxs)(x.DialogFooter,{children:[(0,b.jsx)(i.Button,{variant:"outline",onClick:()=>V(!1),disabled:null!==S,children:"Cancel"}),(0,b.jsx)(i.Button,{onClick:ag,disabled:null!==S,children:S?"Issuing...":"Issue Credit Note"})]})]})})]})}a.s(["default",()=>A],57533)}];

//# sourceMappingURL=app_sales_reports_page_tsx_b347b907._.js.map