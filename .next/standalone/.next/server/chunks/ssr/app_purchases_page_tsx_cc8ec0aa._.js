module.exports=[43616,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(344),e=a.i(69265),f=a.i(40695),g=a.i(3130),h=a.i(21958),i=a.i(88237),j=a.i(54161),k=a.i(65733),l=a.i(17171),m=a.i(5522),n=a.i(87682),o=a.i(69520),p=a.i(15618),q=a.i(87532),r=a.i(96221),s=a.i(83497),t=a.i(74575),u=a.i(23292);function v(){let[a,d]=(0,c.useState)("all"),{formatCurrency:e}=(0,t.useCurrency)(),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(!0),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)({poNumber:"",orderDate:new Date().toISOString().split("T")[0],supplier:"",supplierTin:"",orderType:"",branch:"",productName:"",orderQuantity:"",supplyPrice:"",unitOfMeasurement:"",storageIndex:""}),N=(0,c.useCallback)(async()=>{try{G(!0);let a=localStorage.getItem("selectedBranch"),b="";if(a){let c=JSON.parse(a);b=c.id,K(c),M(a=>({...a,branch:c.name}))}let c=new URLSearchParams;b&&c.append("branch_id",b),x&&c.append("search",x),z&&c.append("date_from",z),B&&c.append("date_to",B);let d=await fetch(`/api/purchases?${c.toString()}`),e=await d.json();e.success?E(e.purchases||[]):console.error("Failed to fetch purchases:",e.error)}catch(a){console.error("Error fetching purchases:",a)}finally{G(!1)}},[x,z,B]);(0,c.useEffect)(()=>{N()},[N]);let O=D.filter(a=>"approved"===a.status),P=D.filter(a=>"rejected"===a.status),Q=async()=>{if(!J)return void u.toast.error("Please select a branch first");I(!0);try{let a=parseFloat(L.orderQuantity)*parseFloat(L.supplyPrice),b=await fetch("/api/purchases",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch_id:J.id,tin:J.tin||"",bhf_id:J.bhf_id||"00",supplier_name:L.supplier,supplier_tin:L.supplierTin,purchase_date:L.orderDate,purchase_type:L.orderType,payment_type:"01",total_amount:a,tax_amount:.16*a,remark:`${L.productName} - ${L.orderQuantity} ${L.unitOfMeasurement}`})}),c=await b.json();c.success?(u.toast.success("Purchase order submitted successfully!"),w(!1),M({poNumber:"",orderDate:new Date().toISOString().split("T")[0],supplier:"",supplierTin:"",orderType:"",branch:J?.name||"",productName:"",orderQuantity:"",supplyPrice:"",unitOfMeasurement:"",storageIndex:""}),N()):u.toast.error(c.error||"Failed to submit purchase order")}catch(a){console.error("Error submitting purchase:",a),u.toast.error("Failed to submit purchase order")}finally{I(!1)}},R=a=>(0,b.jsx)("div",{className:"rounded-xl border overflow-hidden overflow-x-auto",children:(0,b.jsxs)(i.Table,{children:[(0,b.jsx)(i.TableHeader,{children:(0,b.jsxs)(i.TableRow,{className:"text-xs md:text-sm",children:[(0,b.jsx)(i.TableHead,{children:"Purchase Order ID"}),(0,b.jsx)(i.TableHead,{children:"Supplier"}),(0,b.jsx)(i.TableHead,{className:"hidden md:table-cell",children:"Date"}),(0,b.jsx)(i.TableHead,{className:"hidden sm:table-cell",children:"Items"}),(0,b.jsx)(i.TableHead,{children:"Amount"}),(0,b.jsx)(i.TableHead,{children:"Status"})]})}),(0,b.jsx)(i.TableBody,{children:0===a.length?(0,b.jsx)(i.TableRow,{children:(0,b.jsxs)(i.TableCell,{colSpan:6,className:"text-center py-12",children:[(0,b.jsx)(s.Package,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"No purchases found"})]})}):a.map(a=>(0,b.jsxs)(i.TableRow,{className:"text-xs md:text-sm",children:[(0,b.jsx)(i.TableCell,{className:"font-medium",children:a.po_number}),(0,b.jsx)(i.TableCell,{children:a.supplier}),(0,b.jsx)(i.TableCell,{className:"hidden md:table-cell",children:a.date||"N/A"}),(0,b.jsx)(i.TableCell,{className:"hidden sm:table-cell",children:a.items}),(0,b.jsx)(i.TableCell,{children:e(a.amount)}),(0,b.jsx)(i.TableCell,{children:(0,b.jsx)(j.Badge,{variant:"approved"===a.status?"default":"rejected"===a.status?"destructive":"secondary",className:"rounded-lg text-xs",children:a.status})})]},a.id))})]})});return(0,b.jsxs)("div",{className:"space-y-4 md:space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight text-balance",children:"Purchases"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-muted-foreground text-pretty",children:"Manage your purchase orders and supplier invoices"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3",children:[(0,b.jsxs)(f.Button,{onClick:()=>w(!0),className:"rounded-xl gap-2 bg-blue-600 hover:bg-blue-700 text-sm",size:"sm",children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Add Purchase"})]}),(0,b.jsxs)(f.Button,{onClick:N,className:"rounded-xl gap-2 bg-blue-600 hover:bg-blue-700 text-white text-sm",size:"sm",disabled:F,children:[(0,b.jsx)(o.RefreshCw,{className:`h-4 w-4 ${F?"animate-spin":""}`}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Refresh"})]})]})]}),(0,b.jsx)(g.Card,{className:"rounded-2xl",children:(0,b.jsxs)(g.CardContent,{className:"p-3 md:p-6",children:[(0,b.jsxs)("div",{className:"mb-4 md:mb-6 flex flex-col md:flex-row md:items-center md:justify-between gap-3 md:gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,b.jsx)(q.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,b.jsx)(m.Input,{placeholder:"Search purchases...",value:x,onChange:a=>y(a.target.value),className:"pl-10 rounded-xl"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Input,{type:"date",value:z,onChange:a=>A(a.target.value),placeholder:"From",className:"rounded-xl w-32 md:w-40 text-sm"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"to"}),(0,b.jsx)(m.Input,{type:"date",value:B,onChange:a=>C(a.target.value),placeholder:"To",className:"rounded-xl w-32 md:w-40 text-sm"})]})]}),F?(0,b.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,b.jsx)(r.Loader2,{className:"h-8 w-8 animate-spin text-blue-600"}),(0,b.jsx)("span",{className:"ml-2 text-muted-foreground",children:"Loading purchases..."})]}):(0,b.jsxs)(h.Tabs,{value:a,onValueChange:d,children:[(0,b.jsxs)(h.TabsList,{className:"rounded-xl bg-transparent gap-1 md:gap-2 flex-wrap",children:[(0,b.jsxs)(h.TabsTrigger,{value:"all",className:"rounded-lg data-[state=active]:bg-muted text-xs md:text-sm",children:["All (",D.length,")"]}),(0,b.jsxs)(h.TabsTrigger,{value:"approved",className:"rounded-lg data-[state=active]:bg-muted text-xs md:text-sm",children:["Approved (",O.length,")"]}),(0,b.jsxs)(h.TabsTrigger,{value:"rejected",className:"rounded-lg data-[state=active]:bg-muted text-xs md:text-sm",children:["Rejected (",P.length,")"]})]}),(0,b.jsx)(h.TabsContent,{value:"all",className:"mt-4 md:mt-6",children:R(D)}),(0,b.jsx)(h.TabsContent,{value:"approved",className:"mt-4 md:mt-6",children:R(O)}),(0,b.jsx)(h.TabsContent,{value:"rejected",className:"mt-4 md:mt-6",children:R(P)})]})]})}),(0,b.jsx)(k.Dialog,{open:v,onOpenChange:w,children:(0,b.jsxs)(k.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto rounded-2xl",children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsx)(k.DialogTitle,{className:"text-xl md:text-2xl",children:"Add New Purchase Order"}),(0,b.jsx)(k.DialogDescription,{children:"Fill in the details to create a new purchase order"})]}),(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"po-number",children:"P.O Number *"}),(0,b.jsx)(m.Input,{id:"po-number",placeholder:"e.g., PO-001",value:L.poNumber,onChange:a=>M({...L,poNumber:a.target.value}),className:"rounded-xl"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"order-date",children:"Order Date *"}),(0,b.jsx)(m.Input,{id:"order-date",type:"date",value:L.orderDate,onChange:a=>M({...L,orderDate:a.target.value}),className:"rounded-xl"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"supplier",children:"Supplier *"}),(0,b.jsx)(m.Input,{id:"supplier",placeholder:"Supplier name",value:L.supplier,onChange:a=>M({...L,supplier:a.target.value}),className:"rounded-xl"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"supplier-tin",children:"Supplier TIN"}),(0,b.jsx)(m.Input,{id:"supplier-tin",placeholder:"e.g., P051234567A",value:L.supplierTin,onChange:a=>M({...L,supplierTin:a.target.value}),className:"rounded-xl"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"order-type",children:"Order Type *"}),(0,b.jsxs)(n.Select,{value:L.orderType,onValueChange:a=>M({...L,orderType:a}),children:[(0,b.jsx)(n.SelectTrigger,{className:"rounded-xl",children:(0,b.jsx)(n.SelectValue,{placeholder:"Select type"})}),(0,b.jsxs)(n.SelectContent,{className:"rounded-xl",children:[(0,b.jsx)(n.SelectItem,{value:"01",children:"Normal Purchase"}),(0,b.jsx)(n.SelectItem,{value:"02",children:"Import"}),(0,b.jsx)(n.SelectItem,{value:"03",children:"Credit Purchase"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"branch",children:"Branch *"}),(0,b.jsx)(m.Input,{id:"branch",value:L.branch||"Select a branch",disabled:!0,className:"rounded-xl bg-muted"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"product-name",children:"Product Name *"}),(0,b.jsx)(m.Input,{id:"product-name",placeholder:"Product name",value:L.productName,onChange:a=>M({...L,productName:a.target.value}),className:"rounded-xl"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"order-quantity",children:"Order Quantity *"}),(0,b.jsx)(m.Input,{id:"order-quantity",type:"number",placeholder:"Quantity",value:L.orderQuantity,onChange:a=>M({...L,orderQuantity:a.target.value}),className:"rounded-xl"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"supply-price",children:"Supply Price per Unit *"}),(0,b.jsx)(m.Input,{id:"supply-price",type:"number",placeholder:"Price per unit",value:L.supplyPrice,onChange:a=>M({...L,supplyPrice:a.target.value}),className:"rounded-xl"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"unit-measurement",children:"Unit of Measurement *"}),(0,b.jsxs)(n.Select,{value:L.unitOfMeasurement,onValueChange:a=>M({...L,unitOfMeasurement:a}),children:[(0,b.jsx)(n.SelectTrigger,{className:"rounded-xl",children:(0,b.jsx)(n.SelectValue,{placeholder:"Select unit"})}),(0,b.jsxs)(n.SelectContent,{className:"rounded-xl",children:[(0,b.jsx)(n.SelectItem,{value:"pcs",children:"Pieces (pcs)"}),(0,b.jsx)(n.SelectItem,{value:"kg",children:"Kilograms (kg)"}),(0,b.jsx)(n.SelectItem,{value:"litres",children:"Litres (L)"}),(0,b.jsx)(n.SelectItem,{value:"metres",children:"Metres (m)"}),(0,b.jsx)(n.SelectItem,{value:"boxes",children:"Boxes"}),(0,b.jsx)(n.SelectItem,{value:"cartons",children:"Cartons"}),(0,b.jsx)(n.SelectItem,{value:"dozens",children:"Dozens"})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Label,{htmlFor:"storage-index",children:"Storage Index *"}),(0,b.jsxs)(n.Select,{value:L.storageIndex,onValueChange:a=>M({...L,storageIndex:a}),children:[(0,b.jsx)(n.SelectTrigger,{className:"rounded-xl",children:(0,b.jsx)(n.SelectValue,{placeholder:"Select storage location"})}),(0,b.jsxs)(n.SelectContent,{className:"rounded-xl",children:[(0,b.jsx)(n.SelectItem,{value:"tank-1",children:"Tank 1"}),(0,b.jsx)(n.SelectItem,{value:"tank-2",children:"Tank 2"}),(0,b.jsx)(n.SelectItem,{value:"warehouse-a",children:"Warehouse A"}),(0,b.jsx)(n.SelectItem,{value:"warehouse-b",children:"Warehouse B"}),(0,b.jsx)(n.SelectItem,{value:"cold-storage",children:"Cold Storage"}),(0,b.jsx)(n.SelectItem,{value:"dry-storage",children:"Dry Storage"})]})]})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>w(!1),className:"rounded-xl",children:"Cancel"}),(0,b.jsx)(f.Button,{onClick:Q,className:"rounded-xl bg-blue-600 hover:bg-blue-700",disabled:H||!L.supplier||!L.orderType||!L.productName||!L.orderQuantity||!L.supplyPrice||!L.unitOfMeasurement||!L.storageIndex,children:H?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Submitting..."]}):"Submit Purchase Order"})]})]})})]})}function w(){let[a,f]=(0,c.useState)(!1),[g,h]=(0,c.useState)(!1);return(0,b.jsxs)("div",{className:"flex min-h-screen w-full overflow-x-hidden bg-gradient-to-b from-slate-900 via-blue-900 to-white",children:[(0,b.jsx)(d.DashboardSidebar,{collapsed:a,onToggle:()=>f(!a),mobileOpen:g,onMobileClose:()=>h(!1)}),(0,b.jsx)("div",{className:"flex-1 flex flex-col min-w-0 lg:ml-8 my-2 lg:my-6 mx-2 lg:mr-6",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl lg:rounded-tl-3xl shadow-2xl flex-1 flex flex-col overflow-hidden",children:[(0,b.jsx)(e.DashboardHeader,{onMobileMenuToggle:()=>h(!g)}),(0,b.jsx)("main",{className:"flex-1 overflow-y-auto overflow-x-hidden bg-slate-50 p-3 md:p-6",children:(0,b.jsxs)("div",{className:"w-full max-w-7xl mx-auto space-y-4 md:space-y-6",children:[(0,b.jsx)(v,{}),(0,b.jsxs)("footer",{className:"mt-12 border-t pt-6 pb-4 text-center text-sm text-muted-foreground",children:["Powered by ",(0,b.jsx)("span",{className:"font-semibold text-foreground",children:"Sensile Technologies East Africa Ltd"})]})]})})]})})]})}a.s(["default",()=>w],43616)}];

//# sourceMappingURL=app_purchases_page_tsx_cc8ec0aa._.js.map